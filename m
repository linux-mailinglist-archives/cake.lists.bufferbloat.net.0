Return-Path: <cake-bounces@lists.bufferbloat.net>
X-Original-To: lists+cake@lfdr.de
Delivered-To: lists+cake@lfdr.de
Received: from mail.toke.dk (mail.toke.dk [IPv6:2a0c:4d80:42:2001::664])
	by mail.lfdr.de (Postfix) with ESMTPS id 23522CFCBD6
	for <lists+cake@lfdr.de>; Wed, 07 Jan 2026 10:09:36 +0100 (CET)
Received: from [45.145.95.3] (localhost.localdomain [IPv6:::1])
	by mail.toke.dk (Postfix) with ESMTP id 6D12BB7BF18;
	Wed, 07 Jan 2026 09:59:48 +0100 (CET)
Authentication-Results: mail.toke.dk;
	dkim=fail reason="signature verification failed" (2048-bit key; unprotected) header.d=gmail.com header.i=@gmail.com header.a=rsa-sha256 header.s=20230601 header.b=UNUzuvJr
ARC-Seal: i=1; cv=none; a=rsa-sha256; d=toke.dk; s=arc202507;
 t=1767776388;
 b=0EFCu5pZrnHk6lQLKGA/zYQYd9CQOCk30GVBytQghgu3YEuHzsMjS4HKYRbn2VsMZnnMV
 kfJlti0y7ditfAaLhPPeVd5zpi0KVEirrtES1ZIih1Ma5XderiZ8pit/+YbkuqQ9kEEtvij
 +/kyou6BHmw00cdW35P/pt8o+bLVYeA=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=toke.dk;
 s=arc202507; t=1767776388; h=from : sender : reply-to : subject : date
 : message-id : to : cc : mime-version : content-type :
 content-transfer-encoding : content-id : content-description :
 resent-date : resent-from : resent-sender : resent-to : resent-cc :
 resent-message-id : in-reply-to : references : list-id : list-help :
 list-unsubscribe : list-subscribe : list-post : list-owner :
 list-archive; bh=1LNpDvAt4KKCo9B5iQr9zbmhFtJPfnv2LqnR1MhrngQ=;
 b=Ay7c7wxZK+2GYmJgVKII7In0ztqS+eD7QIg9Mme6dZypVgBP6IJEJHblOor2M+asyKQWd
 4Md9kK75CBOciDLKI/N8cZEXxy/w+o7iC8jPu/iDIxTe3SumMuzMl9IAKDFf2rHkHpkTMMs
 AX+J8NbPa1MDYUQTluTkojkwH0Nhz6Y=
ARC-Authentication-Results: i=1; mail.toke.dk;
 spf=pass smtp.mailfrom=;
 dkim=pass header.d=gmail.com;
 arc=none;
 dmarc=pass header.from=gmail.com policy.dmarc=quarantine
Authentication-Results: mail.toke.dk; spf=pass smtp.mailfrom=;
 dkim=pass header.d=gmail.com; arc=none (Message is not ARC signed);
 dmarc=pass (Used From Domain Record) header.from=gmail.com
 policy.dmarc=quarantine
Received: from mail-yw1-x1134.google.com (mail-yw1-x1134.google.com
 [IPv6:2607:f8b0:4864:20::1134])
	by mail.toke.dk (Postfix) with ESMTPS id 5FA60B78A10
	for <cake@lists.bufferbloat.net>; Tue, 06 Jan 2026 22:57:18 +0100 (CET)
Received: by mail-yw1-x1134.google.com with SMTP id
 00721157ae682-78fdb90b670so14654877b3.2
        for <cake@lists.bufferbloat.net>;
 Tue, 06 Jan 2026 13:57:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20230601; t=1767736636; x=1768341436;
 darn=lists.bufferbloat.net;
        h=content-transfer-encoding:mime-version:subject:references
         :in-reply-to:message-id:cc:to:from:date:from:to:cc:subject:date
         :message-id:reply-to;
        bh=9c7sTn/Py5FZZ3UkQZ4CbjYlT8RY3X2GxydVfX4G0nc=;
        b=UNUzuvJrRVXJwLk2LcyV1pgxWplNRFnLWRhaDW9/nRWA5G8QRWP3vC7ZbVn6W8fCfC
         lPUCoSHfc/AT1cZryW4Ko23t9EQslcg3tD2GQMJHGM6G+ff6mtgF44NAkeQbCd5ffvlu
         EypLzmOcuVMyErAi4FI9r9NRswSTRyUoLxAutvm/oAlV9h1URkewDdsXD8oLyZMf6o6P
         0rlLOvShlhNMUTAroDzLqy5C7zek6FEpbs//5UwPfmul/D5WiuhhmeZt3ip73SgtO9uY
         tpi9pZb2pliU3imK+E9MRSA1XG6Dwq7oHxV+892p8XVSXAiNRMZ3O+iRS+83BGJqRfk5
         8xdA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1767736636; x=1768341436;
        h=content-transfer-encoding:mime-version:subject:references
         :in-reply-to:message-id:cc:to:from:date:x-gm-gg:x-gm-message-state
         :from:to:cc:subject:date:message-id:reply-to;
        bh=9c7sTn/Py5FZZ3UkQZ4CbjYlT8RY3X2GxydVfX4G0nc=;
        b=VfctfG/Y6ll87WsMhPi8DAO1Wc2JWT4xP+UMYS/nLcTCbcMQOefK7SsN872kzosH4D
         BLZMmgaysMwVpvOZA3Cnn+EUlsp+hbODvSqCXWL0JQvQ+PDuSqjaU50PSru3DcORprnO
         GVRbfaHlKwWR0bJF1QgPv23AFw76bPQ51j51UaLA+11JEbdo2+hmCo9fSqfD1u4mWrvf
         yaTuhJ0L7hubusUsQCLaFsPMBIeAxq7r7FAJZ5siUtWljLkM8ZxsQpR2X7D8zP7o9gqk
         jo8VNxJ2qYBSJjqCk1eL0bHsR8zvzm0ESVH4af548dP+EYtFHKig/MFLkXsTHTNwtEft
         Pj7Q==
X-Forwarded-Encrypted: i=1;
 AJvYcCU87dpHtJvrlHWrj2dRAXQNvySr+mnbn2RY4XSK5L642ehOZxx58j+yQ6aAUNS1IqGhgwRr@lists.bufferbloat.net
X-Gm-Message-State: AOJu0YwJdWUHWLmrTCMCLjD+QaNx6l71Yw3vhwBiZJ8REE464QMlqbOf
	HOQR5dZ4XnjnUIsWO6aT7lcZ6eKvb9GEfcy5BqImS/rRx3K4x5tBaXu1
X-Gm-Gg: AY/fxX5vVYf9ljRy9HLPki/GYQFgMa5hTI/QPG/RcNmCdAZzckCDG90lhVKNE5GoHBS
	z6+2/KbNDETM9gA1nCezjd8aI1LWp4AfI+SxJOZbsIiMii917OapDacSBLauPLxewyc2uMn8xFA
	kkRVnGR66/S8BTUQqpjBwWu12ZfTBh1pfiWlhV4w0pHuMoVQkRAMbyjWPKe73sM3wDyyFY4TuLf
	vwxGL1Lqyf5LAdq8sc8Dz+Z3hetSO3oS0AZjITFs7KuFwKQsBJQovv4OWHFzB9AMRJJXlhDaEgk
	zHtvJeoOk538/Bz/2YFBISll22tFb2MrzFDl8J/XzN3cIpOU9k0GSz6OyYQ7cC7NuW1cgJjgugD
	2YbLCgxwUFuvbJ13h0KDeZsHVjXmNzKLAP/XD1UTuXx0kjRv18HxoSyXUEIQU/JMNo5M5kEbD2g
	TSgZleVEXVe/XdQxtTcXMaFz1qK9lIAJ0dHDI6Ipjwr9qZPpO6T7xeRIKM5n8=
X-Google-Smtp-Source: 
 AGHT+IG9iV1FmB161RLJvM/93cGPVGoILduBsAQcdMQ+GL7bnAh+34oxutqFi/uzefh9XlSADMZFiA==
X-Received: by 2002:a05:690e:1186:b0:642:836:1048 with SMTP id
 956f58d0204a3-64716b39bc9mr444475d50.2.1767736636502;
        Tue, 06 Jan 2026 13:57:16 -0800 (PST)
Received: from gmail.com (250.4.48.34.bc.googleusercontent.com. [34.48.4.250])
        by smtp.gmail.com with UTF8SMTPSA id
 00721157ae682-790aa670b21sm11884687b3.33.2026.01.06.13.57.15
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Tue, 06 Jan 2026 13:57:15 -0800 (PST)
Date: Tue, 06 Jan 2026 16:57:15 -0500
From: Willem de Bruijn <willemdebruijn.kernel@gmail.com>
To: =?UTF-8?B?VG9rZSBIw7hpbGFuZC1Kw7hyZ2Vuc2Vu?= <toke@redhat.com>,
 =?UTF-8?B?VG9rZSBIw7hpbGFuZC1Kw7hyZ2Vuc2Vu?= <toke@toke.dk>,
 Jamal Hadi Salim <jhs@mojatatu.com>,
 Cong Wang <xiyou.wangcong@gmail.com>,
 Jiri Pirko <jiri@resnulli.us>,
 "David S. Miller" <davem@davemloft.net>,
 Eric Dumazet <edumazet@google.com>,
 Jakub Kicinski <kuba@kernel.org>,
 Paolo Abeni <pabeni@redhat.com>,
 Simon Horman <horms@kernel.org>
Cc: =?UTF-8?B?Sm9uYXMgS8O2cHBlbGVy?= <j.koeppeler@tu-berlin.de>,
 cake@lists.bufferbloat.net,
 netdev@vger.kernel.org,
 =?UTF-8?B?VG9rZSBIw7hpbGFuZC1Kw7hyZ2Vuc2Vu?= <toke@redhat.com>
Message-ID: <willemdebruijn.kernel.21e0da676fe64@gmail.com>
In-Reply-To: <20260106-mq-cake-sub-qdisc-v6-2-ee2e06b1eb1a@redhat.com>
References: <20260106-mq-cake-sub-qdisc-v6-0-ee2e06b1eb1a@redhat.com>
 <20260106-mq-cake-sub-qdisc-v6-2-ee2e06b1eb1a@redhat.com>
Mime-Version: 1.0
X-MailFrom: willemdebruijn.kernel@gmail.com
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; loop;
 banned-address; emergency; member-moderation
Message-ID-Hash: WH7BLGJNSTHI5T4CIJ6TU4SNNTEJSAKW
X-Message-ID-Hash: WH7BLGJNSTHI5T4CIJ6TU4SNNTEJSAKW
X-Mailman-Approved-At: Wed, 07 Jan 2026 09:59:47 +0100
X-Mailman-Version: 3.3.10
Precedence: list
Subject: [Cake] Re: [PATCH net-next v6 2/6] net/sched: sch_cake: Factor out config
 variables into separate struct
List-Id: Cake - FQ_codel the next generation <cake.lists.bufferbloat.net>
Archived-At: 
 <https://lists.bufferbloat.net/cake/willemdebruijn.kernel.21e0da676fe64@gmail.com/>
List-Archive: <https://lists.bufferbloat.net/cake/>
List-Help: <mailto:cake-request@lists.bufferbloat.net?subject=help>
List-Owner: <mailto:cake-owner@lists.bufferbloat.net>
List-Post: <mailto:cake@lists.bufferbloat.net>
List-Subscribe: <mailto:cake-join@lists.bufferbloat.net>
List-Unsubscribe: <mailto:cake-leave@lists.bufferbloat.net>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

VG9rZSBIw7hpbGFuZC1Kw7hyZ2Vuc2VuIHdyb3RlOg0KPiBGYWN0b3Igb3V0IGFsbCB0aGUgdXNl
ci1jb25maWd1cmFibGUgdmFyaWFibGVzIGludG8gYSBzZXBhcmF0ZSBzdHJ1Y3QNCj4gYW5kIGVt
YmVkIGl0IGludG8gc3RydWN0IGNha2Vfc2NoZWRfZGF0YS4gVGhpcyBpcyBkb25lIGluIHByZXBh
cmF0aW9uDQo+IGZvciBzaGFyaW5nIHRoZSBjb25maWd1cmF0aW9uIGFjcm9zcyBtdWx0aXBsZSBp
bnN0YW5jZXMgb2YgY2FrZSBpbiBhbiBtcQ0KPiBzZXR1cC4NCj4gDQo+IE5vIGZ1bmN0aW9uYWwg
Y2hhbmdlIGlzIGludGVuZGVkIHdpdGggdGhpcyBwYXRjaC4NCj4gDQo+IFJldmlld2VkLWJ5OiBK
YW1hbCBIYWRpIFNhbGltIDxqaHNAbW9qYXRhdHUuY29tPg0KPiBTaWduZWQtb2ZmLWJ5OiBUb2tl
IEjDuGlsYW5kLUrDuHJnZW5zZW4gPHRva2VAcmVkaGF0LmNvbT4NCj4gLS0tDQo+ICBuZXQvc2No
ZWQvc2NoX2Nha2UuYyB8IDI0NSArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0NCj4gIDEgZmlsZSBjaGFuZ2VkLCAxMzMgaW5zZXJ0aW9ucygrKSwgMTEy
IGRlbGV0aW9ucygtKQ0KPiANCj4gZGlmZiAtLWdpdCBhL25ldC9zY2hlZC9zY2hfY2FrZS5jIGIv
bmV0L3NjaGVkL3NjaF9jYWtlLmMNCj4gaW5kZXggNGE2NGQ2Mzk3YjZmLi5kNDU4MjU3ZDhhZmMg
MTAwNjQ0DQo+IC0tLSBhL25ldC9zY2hlZC9zY2hfY2FrZS5jDQo+ICsrKyBiL25ldC9zY2hlZC9z
Y2hfY2FrZS5jDQo+IEBAIC0xOTcsNDAgKzE5Nyw0MiBAQCBzdHJ1Y3QgY2FrZV90aW5fZGF0YSB7
DQo+ICAJdTMyCXdheV9jb2xsaXNpb25zOw0KPiAgfTsgLyogbnVtYmVyIG9mIHRpbnMgaXMgc21h
bGwsIHNvIHNpemUgb2YgdGhpcyBzdHJ1Y3QgZG9lc24ndCBtYXR0ZXIgbXVjaCAqLw0KPiAgDQo+
ICtzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcgew0KPiArCXU2NAkJcmF0ZV9icHM7DQo+ICsJdTY0
CQlpbnRlcnZhbDsNCj4gKwl1NjQJCXRhcmdldDsNCj4gKwl1MzIJCWJ1ZmZlcl9jb25maWdfbGlt
aXQ7DQo+ICsJdTMyCQlmd21hcmtfbWFzazsNCj4gKwl1MTYJCWZ3bWFya19zaGZ0Ow0KPiArCXMx
NgkJcmF0ZV9vdmVyaGVhZDsNCj4gKwl1MTYJCXJhdGVfbXB1Ow0KPiArCXUxNgkJcmF0ZV9mbGFn
czsNCj4gKwl1OAkJdGluX21vZGU7DQo+ICsJdTgJCWZsb3dfbW9kZTsNCj4gKwl1OAkJYXRtX21v
ZGU7DQo+ICsJdTgJCWFja19maWx0ZXI7DQo+ICt9Ow0KPiArDQo+ICBzdHJ1Y3QgY2FrZV9zY2hl
ZF9kYXRhIHsNCj4gIAlzdHJ1Y3QgdGNmX3Byb3RvIF9fcmN1ICpmaWx0ZXJfbGlzdDsgLyogb3B0
aW9uYWwgZXh0ZXJuYWwgY2xhc3NpZmllciAqLw0KPiAgCXN0cnVjdCB0Y2ZfYmxvY2sgKmJsb2Nr
Ow0KPiAgCXN0cnVjdCBjYWtlX3Rpbl9kYXRhICp0aW5zOw0KPiArCXN0cnVjdCBjYWtlX3NjaGVk
X2NvbmZpZyAqY29uZmlnOw0KPiAgDQo+ICAJc3RydWN0IGNha2VfaGVhcF9lbnRyeSBvdmVyZmxv
d19oZWFwW0NBS0VfUVVFVUVTICogQ0FLRV9NQVhfVElOU107DQo+IC0JdTE2CQlvdmVyZmxvd190
aW1lb3V0Ow0KPiAtDQo+IC0JdTE2CQl0aW5fY250Ow0KPiAtCXU4CQl0aW5fbW9kZTsNCj4gLQl1
OAkJZmxvd19tb2RlOw0KPiAtCXU4CQlhY2tfZmlsdGVyOw0KPiAtCXU4CQlhdG1fbW9kZTsNCj4g
LQ0KPiAtCXUzMgkJZndtYXJrX21hc2s7DQo+IC0JdTE2CQlmd21hcmtfc2hmdDsNCj4gIA0KPiAg
CS8qIHRpbWVfbmV4dCA9IHRpbWVfdGhpcyArICgobGVuICogcmF0ZV9ucykgPj4gcmF0ZV9zaGZ0
KSAqLw0KPiAtCXUxNgkJcmF0ZV9zaGZ0Ow0KPiAgCWt0aW1lX3QJCXRpbWVfbmV4dF9wYWNrZXQ7
DQo+ICAJa3RpbWVfdAkJZmFpbHNhZmVfbmV4dF9wYWNrZXQ7DQo+ICAJdTY0CQlyYXRlX25zOw0K
PiAtCXU2NAkJcmF0ZV9icHM7DQo+IC0JdTE2CQlyYXRlX2ZsYWdzOw0KPiAtCXMxNgkJcmF0ZV9v
dmVyaGVhZDsNCj4gLQl1MTYJCXJhdGVfbXB1Ow0KPiAtCXU2NAkJaW50ZXJ2YWw7DQo+IC0JdTY0
CQl0YXJnZXQ7DQo+ICsJdTE2CQlyYXRlX3NoZnQ7DQo+ICsJdTE2CQlvdmVyZmxvd190aW1lb3V0
Ow0KPiArCXUxNgkJdGluX2NudDsNCj4gIA0KPiAgCS8qIHJlc291cmNlIHRyYWNraW5nICovDQo+
ICAJdTMyCQlidWZmZXJfdXNlZDsNCj4gIAl1MzIJCWJ1ZmZlcl9tYXhfdXNlZDsNCj4gIAl1MzIJ
CWJ1ZmZlcl9saW1pdDsNCj4gLQl1MzIJCWJ1ZmZlcl9jb25maWdfbGltaXQ7DQo+ICANCj4gIAkv
KiBpbmRpY2VzIGZvciBkZXF1ZXVlICovDQo+ICAJdTE2CQljdXJfdGluOw0KPiBAQCAtMTE5OCw3
ICsxMjAwLDcgQEAgc3RhdGljIGJvb2wgY2FrZV90Y3BoX21heV9kcm9wKGNvbnN0IHN0cnVjdCB0
Y3BoZHIgKnRjcGgsDQo+ICBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKmNha2VfYWNrX2ZpbHRlcihz
dHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxLA0KPiAgCQkJCSAgICAgICBzdHJ1Y3QgY2FrZV9mbG93
ICpmbG93KQ0KPiAgew0KPiAtCWJvb2wgYWdncmVzc2l2ZSA9IHEtPmFja19maWx0ZXIgPT0gQ0FL
RV9BQ0tfQUdHUkVTU0lWRTsNCj4gKwlib29sIGFnZ3Jlc3NpdmUgPSBxLT5jb25maWctPmFja19m
aWx0ZXIgPT0gQ0FLRV9BQ0tfQUdHUkVTU0lWRTsNCj4gIAlzdHJ1Y3Qgc2tfYnVmZiAqZWxpZ19h
Y2sgPSBOVUxMLCAqZWxpZ19hY2tfcHJldiA9IE5VTEw7DQo+ICAJc3RydWN0IHNrX2J1ZmYgKnNr
Yl9jaGVjaywgKnNrYl9wcmV2ID0gTlVMTDsNCj4gIAljb25zdCBzdHJ1Y3QgaXB2NmhkciAqaXB2
NmgsICppcHY2aF9jaGVjazsNCj4gQEAgLTEzNTgsMTUgKzEzNjAsMTcgQEAgc3RhdGljIHU2NCBj
YWtlX2V3bWEodTY0IGF2ZywgdTY0IHNhbXBsZSwgdTMyIHNoaWZ0KQ0KPiAgCXJldHVybiBhdmc7
DQo+ICB9DQo+ICANCj4gLXN0YXRpYyB1MzIgY2FrZV9jYWxjX292ZXJoZWFkKHN0cnVjdCBjYWtl
X3NjaGVkX2RhdGEgKnEsIHUzMiBsZW4sIHUzMiBvZmYpDQo+ICtzdGF0aWMgdTMyIGNha2VfY2Fs
Y19vdmVyaGVhZChzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxZCwgdTMyIGxlbiwgdTMyIG9mZikN
Cj4gIHsNCj4gKwlzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcgKnEgPSBxZC0+Y29uZmlnOw0KPiAr
DQo+ICAJaWYgKHEtPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdfT1ZFUkhFQUQpDQo+ICAJCWxlbiAt
PSBvZmY7DQo+ICANCj4gLQlpZiAocS0+bWF4X25ldGxlbiA8IGxlbikNCj4gLQkJcS0+bWF4X25l
dGxlbiA9IGxlbjsNCj4gLQlpZiAocS0+bWluX25ldGxlbiA+IGxlbikNCj4gLQkJcS0+bWluX25l
dGxlbiA9IGxlbjsNCj4gKwlpZiAocWQtPm1heF9uZXRsZW4gPCBsZW4pDQo+ICsJCXFkLT5tYXhf
bmV0bGVuID0gbGVuOw0KPiArCWlmIChxZC0+bWluX25ldGxlbiA+IGxlbikNCj4gKwkJcWQtPm1p
bl9uZXRsZW4gPSBsZW47DQo+ICANCj4gIAlsZW4gKz0gcS0+cmF0ZV9vdmVyaGVhZDsNCj4gIA0K
PiBAQCAtMTM4NSwxMCArMTM4OSwxMCBAQCBzdGF0aWMgdTMyIGNha2VfY2FsY19vdmVyaGVhZChz
dHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxLCB1MzIgbGVuLCB1MzIgb2ZmKQ0KPiAgCQlsZW4gKz0g
KGxlbiArIDYzKSAvIDY0Ow0KPiAgCX0NCj4gIA0KPiAtCWlmIChxLT5tYXhfYWRqbGVuIDwgbGVu
KQ0KPiAtCQlxLT5tYXhfYWRqbGVuID0gbGVuOw0KPiAtCWlmIChxLT5taW5fYWRqbGVuID4gbGVu
KQ0KPiAtCQlxLT5taW5fYWRqbGVuID0gbGVuOw0KPiArCWlmIChxZC0+bWF4X2FkamxlbiA8IGxl
bikNCj4gKwkJcWQtPm1heF9hZGpsZW4gPSBsZW47DQo+ICsJaWYgKHFkLT5taW5fYWRqbGVuID4g
bGVuKQ0KPiArCQlxZC0+bWluX2FkamxlbiA9IGxlbjsNCj4gIA0KPiAgCXJldHVybiBsZW47DQo+
ICB9DQo+IEBAIC0xNTg2LDcgKzE1OTAsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGNha2VfZHJv
cChzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IHNrX2J1ZmYgKip0b19mcmVlKQ0KPiAgCWZsb3ct
PmRyb3BwZWQrKzsNCj4gIAliLT50aW5fZHJvcHBlZCsrOw0KPiAgDQo+IC0JaWYgKHEtPnJhdGVf
ZmxhZ3MgJiBDQUtFX0ZMQUdfSU5HUkVTUykNCj4gKwlpZiAocS0+Y29uZmlnLT5yYXRlX2ZsYWdz
ICYgQ0FLRV9GTEFHX0lOR1JFU1MpDQo+ICAJCWNha2VfYWR2YW5jZV9zaGFwZXIocSwgYiwgc2ti
LCBub3csIHRydWUpOw0KPiAgDQo+ICAJcWRpc2NfZHJvcF9yZWFzb24oc2tiLCBzY2gsIHRvX2Zy
ZWUsIFNLQl9EUk9QX1JFQVNPTl9RRElTQ19PVkVSTElNSVQpOw0KPiBAQCAtMTY1Niw3ICsxNjYw
LDggQEAgc3RhdGljIHU4IGNha2VfaGFuZGxlX2RpZmZzZXJ2KHN0cnVjdCBza19idWZmICpza2Is
IGJvb2wgd2FzaCkNCj4gIHN0YXRpYyBzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqY2FrZV9zZWxlY3Rf
dGluKHN0cnVjdCBRZGlzYyAqc2NoLA0KPiAgCQkJCQkgICAgIHN0cnVjdCBza19idWZmICpza2Ip
DQo+ICB7DQo+IC0Jc3RydWN0IGNha2Vfc2NoZWRfZGF0YSAqcSA9IHFkaXNjX3ByaXYoc2NoKTsN
Cj4gKwlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxZCA9IHFkaXNjX3ByaXYoc2NoKTsNCj4gKwlz
dHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcgKnEgPSBxZC0+Y29uZmlnOw0KPiAgCXUzMiB0aW4sIG1h
cms7DQo+ICAJYm9vbCB3YXNoOw0KPiAgCXU4IGRzY3A7DQo+IEBAIC0xNjczLDI0ICsxNjc4LDI0
IEBAIHN0YXRpYyBzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqY2FrZV9zZWxlY3RfdGluKHN0cnVjdCBR
ZGlzYyAqc2NoLA0KPiAgCWlmIChxLT50aW5fbW9kZSA9PSBDQUtFX0RJRkZTRVJWX0JFU1RFRkZP
UlQpDQo+ICAJCXRpbiA9IDA7DQo+ICANCj4gLQllbHNlIGlmIChtYXJrICYmIG1hcmsgPD0gcS0+
dGluX2NudCkNCj4gLQkJdGluID0gcS0+dGluX29yZGVyW21hcmsgLSAxXTsNCj4gKwllbHNlIGlm
IChtYXJrICYmIG1hcmsgPD0gcWQtPnRpbl9jbnQpDQo+ICsJCXRpbiA9IHFkLT50aW5fb3JkZXJb
bWFyayAtIDFdOw0KPiAgDQo+ICAJZWxzZSBpZiAoVENfSF9NQUooc2tiLT5wcmlvcml0eSkgPT0g
c2NoLT5oYW5kbGUgJiYNCj4gIAkJIFRDX0hfTUlOKHNrYi0+cHJpb3JpdHkpID4gMCAmJg0KPiAt
CQkgVENfSF9NSU4oc2tiLT5wcmlvcml0eSkgPD0gcS0+dGluX2NudCkNCj4gLQkJdGluID0gcS0+
dGluX29yZGVyW1RDX0hfTUlOKHNrYi0+cHJpb3JpdHkpIC0gMV07DQo+ICsJCSBUQ19IX01JTihz
a2ItPnByaW9yaXR5KSA8PSBxZC0+dGluX2NudCkNCj4gKwkJdGluID0gcWQtPnRpbl9vcmRlcltU
Q19IX01JTihza2ItPnByaW9yaXR5KSAtIDFdOw0KPiAgDQo+ICAJZWxzZSB7DQo+ICAJCWlmICgh
d2FzaCkNCj4gIAkJCWRzY3AgPSBjYWtlX2hhbmRsZV9kaWZmc2Vydihza2IsIHdhc2gpOw0KPiAt
CQl0aW4gPSBxLT50aW5faW5kZXhbZHNjcF07DQo+ICsJCXRpbiA9IHFkLT50aW5faW5kZXhbZHNj
cF07DQo+ICANCj4gLQkJaWYgKHVubGlrZWx5KHRpbiA+PSBxLT50aW5fY250KSkNCj4gKwkJaWYg
KHVubGlrZWx5KHRpbiA+PSBxZC0+dGluX2NudCkpDQo+ICAJCQl0aW4gPSAwOw0KPiAgCX0NCj4g
IA0KPiAtCXJldHVybiAmcS0+dGluc1t0aW5dOw0KPiArCXJldHVybiAmcWQtPnRpbnNbdGluXTsN
Cj4gIH0NCj4gIA0KPiAgc3RhdGljIHUzMiBjYWtlX2NsYXNzaWZ5KHN0cnVjdCBRZGlzYyAqc2No
LCBzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqKnQsDQo+IEBAIC0xNzQ2LDcgKzE3NTEsNyBAQCBzdGF0
aWMgczMyIGNha2VfZW5xdWV1ZShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgUWRpc2MgKnNj
aCwNCj4gIAlib29sIHNhbWVfZmxvdyA9IGZhbHNlOw0KPiAgDQo+ICAJLyogY2hvb3NlIGZsb3cg
dG8gaW5zZXJ0IGludG8gKi8NCj4gLQlpZHggPSBjYWtlX2NsYXNzaWZ5KHNjaCwgJmIsIHNrYiwg
cS0+Zmxvd19tb2RlLCAmcmV0KTsNCj4gKwlpZHggPSBjYWtlX2NsYXNzaWZ5KHNjaCwgJmIsIHNr
YiwgcS0+Y29uZmlnLT5mbG93X21vZGUsICZyZXQpOw0KPiAgCWlmIChpZHggPT0gMCkgew0KPiAg
CQlpZiAocmV0ICYgX19ORVRfWE1JVF9CWVBBU1MpDQo+ICAJCQlxZGlzY19xc3RhdHNfZHJvcChz
Y2gpOw0KPiBAQCAtMTc4MSw3ICsxNzg2LDcgQEAgc3RhdGljIHMzMiBjYWtlX2VucXVldWUoc3Ry
dWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IFFkaXNjICpzY2gsDQo+ICAJaWYgKHVubGlrZWx5KGxl
biA+IGItPm1heF9za2JsZW4pKQ0KPiAgCQliLT5tYXhfc2tibGVuID0gbGVuOw0KPiAgDQo+IC0J
aWYgKHFkaXNjX3BrdF9zZWdzKHNrYikgPiAxICYmIHEtPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdf
U1BMSVRfR1NPKSB7DQo+ICsJaWYgKHFkaXNjX3BrdF9zZWdzKHNrYikgPiAxICYmIHEtPmNvbmZp
Zy0+cmF0ZV9mbGFncyAmIENBS0VfRkxBR19TUExJVF9HU08pIHsNCj4gIAkJc3RydWN0IHNrX2J1
ZmYgKnNlZ3MsICpuc2tiOw0KPiAgCQluZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcyA9IG5ldGlm
X3NrYl9mZWF0dXJlcyhza2IpOw0KPiAgCQl1bnNpZ25lZCBpbnQgc2xlbiA9IDAsIG51bXNlZ3Mg
PSAwOw0KPiBAQCAtMTgyMyw3ICsxODI4LDcgQEAgc3RhdGljIHMzMiBjYWtlX2VucXVldWUoc3Ry
dWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IFFkaXNjICpzY2gsDQo+ICAJCWdldF9jb2JhbHRfY2Io
c2tiKS0+YWRqdXN0ZWRfbGVuID0gY2FrZV9vdmVyaGVhZChxLCBza2IpOw0KPiAgCQlmbG93X3F1
ZXVlX2FkZChmbG93LCBza2IpOw0KPiAgDQo+IC0JCWlmIChxLT5hY2tfZmlsdGVyKQ0KPiArCQlp
ZiAocS0+Y29uZmlnLT5hY2tfZmlsdGVyKQ0KPiAgCQkJYWNrID0gY2FrZV9hY2tfZmlsdGVyKHEs
IGZsb3cpOw0KPiAgDQo+ICAJCWlmIChhY2spIHsNCj4gQEAgLTE4MzIsNyArMTgzNyw3IEBAIHN0
YXRpYyBzMzIgY2FrZV9lbnF1ZXVlKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBRZGlzYyAq
c2NoLA0KPiAgCQkJYWNrX3BrdF9sZW4gPSBxZGlzY19wa3RfbGVuKGFjayk7DQo+ICAJCQliLT5i
eXRlcyArPSBhY2tfcGt0X2xlbjsNCj4gIAkJCXEtPmJ1ZmZlcl91c2VkICs9IHNrYi0+dHJ1ZXNp
emUgLSBhY2stPnRydWVzaXplOw0KPiAtCQkJaWYgKHEtPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdf
SU5HUkVTUykNCj4gKwkJCWlmIChxLT5jb25maWctPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdfSU5H
UkVTUykNCj4gIAkJCQljYWtlX2FkdmFuY2Vfc2hhcGVyKHEsIGIsIGFjaywgbm93LCB0cnVlKTsN
Cj4gIA0KPiAgCQkJcWRpc2NfdHJlZV9yZWR1Y2VfYmFja2xvZyhzY2gsIDEsIGFja19wa3RfbGVu
KTsNCj4gQEAgLTE4NTUsNyArMTg2MCw3IEBAIHN0YXRpYyBzMzIgY2FrZV9lbnF1ZXVlKHN0cnVj
dCBza19idWZmICpza2IsIHN0cnVjdCBRZGlzYyAqc2NoLA0KPiAgCQljYWtlX2hlYXBpZnlfdXAo
cSwgYi0+b3ZlcmZsb3dfaWR4W2lkeF0pOw0KPiAgDQo+ICAJLyogaW5jb21pbmcgYmFuZHdpZHRo
IGNhcGFjaXR5IGVzdGltYXRlICovDQo+IC0JaWYgKHEtPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdf
QVVUT1JBVEVfSU5HUkVTUykgew0KPiArCWlmIChxLT5jb25maWctPnJhdGVfZmxhZ3MgJiBDQUtF
X0ZMQUdfQVVUT1JBVEVfSU5HUkVTUykgew0KPiAgCQl1NjQgcGFja2V0X2ludGVydmFsID0gXA0K
PiAgCQkJa3RpbWVfdG9fbnMoa3RpbWVfc3ViKG5vdywgcS0+bGFzdF9wYWNrZXRfdGltZSkpOw0K
PiAgDQo+IEBAIC0xODg3LDcgKzE4OTIsNyBAQCBzdGF0aWMgczMyIGNha2VfZW5xdWV1ZShzdHJ1
Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgUWRpc2MgKnNjaCwNCj4gIAkJCWlmIChrdGltZV9hZnRl
cihub3csDQo+ICAJCQkJCWt0aW1lX2FkZF9tcyhxLT5sYXN0X3JlY29uZmlnX3RpbWUsDQo+ICAJ
CQkJCQkgICAgIDI1MCkpKSB7DQo+IC0JCQkJcS0+cmF0ZV9icHMgPSAocS0+YXZnX3BlYWtfYmFu
ZHdpZHRoICogMTUpID4+IDQ7DQo+ICsJCQkJcS0+Y29uZmlnLT5yYXRlX2JwcyA9IChxLT5hdmdf
cGVha19iYW5kd2lkdGggKiAxNSkgPj4gNDsNCj4gIAkJCQljYWtlX3JlY29uZmlndXJlKHNjaCk7
DQo+ICAJCQl9DQo+ICAJCX0NCj4gQEAgLTE5MDcsNyArMTkxMiw3IEBAIHN0YXRpYyBzMzIgY2Fr
ZV9lbnF1ZXVlKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBRZGlzYyAqc2NoLA0KPiAgCQlm
bG93LT5zZXQgPSBDQUtFX1NFVF9TUEFSU0U7DQo+ICAJCWItPnNwYXJzZV9mbG93X2NvdW50Kys7
DQo+ICANCj4gLQkJZmxvdy0+ZGVmaWNpdCA9IGNha2VfZ2V0X2Zsb3dfcXVhbnR1bShiLCBmbG93
LCBxLT5mbG93X21vZGUpOw0KPiArCQlmbG93LT5kZWZpY2l0ID0gY2FrZV9nZXRfZmxvd19xdWFu
dHVtKGIsIGZsb3csIHEtPmNvbmZpZy0+Zmxvd19tb2RlKTsNCj4gIAl9IGVsc2UgaWYgKGZsb3ct
PnNldCA9PSBDQUtFX1NFVF9TUEFSU0VfV0FJVCkgew0KPiAgCQkvKiB0aGlzIGZsb3cgd2FzIGVt
cHR5LCBhY2NvdW50ZWQgYXMgYSBzcGFyc2UgZmxvdywgYnV0IGFjdHVhbGx5DQo+ICAJCSAqIGlu
IHRoZSBidWxrIHJvdGF0aW9uLg0KPiBAQCAtMTkxNiw4ICsxOTIxLDggQEAgc3RhdGljIHMzMiBj
YWtlX2VucXVldWUoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IFFkaXNjICpzY2gsDQo+ICAJ
CWItPnNwYXJzZV9mbG93X2NvdW50LS07DQo+ICAJCWItPmJ1bGtfZmxvd19jb3VudCsrOw0KPiAg
DQo+IC0JCWNha2VfaW5jX3NyY2hvc3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3csIHEtPmZsb3df
bW9kZSk7DQo+IC0JCWNha2VfaW5jX2RzdGhvc3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3csIHEt
PmZsb3dfbW9kZSk7DQo+ICsJCWNha2VfaW5jX3NyY2hvc3RfYnVsa19mbG93X2NvdW50KGIsIGZs
b3csIHEtPmNvbmZpZy0+Zmxvd19tb2RlKTsNCj4gKwkJY2FrZV9pbmNfZHN0aG9zdF9idWxrX2Zs
b3dfY291bnQoYiwgZmxvdywgcS0+Y29uZmlnLT5mbG93X21vZGUpOw0KPiAgCX0NCj4gIA0KPiAg
CWlmIChxLT5idWZmZXJfdXNlZCA+IHEtPmJ1ZmZlcl9tYXhfdXNlZCkNCj4gQEAgLTIxMDQsOCAr
MjEwOSw4IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqY2FrZV9kZXF1ZXVlKHN0cnVjdCBRZGlz
YyAqc2NoKQ0KPiAgCQkJCWItPnNwYXJzZV9mbG93X2NvdW50LS07DQo+ICAJCQkJYi0+YnVsa19m
bG93X2NvdW50Kys7DQo+ICANCj4gLQkJCQljYWtlX2luY19zcmNob3N0X2J1bGtfZmxvd19jb3Vu
dChiLCBmbG93LCBxLT5mbG93X21vZGUpOw0KPiAtCQkJCWNha2VfaW5jX2RzdGhvc3RfYnVsa19m
bG93X2NvdW50KGIsIGZsb3csIHEtPmZsb3dfbW9kZSk7DQo+ICsJCQkJY2FrZV9pbmNfc3JjaG9z
dF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Y29uZmlnLT5mbG93X21vZGUpOw0KPiArCQkJ
CWNha2VfaW5jX2RzdGhvc3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3csIHEtPmNvbmZpZy0+Zmxv
d19tb2RlKTsNCj4gIA0KPiAgCQkJCWZsb3ctPnNldCA9IENBS0VfU0VUX0JVTEs7DQo+ICAJCQl9
IGVsc2Ugew0KPiBAQCAtMjExNyw3ICsyMTIyLDcgQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpj
YWtlX2RlcXVldWUoc3RydWN0IFFkaXNjICpzY2gpDQo+ICAJCQl9DQo+ICAJCX0NCj4gIA0KPiAt
CQlmbG93LT5kZWZpY2l0ICs9IGNha2VfZ2V0X2Zsb3dfcXVhbnR1bShiLCBmbG93LCBxLT5mbG93
X21vZGUpOw0KPiArCQlmbG93LT5kZWZpY2l0ICs9IGNha2VfZ2V0X2Zsb3dfcXVhbnR1bShiLCBm
bG93LCBxLT5jb25maWctPmZsb3dfbW9kZSk7DQo+ICAJCWxpc3RfbW92ZV90YWlsKCZmbG93LT5m
bG93Y2hhaW4sICZiLT5vbGRfZmxvd3MpOw0KPiAgDQo+ICAJCWdvdG8gcmV0cnk7DQo+IEBAIC0y
MTQxLDggKzIxNDYsOCBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKmNha2VfZGVxdWV1ZShzdHJ1
Y3QgUWRpc2MgKnNjaCkNCj4gIAkJCQlpZiAoZmxvdy0+c2V0ID09IENBS0VfU0VUX0JVTEspIHsN
Cj4gIAkJCQkJYi0+YnVsa19mbG93X2NvdW50LS07DQo+ICANCj4gLQkJCQkJY2FrZV9kZWNfc3Jj
aG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Zmxvd19tb2RlKTsNCj4gLQkJCQkJY2Fr
ZV9kZWNfZHN0aG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Zmxvd19tb2RlKTsNCj4g
KwkJCQkJY2FrZV9kZWNfc3JjaG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Y29uZmln
LT5mbG93X21vZGUpOw0KPiArCQkJCQljYWtlX2RlY19kc3Rob3N0X2J1bGtfZmxvd19jb3VudChi
LCBmbG93LCBxLT5jb25maWctPmZsb3dfbW9kZSk7DQo+ICANCj4gIAkJCQkJYi0+ZGVjYXlpbmdf
Zmxvd19jb3VudCsrOw0KPiAgCQkJCX0gZWxzZSBpZiAoZmxvdy0+c2V0ID09IENBS0VfU0VUX1NQ
QVJTRSB8fA0KPiBAQCAtMjE2MCw4ICsyMTY1LDggQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpj
YWtlX2RlcXVldWUoc3RydWN0IFFkaXNjICpzY2gpDQo+ICAJCQkJZWxzZSBpZiAoZmxvdy0+c2V0
ID09IENBS0VfU0VUX0JVTEspIHsNCj4gIAkJCQkJYi0+YnVsa19mbG93X2NvdW50LS07DQo+ICAN
Cj4gLQkJCQkJY2FrZV9kZWNfc3JjaG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Zmxv
d19tb2RlKTsNCj4gLQkJCQkJY2FrZV9kZWNfZHN0aG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxv
dywgcS0+Zmxvd19tb2RlKTsNCj4gKwkJCQkJY2FrZV9kZWNfc3JjaG9zdF9idWxrX2Zsb3dfY291
bnQoYiwgZmxvdywgcS0+Y29uZmlnLT5mbG93X21vZGUpOw0KPiArCQkJCQljYWtlX2RlY19kc3Ro
b3N0X2J1bGtfZmxvd19jb3VudChiLCBmbG93LCBxLT5jb25maWctPmZsb3dfbW9kZSk7DQo+ICAJ
CQkJfSBlbHNlDQo+ICAJCQkJCWItPmRlY2F5aW5nX2Zsb3dfY291bnQtLTsNCj4gIA0KPiBAQCAt
MjE3MiwxNCArMjE3NywxNCBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKmNha2VfZGVxdWV1ZShz
dHJ1Y3QgUWRpc2MgKnNjaCkNCj4gIA0KPiAgCQlyZWFzb24gPSBjb2JhbHRfc2hvdWxkX2Ryb3Ao
JmZsb3ctPmN2YXJzLCAmYi0+Y3BhcmFtcywgbm93LCBza2IsDQo+ICAJCQkJCSAgICAoYi0+YnVs
a19mbG93X2NvdW50ICoNCj4gLQkJCQkJICAgICAhIShxLT5yYXRlX2ZsYWdzICYNCj4gKwkJCQkJ
ICAgICAhIShxLT5jb25maWctPnJhdGVfZmxhZ3MgJg0KPiAgCQkJCQkJQ0FLRV9GTEFHX0lOR1JF
U1MpKSk7DQo+ICAJCS8qIExhc3QgcGFja2V0IGluIHF1ZXVlIG1heSBiZSBtYXJrZWQsIHNob3Vs
ZG4ndCBiZSBkcm9wcGVkICovDQo+ICAJCWlmIChyZWFzb24gPT0gU0tCX05PVF9EUk9QUEVEX1lF
VCB8fCAhZmxvdy0+aGVhZCkNCj4gIAkJCWJyZWFrOw0KPiAgDQo+ICAJCS8qIGRyb3AgdGhpcyBw
YWNrZXQsIGdldCBhbm90aGVyIG9uZSAqLw0KPiAtCQlpZiAocS0+cmF0ZV9mbGFncyAmIENBS0Vf
RkxBR19JTkdSRVNTKSB7DQo+ICsJCWlmIChxLT5jb25maWctPnJhdGVfZmxhZ3MgJiBDQUtFX0ZM
QUdfSU5HUkVTUykgew0KPiAgCQkJbGVuID0gY2FrZV9hZHZhbmNlX3NoYXBlcihxLCBiLCBza2Is
DQo+ICAJCQkJCQkgIG5vdywgdHJ1ZSk7DQo+ICAJCQlmbG93LT5kZWZpY2l0IC09IGxlbjsNCj4g
QEAgLTIxOTAsNyArMjE5NSw3IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqY2FrZV9kZXF1ZXVl
KHN0cnVjdCBRZGlzYyAqc2NoKQ0KPiAgCQlxZGlzY190cmVlX3JlZHVjZV9iYWNrbG9nKHNjaCwg
MSwgcWRpc2NfcGt0X2xlbihza2IpKTsNCj4gIAkJcWRpc2NfcXN0YXRzX2Ryb3Aoc2NoKTsNCj4g
IAkJcWRpc2NfZGVxdWV1ZV9kcm9wKHNjaCwgc2tiLCByZWFzb24pOw0KPiAtCQlpZiAocS0+cmF0
ZV9mbGFncyAmIENBS0VfRkxBR19JTkdSRVNTKQ0KPiArCQlpZiAocS0+Y29uZmlnLT5yYXRlX2Zs
YWdzICYgQ0FLRV9GTEFHX0lOR1JFU1MpDQo+ICAJCQlnb3RvIHJldHJ5Ow0KPiAgCX0NCj4gIA0K
PiBAQCAtMjMxMiw3ICsyMzE3LDcgQEAgc3RhdGljIGludCBjYWtlX2NvbmZpZ19iZXN0ZWZmb3J0
KHN0cnVjdCBRZGlzYyAqc2NoKQ0KPiAgCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlz
Y19wcml2KHNjaCk7DQo+ICAJc3RydWN0IGNha2VfdGluX2RhdGEgKmIgPSAmcS0+dGluc1swXTsN
Cj4gIAl1MzIgbXR1ID0gcHNjaGVkX210dShxZGlzY19kZXYoc2NoKSk7DQo+IC0JdTY0IHJhdGUg
PSBxLT5yYXRlX2JwczsNCj4gKwl1NjQgcmF0ZSA9IHEtPmNvbmZpZy0+cmF0ZV9icHM7DQo+ICAN
Cj4gIAlxLT50aW5fY250ID0gMTsNCj4gIA0KPiBAQCAtMjMyMCw3ICsyMzI1LDcgQEAgc3RhdGlj
IGludCBjYWtlX2NvbmZpZ19iZXN0ZWZmb3J0KHN0cnVjdCBRZGlzYyAqc2NoKQ0KPiAgCXEtPnRp
bl9vcmRlciA9IG5vcm1hbF9vcmRlcjsNCj4gIA0KPiAgCWNha2Vfc2V0X3JhdGUoYiwgcmF0ZSwg
bXR1LA0KPiAtCQkgICAgICB1c190b19ucyhxLT50YXJnZXQpLCB1c190b19ucyhxLT5pbnRlcnZh
bCkpOw0KPiArCQkgICAgICB1c190b19ucyhxLT5jb25maWctPnRhcmdldCksIHVzX3RvX25zKHEt
PmNvbmZpZy0+aW50ZXJ2YWwpKTsNCj4gIAliLT50aW5fcXVhbnR1bSA9IDY1NTM1Ow0KPiAgDQo+
ICAJcmV0dXJuIDA7DQo+IEBAIC0yMzMxLDcgKzIzMzYsNyBAQCBzdGF0aWMgaW50IGNha2VfY29u
ZmlnX3ByZWNlZGVuY2Uoc3RydWN0IFFkaXNjICpzY2gpDQo+ICAJLyogY29udmVydCBoaWdoLWxl
dmVsICh1c2VyIHZpc2libGUpIHBhcmFtZXRlcnMgaW50byBpbnRlcm5hbCBmb3JtYXQgKi8NCj4g
IAlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxID0gcWRpc2NfcHJpdihzY2gpOw0KPiAgCXUzMiBt
dHUgPSBwc2NoZWRfbXR1KHFkaXNjX2RldihzY2gpKTsNCj4gLQl1NjQgcmF0ZSA9IHEtPnJhdGVf
YnBzOw0KPiArCXU2NCByYXRlID0gcS0+Y29uZmlnLT5yYXRlX2JwczsNCj4gIAl1MzIgcXVhbnR1
bSA9IDI1NjsNCj4gIAl1MzIgaTsNCj4gIA0KPiBAQCAtMjM0Miw4ICsyMzQ3LDggQEAgc3RhdGlj
IGludCBjYWtlX2NvbmZpZ19wcmVjZWRlbmNlKHN0cnVjdCBRZGlzYyAqc2NoKQ0KPiAgCWZvciAo
aSA9IDA7IGkgPCBxLT50aW5fY250OyBpKyspIHsNCj4gIAkJc3RydWN0IGNha2VfdGluX2RhdGEg
KmIgPSAmcS0+dGluc1tpXTsNCj4gIA0KPiAtCQljYWtlX3NldF9yYXRlKGIsIHJhdGUsIG10dSwg
dXNfdG9fbnMocS0+dGFyZ2V0KSwNCj4gLQkJCSAgICAgIHVzX3RvX25zKHEtPmludGVydmFsKSk7
DQo+ICsJCWNha2Vfc2V0X3JhdGUoYiwgcmF0ZSwgbXR1LCB1c190b19ucyhxLT5jb25maWctPnRh
cmdldCksDQo+ICsJCQkgICAgICB1c190b19ucyhxLT5jb25maWctPmludGVydmFsKSk7DQo+ICAN
Cj4gIAkJYi0+dGluX3F1YW50dW0gPSBtYXhfdCh1MTYsIDFVLCBxdWFudHVtKTsNCj4gIA0KPiBA
QCAtMjQyMCw3ICsyNDI1LDcgQEAgc3RhdGljIGludCBjYWtlX2NvbmZpZ19kaWZmc2Vydjgoc3Ry
dWN0IFFkaXNjICpzY2gpDQo+ICANCj4gIAlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxID0gcWRp
c2NfcHJpdihzY2gpOw0KPiAgCXUzMiBtdHUgPSBwc2NoZWRfbXR1KHFkaXNjX2RldihzY2gpKTsN
Cj4gLQl1NjQgcmF0ZSA9IHEtPnJhdGVfYnBzOw0KPiArCXU2NCByYXRlID0gcS0+Y29uZmlnLT5y
YXRlX2JwczsNCj4gIAl1MzIgcXVhbnR1bSA9IDI1NjsNCj4gIAl1MzIgaTsNCj4gIA0KPiBAQCAt
MjQzNCw4ICsyNDM5LDggQEAgc3RhdGljIGludCBjYWtlX2NvbmZpZ19kaWZmc2Vydjgoc3RydWN0
IFFkaXNjICpzY2gpDQo+ICAJZm9yIChpID0gMDsgaSA8IHEtPnRpbl9jbnQ7IGkrKykgew0KPiAg
CQlzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqYiA9ICZxLT50aW5zW2ldOw0KPiAgDQo+IC0JCWNha2Vf
c2V0X3JhdGUoYiwgcmF0ZSwgbXR1LCB1c190b19ucyhxLT50YXJnZXQpLA0KPiAtCQkJICAgICAg
dXNfdG9fbnMocS0+aW50ZXJ2YWwpKTsNCj4gKwkJY2FrZV9zZXRfcmF0ZShiLCByYXRlLCBtdHUs
IHVzX3RvX25zKHEtPmNvbmZpZy0+dGFyZ2V0KSwNCj4gKwkJCSAgICAgIHVzX3RvX25zKHEtPmNv
bmZpZy0+aW50ZXJ2YWwpKTsNCj4gIA0KPiAgCQliLT50aW5fcXVhbnR1bSA9IG1heF90KHUxNiwg
MVUsIHF1YW50dW0pOw0KPiAgDQo+IEBAIC0yNDY0LDcgKzI0NjksNyBAQCBzdGF0aWMgaW50IGNh
a2VfY29uZmlnX2RpZmZzZXJ2NChzdHJ1Y3QgUWRpc2MgKnNjaCkNCj4gIA0KPiAgCXN0cnVjdCBj
YWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7DQo+ICAJdTMyIG10dSA9IHBzY2hl
ZF9tdHUocWRpc2NfZGV2KHNjaCkpOw0KPiAtCXU2NCByYXRlID0gcS0+cmF0ZV9icHM7DQo+ICsJ
dTY0IHJhdGUgPSBxLT5jb25maWctPnJhdGVfYnBzOw0KPiAgCXUzMiBxdWFudHVtID0gMTAyNDsN
Cj4gIA0KPiAgCXEtPnRpbl9jbnQgPSA0Ow0KPiBAQCAtMjQ3NSwxMyArMjQ4MCwxMyBAQCBzdGF0
aWMgaW50IGNha2VfY29uZmlnX2RpZmZzZXJ2NChzdHJ1Y3QgUWRpc2MgKnNjaCkNCj4gIA0KPiAg
CS8qIGNsYXNzIGNoYXJhY3RlcmlzdGljcyAqLw0KPiAgCWNha2Vfc2V0X3JhdGUoJnEtPnRpbnNb
MF0sIHJhdGUsIG10dSwNCj4gLQkJICAgICAgdXNfdG9fbnMocS0+dGFyZ2V0KSwgdXNfdG9fbnMo
cS0+aW50ZXJ2YWwpKTsNCj4gKwkJICAgICAgdXNfdG9fbnMocS0+Y29uZmlnLT50YXJnZXQpLCB1
c190b19ucyhxLT5jb25maWctPmludGVydmFsKSk7DQo+ICAJY2FrZV9zZXRfcmF0ZSgmcS0+dGlu
c1sxXSwgcmF0ZSA+PiA0LCBtdHUsDQo+IC0JCSAgICAgIHVzX3RvX25zKHEtPnRhcmdldCksIHVz
X3RvX25zKHEtPmludGVydmFsKSk7DQo+ICsJCSAgICAgIHVzX3RvX25zKHEtPmNvbmZpZy0+dGFy
Z2V0KSwgdXNfdG9fbnMocS0+Y29uZmlnLT5pbnRlcnZhbCkpOw0KPiAgCWNha2Vfc2V0X3JhdGUo
JnEtPnRpbnNbMl0sIHJhdGUgPj4gMSwgbXR1LA0KPiAtCQkgICAgICB1c190b19ucyhxLT50YXJn
ZXQpLCB1c190b19ucyhxLT5pbnRlcnZhbCkpOw0KPiArCQkgICAgICB1c190b19ucyhxLT5jb25m
aWctPnRhcmdldCksIHVzX3RvX25zKHEtPmNvbmZpZy0+aW50ZXJ2YWwpKTsNCj4gIAljYWtlX3Nl
dF9yYXRlKCZxLT50aW5zWzNdLCByYXRlID4+IDIsIG10dSwNCj4gLQkJICAgICAgdXNfdG9fbnMo
cS0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+aW50ZXJ2YWwpKTsNCj4gKwkJICAgICAgdXNfdG9fbnMo
cS0+Y29uZmlnLT50YXJnZXQpLCB1c190b19ucyhxLT5jb25maWctPmludGVydmFsKSk7DQo+ICAN
Cj4gIAkvKiBiYW5kd2lkdGgtc2hhcmluZyB3ZWlnaHRzICovDQo+ICAJcS0+dGluc1swXS50aW5f
cXVhbnR1bSA9IHF1YW50dW07DQo+IEBAIC0yNTAxLDcgKzI1MDYsNyBAQCBzdGF0aWMgaW50IGNh
a2VfY29uZmlnX2RpZmZzZXJ2MyhzdHJ1Y3QgUWRpc2MgKnNjaCkNCj4gICAqLw0KPiAgCXN0cnVj
dCBjYWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7DQo+ICAJdTMyIG10dSA9IHBz
Y2hlZF9tdHUocWRpc2NfZGV2KHNjaCkpOw0KPiAtCXU2NCByYXRlID0gcS0+cmF0ZV9icHM7DQo+
ICsJdTY0IHJhdGUgPSBxLT5jb25maWctPnJhdGVfYnBzOw0KPiAgCXUzMiBxdWFudHVtID0gMTAy
NDsNCj4gIA0KPiAgCXEtPnRpbl9jbnQgPSAzOw0KPiBAQCAtMjUxMiwxMSArMjUxNywxMSBAQCBz
dGF0aWMgaW50IGNha2VfY29uZmlnX2RpZmZzZXJ2MyhzdHJ1Y3QgUWRpc2MgKnNjaCkNCj4gIA0K
PiAgCS8qIGNsYXNzIGNoYXJhY3RlcmlzdGljcyAqLw0KPiAgCWNha2Vfc2V0X3JhdGUoJnEtPnRp
bnNbMF0sIHJhdGUsIG10dSwNCj4gLQkJICAgICAgdXNfdG9fbnMocS0+dGFyZ2V0KSwgdXNfdG9f
bnMocS0+aW50ZXJ2YWwpKTsNCj4gKwkJICAgICAgdXNfdG9fbnMocS0+Y29uZmlnLT50YXJnZXQp
LCB1c190b19ucyhxLT5jb25maWctPmludGVydmFsKSk7DQo+ICAJY2FrZV9zZXRfcmF0ZSgmcS0+
dGluc1sxXSwgcmF0ZSA+PiA0LCBtdHUsDQo+IC0JCSAgICAgIHVzX3RvX25zKHEtPnRhcmdldCks
IHVzX3RvX25zKHEtPmludGVydmFsKSk7DQo+ICsJCSAgICAgIHVzX3RvX25zKHEtPmNvbmZpZy0+
dGFyZ2V0KSwgdXNfdG9fbnMocS0+Y29uZmlnLT5pbnRlcnZhbCkpOw0KPiAgCWNha2Vfc2V0X3Jh
dGUoJnEtPnRpbnNbMl0sIHJhdGUgPj4gMiwgbXR1LA0KPiAtCQkgICAgICB1c190b19ucyhxLT50
YXJnZXQpLCB1c190b19ucyhxLT5pbnRlcnZhbCkpOw0KPiArCQkgICAgICB1c190b19ucyhxLT5j
b25maWctPnRhcmdldCksIHVzX3RvX25zKHEtPmNvbmZpZy0+aW50ZXJ2YWwpKTsNCj4gIA0KPiAg
CS8qIGJhbmR3aWR0aC1zaGFyaW5nIHdlaWdodHMgKi8NCj4gIAlxLT50aW5zWzBdLnRpbl9xdWFu
dHVtID0gcXVhbnR1bTsNCj4gQEAgLTI1MjgsNyArMjUzMyw4IEBAIHN0YXRpYyBpbnQgY2FrZV9j
b25maWdfZGlmZnNlcnYzKHN0cnVjdCBRZGlzYyAqc2NoKQ0KPiAgDQo+ICBzdGF0aWMgdm9pZCBj
YWtlX3JlY29uZmlndXJlKHN0cnVjdCBRZGlzYyAqc2NoKQ0KPiAgew0KPiAtCXN0cnVjdCBjYWtl
X3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7DQo+ICsJc3RydWN0IGNha2Vfc2NoZWRf
ZGF0YSAqcWQgPSBxZGlzY19wcml2KHNjaCk7DQo+ICsJc3RydWN0IGNha2Vfc2NoZWRfY29uZmln
ICpxID0gcWQtPmNvbmZpZzsNCj4gIAlpbnQgYywgZnQ7DQo+ICANCj4gIAlzd2l0Y2ggKHEtPnRp
bl9tb2RlKSB7DQo+IEBAIC0yNTU0LDM2ICsyNTYwLDM3IEBAIHN0YXRpYyB2b2lkIGNha2VfcmVj
b25maWd1cmUoc3RydWN0IFFkaXNjICpzY2gpDQo+ICAJCWJyZWFrOw0KPiAgCX0NCj4gIA0KPiAt
CWZvciAoYyA9IHEtPnRpbl9jbnQ7IGMgPCBDQUtFX01BWF9USU5TOyBjKyspIHsNCj4gKwlmb3Ig
KGMgPSBxZC0+dGluX2NudDsgYyA8IENBS0VfTUFYX1RJTlM7IGMrKykgew0KPiAgCQljYWtlX2Ns
ZWFyX3RpbihzY2gsIGMpOw0KPiAtCQlxLT50aW5zW2NdLmNwYXJhbXMubXR1X3RpbWUgPSBxLT50
aW5zW2Z0XS5jcGFyYW1zLm10dV90aW1lOw0KPiArCQlxZC0+dGluc1tjXS5jcGFyYW1zLm10dV90
aW1lID0gcWQtPnRpbnNbZnRdLmNwYXJhbXMubXR1X3RpbWU7DQo+ICAJfQ0KPiAgDQo+IC0JcS0+
cmF0ZV9ucyAgID0gcS0+dGluc1tmdF0udGluX3JhdGVfbnM7DQo+IC0JcS0+cmF0ZV9zaGZ0ID0g
cS0+dGluc1tmdF0udGluX3JhdGVfc2hmdDsNCj4gKwlxZC0+cmF0ZV9ucyAgID0gcWQtPnRpbnNb
ZnRdLnRpbl9yYXRlX25zOw0KPiArCXFkLT5yYXRlX3NoZnQgPSBxZC0+dGluc1tmdF0udGluX3Jh
dGVfc2hmdDsNCj4gIA0KPiAgCWlmIChxLT5idWZmZXJfY29uZmlnX2xpbWl0KSB7DQo+IC0JCXEt
PmJ1ZmZlcl9saW1pdCA9IHEtPmJ1ZmZlcl9jb25maWdfbGltaXQ7DQo+ICsJCXFkLT5idWZmZXJf
bGltaXQgPSBxLT5idWZmZXJfY29uZmlnX2xpbWl0Ow0KPiAgCX0gZWxzZSBpZiAocS0+cmF0ZV9i
cHMpIHsNCj4gIAkJdTY0IHQgPSBxLT5yYXRlX2JwcyAqIHEtPmludGVydmFsOw0KPiAgDQo+ICAJ
CWRvX2Rpdih0LCBVU0VDX1BFUl9TRUMgLyA0KTsNCj4gLQkJcS0+YnVmZmVyX2xpbWl0ID0gbWF4
X3QodTMyLCB0LCA0VSA8PCAyMCk7DQo+ICsJCXFkLT5idWZmZXJfbGltaXQgPSBtYXhfdCh1MzIs
IHQsIDRVIDw8IDIwKTsNCj4gIAl9IGVsc2Ugew0KPiAtCQlxLT5idWZmZXJfbGltaXQgPSB+MDsN
Cj4gKwkJcWQtPmJ1ZmZlcl9saW1pdCA9IH4wOw0KPiAgCX0NCj4gIA0KPiAgCXNjaC0+ZmxhZ3Mg
Jj0gflRDUV9GX0NBTl9CWVBBU1M7DQo+ICANCj4gLQlxLT5idWZmZXJfbGltaXQgPSBtaW4ocS0+
YnVmZmVyX2xpbWl0LA0KPiAtCQkJICAgICAgbWF4KHNjaC0+bGltaXQgKiBwc2NoZWRfbXR1KHFk
aXNjX2RldihzY2gpKSwNCj4gLQkJCQkgIHEtPmJ1ZmZlcl9jb25maWdfbGltaXQpKTsNCj4gKwlx
ZC0+YnVmZmVyX2xpbWl0ID0gbWluKHFkLT5idWZmZXJfbGltaXQsDQo+ICsJCQkgICAgICAgbWF4
KHNjaC0+bGltaXQgKiBwc2NoZWRfbXR1KHFkaXNjX2RldihzY2gpKSwNCj4gKwkJCQkgICBxLT5i
dWZmZXJfY29uZmlnX2xpbWl0KSk7DQo+ICB9DQo+ICANCj4gIHN0YXRpYyBpbnQgY2FrZV9jaGFu
Z2Uoc3RydWN0IFFkaXNjICpzY2gsIHN0cnVjdCBubGF0dHIgKm9wdCwNCj4gIAkJICAgICAgIHN0
cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaykNCj4gIHsNCj4gLQlzdHJ1Y3QgY2FrZV9zY2hl
ZF9kYXRhICpxID0gcWRpc2NfcHJpdihzY2gpOw0KPiArCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEg
KnFkID0gcWRpc2NfcHJpdihzY2gpOw0KPiArCXN0cnVjdCBjYWtlX3NjaGVkX2NvbmZpZyAqcSA9
IHFkLT5jb25maWc7DQo+ICAJc3RydWN0IG5sYXR0ciAqdGJbVENBX0NBS0VfTUFYICsgMV07DQo+
ICAJdTE2IHJhdGVfZmxhZ3M7DQo+ICAJdTggZmxvd19tb2RlOw0KPiBAQCAtMjYzNywxOSArMjY0
NCwxOSBAQCBzdGF0aWMgaW50IGNha2VfY2hhbmdlKHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3Qg
bmxhdHRyICpvcHQsDQo+ICAJCQkgICBubGFfZ2V0X3MzMih0YltUQ0FfQ0FLRV9PVkVSSEVBRF0p
KTsNCj4gIAkJcmF0ZV9mbGFncyB8PSBDQUtFX0ZMQUdfT1ZFUkhFQUQ7DQo+ICANCj4gLQkJcS0+
bWF4X25ldGxlbiA9IDA7DQo+IC0JCXEtPm1heF9hZGpsZW4gPSAwOw0KPiAtCQlxLT5taW5fbmV0
bGVuID0gfjA7DQo+IC0JCXEtPm1pbl9hZGpsZW4gPSB+MDsNCj4gKwkJcWQtPm1heF9uZXRsZW4g
PSAwOw0KPiArCQlxZC0+bWF4X2FkamxlbiA9IDA7DQo+ICsJCXFkLT5taW5fbmV0bGVuID0gfjA7
DQo+ICsJCXFkLT5taW5fYWRqbGVuID0gfjA7DQo+ICAJfQ0KPiAgDQo+ICAJaWYgKHRiW1RDQV9D
QUtFX1JBV10pIHsNCj4gIAkJcmF0ZV9mbGFncyAmPSB+Q0FLRV9GTEFHX09WRVJIRUFEOw0KPiAg
DQo+IC0JCXEtPm1heF9uZXRsZW4gPSAwOw0KPiAtCQlxLT5tYXhfYWRqbGVuID0gMDsNCj4gLQkJ
cS0+bWluX25ldGxlbiA9IH4wOw0KPiAtCQlxLT5taW5fYWRqbGVuID0gfjA7DQo+ICsJCXFkLT5t
YXhfbmV0bGVuID0gMDsNCj4gKwkJcWQtPm1heF9hZGpsZW4gPSAwOw0KPiArCQlxZC0+bWluX25l
dGxlbiA9IH4wOw0KPiArCQlxZC0+bWluX2FkamxlbiA9IH4wOw0KPiAgCX0NCj4gIA0KPiAgCWlm
ICh0YltUQ0FfQ0FLRV9NUFVdKQ0KPiBAQCAtMjcwNSw3ICsyNzEyLDcgQEAgc3RhdGljIGludCBj
YWtlX2NoYW5nZShzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IG5sYXR0ciAqb3B0LA0KPiAgDQo+
ICAJV1JJVEVfT05DRShxLT5yYXRlX2ZsYWdzLCByYXRlX2ZsYWdzKTsNCj4gIAlXUklURV9PTkNF
KHEtPmZsb3dfbW9kZSwgZmxvd19tb2RlKTsNCj4gLQlpZiAocS0+dGlucykgew0KPiArCWlmIChx
ZC0+dGlucykgew0KPiAgCQlzY2hfdHJlZV9sb2NrKHNjaCk7DQo+ICAJCWNha2VfcmVjb25maWd1
cmUoc2NoKTsNCj4gIAkJc2NoX3RyZWVfdW5sb2NrKHNjaCk7DQo+IEBAIC0yNzIxLDE0ICsyNzI4
LDIwIEBAIHN0YXRpYyB2b2lkIGNha2VfZGVzdHJveShzdHJ1Y3QgUWRpc2MgKnNjaCkNCj4gIAlx
ZGlzY193YXRjaGRvZ19jYW5jZWwoJnEtPndhdGNoZG9nKTsNCj4gIAl0Y2ZfYmxvY2tfcHV0KHEt
PmJsb2NrKTsNCj4gIAlrdmZyZWUocS0+dGlucyk7DQo+ICsJa3ZmcmVlKHEtPmNvbmZpZyk7DQo+
ICB9DQo+ICANCj4gIHN0YXRpYyBpbnQgY2FrZV9pbml0KHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1
Y3QgbmxhdHRyICpvcHQsDQo+ICAJCSAgICAgc3RydWN0IG5ldGxpbmtfZXh0X2FjayAqZXh0YWNr
KQ0KPiAgew0KPiAtCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7
DQo+ICsJc3RydWN0IGNha2Vfc2NoZWRfZGF0YSAqcWQgPSBxZGlzY19wcml2KHNjaCk7DQo+ICsJ
c3RydWN0IGNha2Vfc2NoZWRfY29uZmlnICpxOw0KPiAgCWludCBpLCBqLCBlcnI7DQo+ICANCj4g
KwlxID0ga3ZjYWxsb2MoMSwgc2l6ZW9mKHN0cnVjdCBjYWtlX3NjaGVkX2NvbmZpZyksIEdGUF9L
RVJORUwpOw0KPiArCWlmICghcSkNCj4gKwkJcmV0dXJuIC1FTk9NRU07DQo+ICsNCg0KQ2FuIHRo
aXMganVzdCBiZSBhIHJlZ3VsYXIga3phbGxvYz8NCg0KTW9yZSBpbXBvcnRhbnRseSwgd2hlcmUg
aXMgcSBhc3NpZ25lZCB0byBxZC0+Y29uZmlnIGFmdGVyIGluaXQ/DQoNCj4gIAlzY2gtPmxpbWl0
ID0gMTAyNDA7DQo+ICAJc2NoLT5mbGFncyB8PSBUQ1FfRl9ERVFVRVVFX0RST1BTOw0KPiAgDQo+
IEBAIC0yNzQyLDMzICsyNzU1LDM2IEBAIHN0YXRpYyBpbnQgY2FrZV9pbml0KHN0cnVjdCBRZGlz
YyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQo+ICAJCQkgICAgICAgKiBmb3IgNSB0byAxMCUg
b2YgaW50ZXJ2YWwNCj4gIAkJCSAgICAgICAqLw0KPiAgCXEtPnJhdGVfZmxhZ3MgfD0gQ0FLRV9G
TEFHX1NQTElUX0dTTzsNCj4gLQlxLT5jdXJfdGluID0gMDsNCj4gLQlxLT5jdXJfZmxvdyAgPSAw
Ow0KPiArCXFkLT5jdXJfdGluID0gMDsNCj4gKwlxZC0+Y3VyX2Zsb3cgID0gMDsNCj4gKwlxZC0+
Y29uZmlnID0gcTsNCj4gIA0KPiAtCXFkaXNjX3dhdGNoZG9nX2luaXQoJnEtPndhdGNoZG9nLCBz
Y2gpOw0KPiArCXFkaXNjX3dhdGNoZG9nX2luaXQoJnFkLT53YXRjaGRvZywgc2NoKTsNCj4gIA0K
PiAgCWlmIChvcHQpIHsNCj4gIAkJZXJyID0gY2FrZV9jaGFuZ2Uoc2NoLCBvcHQsIGV4dGFjayk7
DQo+ICANCj4gIAkJaWYgKGVycikNCj4gLQkJCXJldHVybiBlcnI7DQo+ICsJCQlnb3RvIGVycjsN
Cj4gIAl9DQo+ICANCj4gLQllcnIgPSB0Y2ZfYmxvY2tfZ2V0KCZxLT5ibG9jaywgJnEtPmZpbHRl
cl9saXN0LCBzY2gsIGV4dGFjayk7DQo+ICsJZXJyID0gdGNmX2Jsb2NrX2dldCgmcWQtPmJsb2Nr
LCAmcWQtPmZpbHRlcl9saXN0LCBzY2gsIGV4dGFjayk7DQo+ICAJaWYgKGVycikNCj4gLQkJcmV0
dXJuIGVycjsNCj4gKwkJZ290byBlcnI7DQo+ICANCj4gIAlxdWFudHVtX2RpdlswXSA9IH4wOw0K
PiAgCWZvciAoaSA9IDE7IGkgPD0gQ0FLRV9RVUVVRVM7IGkrKykNCj4gIAkJcXVhbnR1bV9kaXZb
aV0gPSA2NTUzNSAvIGk7DQo+ICANCj4gLQlxLT50aW5zID0ga3ZjYWxsb2MoQ0FLRV9NQVhfVElO
Uywgc2l6ZW9mKHN0cnVjdCBjYWtlX3Rpbl9kYXRhKSwNCj4gLQkJCSAgIEdGUF9LRVJORUwpOw0K
PiAtCWlmICghcS0+dGlucykNCj4gLQkJcmV0dXJuIC1FTk9NRU07DQo+ICsJcWQtPnRpbnMgPSBr
dmNhbGxvYyhDQUtFX01BWF9USU5TLCBzaXplb2Yoc3RydWN0IGNha2VfdGluX2RhdGEpLA0KPiAr
CQkJICAgIEdGUF9LRVJORUwpOw0KPiArCWlmICghcWQtPnRpbnMpIHsNCj4gKwkJZXJyID0gLUVO
T01FTTsNCj4gKwkJZ290byBlcnI7DQo+ICsJfQ0KPiAgDQo+ICAJZm9yIChpID0gMDsgaSA8IENB
S0VfTUFYX1RJTlM7IGkrKykgew0KPiAtCQlzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqYiA9IHEtPnRp
bnMgKyBpOw0KPiArCQlzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqYiA9IHFkLT50aW5zICsgaTsNCj4g
IA0KPiAgCQlJTklUX0xJU1RfSEVBRCgmYi0+bmV3X2Zsb3dzKTsNCj4gIAkJSU5JVF9MSVNUX0hF
QUQoJmItPm9sZF9mbG93cyk7DQo+IEBAIC0yNzg0LDIyICsyODAwLDI3IEBAIHN0YXRpYyBpbnQg
Y2FrZV9pbml0KHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQo+ICAJCQlJ
TklUX0xJU1RfSEVBRCgmZmxvdy0+Zmxvd2NoYWluKTsNCj4gIAkJCWNvYmFsdF92YXJzX2luaXQo
JmZsb3ctPmN2YXJzKTsNCj4gIA0KPiAtCQkJcS0+b3ZlcmZsb3dfaGVhcFtrXS50ID0gaTsNCj4g
LQkJCXEtPm92ZXJmbG93X2hlYXBba10uYiA9IGo7DQo+ICsJCQlxZC0+b3ZlcmZsb3dfaGVhcFtr
XS50ID0gaTsNCj4gKwkJCXFkLT5vdmVyZmxvd19oZWFwW2tdLmIgPSBqOw0KPiAgCQkJYi0+b3Zl
cmZsb3dfaWR4W2pdID0gazsNCj4gIAkJfQ0KPiAgCX0NCj4gIA0KPiAgCWNha2VfcmVjb25maWd1
cmUoc2NoKTsNCj4gLQlxLT5hdmdfcGVha19iYW5kd2lkdGggPSBxLT5yYXRlX2JwczsNCj4gLQlx
LT5taW5fbmV0bGVuID0gfjA7DQo+IC0JcS0+bWluX2FkamxlbiA9IH4wOw0KPiArCXFkLT5hdmdf
cGVha19iYW5kd2lkdGggPSBxLT5yYXRlX2JwczsNCj4gKwlxZC0+bWluX25ldGxlbiA9IH4wOw0K
PiArCXFkLT5taW5fYWRqbGVuID0gfjA7DQo+ICAJcmV0dXJuIDA7DQo+ICtlcnI6DQo+ICsJa3Zm
cmVlKHFkLT5jb25maWcpOw0KPiArCXFkLT5jb25maWcgPSBOVUxMOw0KPiArCXJldHVybiBlcnI7
DQo+ICB9DQo+ICANCj4gIHN0YXRpYyBpbnQgY2FrZV9kdW1wKHN0cnVjdCBRZGlzYyAqc2NoLCBz
dHJ1Y3Qgc2tfYnVmZiAqc2tiKQ0KPiAgew0KPiAtCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnEg
PSBxZGlzY19wcml2KHNjaCk7DQo+ICsJc3RydWN0IGNha2Vfc2NoZWRfZGF0YSAqcWQgPSBxZGlz
Y19wcml2KHNjaCk7DQo+ICsJc3RydWN0IGNha2Vfc2NoZWRfY29uZmlnICpxID0gcWQtPmNvbmZp
ZzsNCj4gIAlzdHJ1Y3QgbmxhdHRyICpvcHRzOw0KPiAgCXUxNiByYXRlX2ZsYWdzOw0KPiAgCXU4
IGZsb3dfbW9kZTsNCj4gDQo+IC0tIA0KPiAyLjUyLjANCj4gDQoNCg0KX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KQ2FrZSBtYWlsaW5nIGxpc3QgLS0gY2Fr
ZUBsaXN0cy5idWZmZXJibG9hdC5uZXQKVG8gdW5zdWJzY3JpYmUgc2VuZCBhbiBlbWFpbCB0byBj
YWtlLWxlYXZlQGxpc3RzLmJ1ZmZlcmJsb2F0Lm5ldAo=

Return-Path: <cake-bounces@lists.bufferbloat.net>
X-Original-To: lists+cake@lfdr.de
Delivered-To: lists+cake@lfdr.de
Received: from lists.bufferbloat.net (lists.bufferbloat.net [IPv6:2600:3c03:e000:3ca:f00f:f00f:b33b:b33b])
	by mail.lfdr.de (Postfix) with ESMTPS id C5CB5A0760B
	for <lists+cake@lfdr.de>; Thu,  9 Jan 2025 13:47:22 +0100 (CET)
Received: from pitt.bufferbloat.net (localhost [127.0.0.1])
	by lists.bufferbloat.net (Postfix) with ESMTP id 6E8613CB39;
	Thu,  9 Jan 2025 07:47:21 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
	d=lists.bufferbloat.net; s=201610; t=1736426841;
	bh=+XBe8GsY9ydKwJEe2PDZjLMlLXOuJcheP6I7dFeNEjE=;
	h=To:In-Reply-To:References:Date:Subject:List-Id:List-Unsubscribe:
	 List-Archive:List-Post:List-Help:List-Subscribe:From:Reply-To:Cc:
	 From;
	b=h1jL9U2EkOKlUnxYvCz5lIElcwXc28LRaWU5ydnWt2xGL2uhzpjC9JFWu/fU8ru3U
	 3eRc4YVW+7XEe4k5+2cbfuAFEAePMetA5wO5guwyvzycoSVJssfjQ204KzYNV7RphK
	 yXjZbmrJsfQHjrPLBWAa78xyB9hAM9tp+dO6mOcpHWIb6ESzsmh3SJ+4uYKlsa8ZTe
	 JQiuVB8TKlus24cCyLNpmF21VMv7vuLlAKFTTOlO2SBIKlQWuO48wj7WZ+l8qrAGsr
	 UHiEdgXghKTcF3r3q+aOpF7K3hJLnocihuVdlXsrCr9KnnKwZePVijEmlqgch+YfcJ
	 MpRjDzWbv/a/g==
X-Original-To: cake@lists.bufferbloat.net
Delivered-To: cake@lists.bufferbloat.net
Received: from mail.toke.dk (mail.toke.dk [45.145.95.4])
 (using TLSv1.2 with cipher ADH-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by lists.bufferbloat.net (Postfix) with ESMTPS id E106A3B2A4
 for <cake@lists.bufferbloat.net>; Thu,  9 Jan 2025 07:47:19 -0500 (EST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=toke.dk; s=20161023;
 t=1736426838; bh=SQuxm+ItjKfTHqDCnhmWPP3mexlv7P5RG77HW1/uIAQ=;
 h=From:To:Cc:Subject:In-Reply-To:References:Date:From;
 b=YQNBVHHRUFbGfQ7S1lj/AaI1UHht3Yop0leBB6u0I4shd8583P21MwnUnaK/RcQVn
 im1b8k+iLaZ4a6wI+S448xPTyPkgaP4Wq5hns8uqvpV6pVvhGasQhEQC7UczKJt0PA
 qdl7aPqmFc1Kk/yXQQqUBIx16LMd2KG0KII6zTkFSsFgiqjDY8t2jVh1N4FSGLjwuG
 6VHJ+OPmnfpZSJEp9+tQce1fjl52TRhoOctIXaL54+PRngLCWaYuWEq1Jt7+KcNnf0
 lMTX08vw8hH3DdFtY4OU4yUuw5vT0lVTQOPzkJCDKo5Q1iLMU/sc6MwVnnLIbVxxE4
 sCT+HzLk+MFpQ==
To: Paolo Abeni <pabeni@redhat.com>, Jamal Hadi Salim <jhs@mojatatu.com>,
 Cong Wang <xiyou.wangcong@gmail.com>, Jiri Pirko <jiri@resnulli.us>
In-Reply-To: <fb7a1324-41c6-4e10-a6a3-f16d96f44f65@redhat.com>
References: <20250107120105.70685-1-toke@redhat.com>
 <fb7a1324-41c6-4e10-a6a3-f16d96f44f65@redhat.com>
Date: Thu, 09 Jan 2025 13:47:17 +0100
X-Clacks-Overhead: GNU Terry Pratchett
Message-ID: <87plkwi27e.fsf@toke.dk>
MIME-Version: 1.0
Subject: Re: [Cake] [PATCH net v2] sched: sch_cake: add bounds checks to
 host bulk flow fairness counts
X-BeenThere: cake@lists.bufferbloat.net
X-Mailman-Version: 2.1.20
Precedence: list
List-Id: Cake - FQ_codel the next generation <cake.lists.bufferbloat.net>
List-Unsubscribe: <https://lists.bufferbloat.net/options/cake>,
 <mailto:cake-request@lists.bufferbloat.net?subject=unsubscribe>
List-Archive: <https://lists.bufferbloat.net/pipermail/cake>
List-Post: <mailto:cake@lists.bufferbloat.net>
List-Help: <mailto:cake-request@lists.bufferbloat.net?subject=help>
List-Subscribe: <https://lists.bufferbloat.net/listinfo/cake>,
 <mailto:cake-request@lists.bufferbloat.net?subject=subscribe>
From: Toke =?utf-8?Q?H=C3=B8iland-J=C3=B8rgensen?= via Cake
 <cake@lists.bufferbloat.net>
Reply-To: Toke =?utf-8?Q?H=C3=B8iland-J=C3=B8rgensen?= <toke@toke.dk>
Cc: netdev@vger.kernel.org, cake@lists.bufferbloat.net,
 Eric Dumazet <edumazet@google.com>, Simon Horman <horms@kernel.org>,
 Jakub Kicinski <kuba@kernel.org>,
 syzbot+f63600d288bfb7057424@syzkaller.appspotmail.com,
 "David S. Miller" <davem@davemloft.net>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: cake-bounces@lists.bufferbloat.net
Sender: "Cake" <cake-bounces@lists.bufferbloat.net>

UGFvbG8gQWJlbmkgPHBhYmVuaUByZWRoYXQuY29tPiB3cml0ZXM6Cgo+IE9uIDEvNy8yNSAxOjAx
IFBNLCBUb2tlIEjDuGlsYW5kLUrDuHJnZW5zZW4gd3JvdGU6Cj4+IEV2ZW4gdGhvdWdoIHdlIGZp
eGVkIGEgbG9naWMgZXJyb3IgaW4gdGhlIGNvbW1pdCBjaXRlZCBiZWxvdywgc3l6Ym90Cj4+IHN0
aWxsIG1hbmFnZWQgdG8gdHJpZ2dlciBhbiB1bmRlcmZsb3cgb2YgdGhlIHBlci1ob3N0IGJ1bGsg
Zmxvdwo+PiBjb3VudGVycywgbGVhZGluZyB0byBhbiBvdXQgb2YgYm91bmRzIG1lbW9yeSBhY2Nl
c3MuCj4+IAo+PiBUbyBhdm9pZCBhbnkgc3VjaCBsb2dpYyBlcnJvcnMgY2F1c2luZyBvdXQgb2Yg
Ym91bmRzIG1lbW9yeSBhY2Nlc3NlcywKPj4gdGhpcyBjb21taXQgZmFjdG9ycyBvdXQgYWxsIGFj
Y2Vzc2VzIHRvIHRoZSBwZXItaG9zdCBidWxrIGZsb3cgY291bnRlcnMKPj4gdG8gYSBzZXJpZXMg
b2YgaGVscGVycyB0aGF0IHBlcmZvcm0gYm91bmRzLWNoZWNraW5nIGJlZm9yZSBhbnkKPj4gaW5j
cmVtZW50cyBhbmQgZGVjcmVtZW50cy4gVGhpcyBhbHNvIGhhcyB0aGUgYmVuZWZpdCBvZiBpbXBy
b3ZpbmcKPj4gcmVhZGFiaWxpdHkgYnkgbW92aW5nIHRoZSBjb25kaXRpb25hbCBjaGVja3MgZm9y
IHRoZSBmbG93IG1vZGUgaW50bwo+PiB0aGVzZSBoZWxwZXJzLCBpbnN0ZWFkIG9mIGhhdmluZyB0
aGVtIHNwcmVhZCBvdXQgdGhyb3VnaG91dCB0aGUKPj4gY29kZSAod2hpY2ggd2FzIHRoZSBjYXVz
ZSBvZiB0aGUgb3JpZ2luYWwgbG9naWMgZXJyb3IpLgo+PiAKPj4gdjI6Cj4+IC0gUmVtb3ZlIG5v
dy11bnVzZWQgc3JjaG9zdCBhbmQgZHN0aG9zdCBsb2NhbCB2YXJpYWJsZXMgaW4gY2FrZV9kZXF1
ZXVlKCkKPgo+IFNtYWxsIG5pdDogdGhlIGNoYW5nZWxvZyBzaG91bGQgY29tZSBhZnRlciB0aGUg
Jy0tLScgc2VwYXJhdG9yLiBObyBuZWVkCj4gdG8gcmVwb3N0IGp1c3QgZm9yIHRoaXMuCgpPaCwg
SSB3YXMgdW5kZXIgdGhlIGltcHJlc3Npb24gdGhhdCB3ZSB3YW50ZWQgdGhlbSBwcmVzZXJ2ZWQg
aW4gdGhlIGdpdApsb2cgKGFuZCBoZW5jZSBhYm92ZSB0aGUgLS0tKS4gSXMgdGhhdCBub3QgdGhl
IGNhc2UgKGFueW1vcmU/KT8KCj4+IEZpeGVzOiA1NDZlYTg0ZDA3ZTMgKCJzY2hlZDogc2NoX2Nh
a2U6IGZpeCBidWxrIGZsb3cgYWNjb3VudGluZyBsb2dpYyBmb3IgaG9zdCBmYWlybmVzcyIpCj4+
IFJlcG9ydGVkLWJ5OiBzeXpib3QrZjYzNjAwZDI4OGJmYjcwNTc0MjRAc3l6a2FsbGVyLmFwcHNw
b3RtYWlsLmNvbQo+PiBTaWduZWQtb2ZmLWJ5OiBUb2tlIEjDuGlsYW5kLUrDuHJnZW5zZW4gPHRv
a2VAcmVkaGF0LmNvbT4KPj4gLS0tCj4+ICBuZXQvc2NoZWQvc2NoX2Nha2UuYyB8IDE0MCArKysr
KysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tCj4+ICAxIGZpbGUgY2hhbmdl
ZCwgNzUgaW5zZXJ0aW9ucygrKSwgNjUgZGVsZXRpb25zKC0pCj4+IAo+PiBkaWZmIC0tZ2l0IGEv
bmV0L3NjaGVkL3NjaF9jYWtlLmMgYi9uZXQvc2NoZWQvc2NoX2Nha2UuYwo+PiBpbmRleCA4ZDhi
MmRiNDY1M2MuLjJjMmUyYTY3ZjNiMiAxMDA2NDQKPj4gLS0tIGEvbmV0L3NjaGVkL3NjaF9jYWtl
LmMKPj4gKysrIGIvbmV0L3NjaGVkL3NjaF9jYWtlLmMKPj4gQEAgLTYyNyw2ICs2MjcsNjMgQEAg
c3RhdGljIGJvb2wgY2FrZV9kZHN0KGludCBmbG93X21vZGUpCj4+ICAJcmV0dXJuIChmbG93X21v
ZGUgJiBDQUtFX0ZMT1dfRFVBTF9EU1QpID09IENBS0VfRkxPV19EVUFMX0RTVDsKPj4gIH0KPj4g
IAo+PiArc3RhdGljIHZvaWQgY2FrZV9kZWNfc3JjaG9zdF9idWxrX2Zsb3dfY291bnQoc3RydWN0
IGNha2VfdGluX2RhdGEgKnEsCj4+ICsJCQkJCSAgICAgc3RydWN0IGNha2VfZmxvdyAqZmxvdywK
Pj4gKwkJCQkJICAgICBpbnQgZmxvd19tb2RlKQo+PiArewo+PiArCWlmIChsaWtlbHkoY2FrZV9k
c3JjKGZsb3dfbW9kZSkgJiYKPj4gKwkJICAgcS0+aG9zdHNbZmxvdy0+c3JjaG9zdF0uc3JjaG9z
dF9idWxrX2Zsb3dfY291bnQpKQo+PiArCQlxLT5ob3N0c1tmbG93LT5zcmNob3N0XS5zcmNob3N0
X2J1bGtfZmxvd19jb3VudC0tOwo+PiArfQo+PiArCj4+ICtzdGF0aWMgdm9pZCBjYWtlX2luY19z
cmNob3N0X2J1bGtfZmxvd19jb3VudChzdHJ1Y3QgY2FrZV90aW5fZGF0YSAqcSwKPj4gKwkJCQkJ
ICAgICBzdHJ1Y3QgY2FrZV9mbG93ICpmbG93LAo+PiArCQkJCQkgICAgIGludCBmbG93X21vZGUp
Cj4+ICt7Cj4+ICsJaWYgKGxpa2VseShjYWtlX2RzcmMoZmxvd19tb2RlKSAmJgo+PiArCQkgICBx
LT5ob3N0c1tmbG93LT5zcmNob3N0XS5zcmNob3N0X2J1bGtfZmxvd19jb3VudCA8IENBS0VfUVVF
VUVTKSkKPj4gKwkJcS0+aG9zdHNbZmxvdy0+c3JjaG9zdF0uc3JjaG9zdF9idWxrX2Zsb3dfY291
bnQrKzsKPj4gK30KPj4gKwo+PiArc3RhdGljIHZvaWQgY2FrZV9kZWNfZHN0aG9zdF9idWxrX2Zs
b3dfY291bnQoc3RydWN0IGNha2VfdGluX2RhdGEgKnEsCj4+ICsJCQkJCSAgICAgc3RydWN0IGNh
a2VfZmxvdyAqZmxvdywKPj4gKwkJCQkJICAgICBpbnQgZmxvd19tb2RlKQo+PiArewo+PiArCWlm
IChsaWtlbHkoY2FrZV9kZHN0KGZsb3dfbW9kZSkgJiYKPj4gKwkJICAgcS0+aG9zdHNbZmxvdy0+
ZHN0aG9zdF0uZHN0aG9zdF9idWxrX2Zsb3dfY291bnQpKQo+PiArCQlxLT5ob3N0c1tmbG93LT5k
c3Rob3N0XS5kc3Rob3N0X2J1bGtfZmxvd19jb3VudC0tOwo+PiArfQo+PiArCj4+ICtzdGF0aWMg
dm9pZCBjYWtlX2luY19kc3Rob3N0X2J1bGtfZmxvd19jb3VudChzdHJ1Y3QgY2FrZV90aW5fZGF0
YSAqcSwKPj4gKwkJCQkJICAgICBzdHJ1Y3QgY2FrZV9mbG93ICpmbG93LAo+PiArCQkJCQkgICAg
IGludCBmbG93X21vZGUpCj4+ICt7Cj4+ICsJaWYgKGxpa2VseShjYWtlX2Rkc3QoZmxvd19tb2Rl
KSAmJgo+PiArCQkgICBxLT5ob3N0c1tmbG93LT5kc3Rob3N0XS5kc3Rob3N0X2J1bGtfZmxvd19j
b3VudCA8IENBS0VfUVVFVUVTKSkKPj4gKwkJcS0+aG9zdHNbZmxvdy0+ZHN0aG9zdF0uZHN0aG9z
dF9idWxrX2Zsb3dfY291bnQrKzsKPj4gK30KPj4gKwo+PiArc3RhdGljIHUxNiBjYWtlX2dldF9m
bG93X3F1YW50dW0oc3RydWN0IGNha2VfdGluX2RhdGEgKnEsCj4+ICsJCQkJIHN0cnVjdCBjYWtl
X2Zsb3cgKmZsb3csCj4+ICsJCQkJIGludCBmbG93X21vZGUpCj4+ICt7Cj4+ICsJdTE2IGhvc3Rf
bG9hZCA9IDE7Cj4+ICsKPj4gKwlpZiAoY2FrZV9kc3JjKGZsb3dfbW9kZSkpCj4+ICsJCWhvc3Rf
bG9hZCA9IG1heChob3N0X2xvYWQsCj4+ICsJCQkJcS0+aG9zdHNbZmxvdy0+c3JjaG9zdF0uc3Jj
aG9zdF9idWxrX2Zsb3dfY291bnQpOwo+PiArCj4+ICsJaWYgKGNha2VfZGRzdChmbG93X21vZGUp
KQo+PiArCQlob3N0X2xvYWQgPSBtYXgoaG9zdF9sb2FkLAo+PiArCQkJCXEtPmhvc3RzW2Zsb3ct
PmRzdGhvc3RdLmRzdGhvc3RfYnVsa19mbG93X2NvdW50KTsKPj4gKwo+PiArCS8qIFRoZSBnZXRf
cmFuZG9tX3UxNigpIGlzIGEgd2F5IHRvIGFwcGx5IGRpdGhlcmluZyB0byBhdm9pZAo+PiArCSAq
IGFjY3VtdWxhdGluZyByb3VuZG9mZiBlcnJvcnMKPj4gKwkgKi8KPj4gKwlyZXR1cm4gKHEtPmZs
b3dfcXVhbnR1bSAqIHF1YW50dW1fZGl2W2hvc3RfbG9hZF0gKwo+PiArCQlnZXRfcmFuZG9tX3Ux
NigpKSA+PiAxNjsKPgo+IGRpdGhlcmluZyBpcyBub3cgYXBwbGllZCBvbiBib3RoIGVucXVldWUg
YW5kIGRlcXVldWUsIHdoaWxlIHByaW9yIHRvCj4gdGhpcyBwYXRjaCBpdCBvbmx5IGhhcHBlbmVk
IG9uIGRlcXVldWUuIElzIHRoYXQgaW50ZW50aW9uYWw/IGNhbid0IGxlYWQKPiB0byAoc21hbGwp
IGZsb3dfZGVmaWNpdCBpbmNyZWFzZT8KClllYWgsIHRoYXQgd2FzIGRlbGliZXJhdGUuIFRoZSBm
bG93IHF1YW50dW0gaXMgb25seSBzZXQgb24gZW5xdWV1ZSB3aGVuCnRoZSBmbG93IGlzIGZpcnN0
IGluaXRpYWxpc2VkIGFzIGEgc3BhcnNlIGZsb3csIG5vdCBmb3IgZXZlcnkgcGFja2V0LgpUaGUg
b25seSB1c2VyLXZpc2libGUgZWZmZWN0IEkgY2FuIHNlZSB0aGlzIGhhdmluZyBpcyB0aGF0IHRo
ZSBtYXhpbXVtCnBhY2tldCBzaXplIHRoYXQgY2FuIGJlIHNlbnQgd2hpbGUgYSBmbG93IHN0YXlz
IHNwYXJzZSB3aWxsIG5vdyB2YXJ5CndpdGggKy8tIG9uZSBieXRlIGluIHNvbWUgY2FzZXMuIEkg
YW0gcHJldHR5IHN1cmUgdGhpcyB3b24ndCBoYXZlIGFueQpjb25zZXF1ZW5jZSBpbiBwcmFjdGlj
ZSwgYW5kIEkgZG9uJ3QgdGhpbmsgaXQncyB3b3J0aCBjb21wbGljYXRpbmcgdGhlCmNvZGUgKHdp
dGggYSAnZGl0aGVyJyBhcmd1bWVudCB0byBjYWtlX2Zsb3dfZ2V0X3F1YW50dW0oKSwgc2F5KSB0
bwpwcmVzZXJ2ZSB0aGUgb2xkIGJlaGF2aW91ci4KCkkgZ3Vlc3MgSSBzaG91bGQgaGF2ZSBtZW50
aW9uZWQgaW4gdGhlIGNvbW1pdCBtZXNzYWdlIHRoYXQgdGhpcyB3YXMKZGVsaWJlcmF0ZS4gU2lu
Y2UgaXQgc2VlbXMgeW91J2xsIGJlIGVkaXRpbmcgdGhhdCBhbnl3YXkgKGNmIHRoZSBhYm92ZSks
CmhvdyBhYm91dCBhZGRpbmcgYSBwYXJhZ3JhcGggbGlrZToKCiBBcyBwYXJ0IG9mIHRoaXMgY2hh
bmdlLCB0aGUgZmxvdyBxdWFudHVtIGNhbGN1bGF0aW9uIGlzIGNvbnNvbGlkYXRlZAogaW50byBh
IGhlbHBlciBmdW5jdGlvbiwgd2hpY2ggbWVhbnMgdGhhdCB0aGUgZGl0aGVyaW5nIGFwcGxpZWQg
dG8gdGhlCiBob3N0IGxvYWQgc2NhbGluZyBpcyBub3cgYXBwbGllZCBib3RoIGluIHRoZSBEUlIg
cm90YXRpb24gYW5kIHdoZW4gYQogc3BhcnNlIGZsb3cncyBxdWFudHVtIGlzIGZpcnN0IGluaXRp
YXRlZC4gVGhlIG9ubHkgdXNlci12aXNpYmxlIGVmZmVjdAogb2YgdGhpcyBpcyB0aGF0IHRoZSBt
YXhpbXVtIHBhY2tldCBzaXplIHRoYXQgY2FuIGJlIHNlbnQgd2hpbGUgYSBmbG93CiBzdGF5cyBz
cGFyc2Ugd2lsbCBub3cgdmFyeSB3aXRoICsvLSBvbmUgYnl0ZSBpbiBzb21lIGNhc2VzLiBUaGlz
IHNob3VsZAogbm90IG1ha2UgYSBub3RpY2VhYmxlIGRpZmZlcmVuY2UgaW4gcHJhY3RpY2UsIGFu
ZCB0aHVzIGl0J3Mgbm90IHdvcnRoCiBjb21wbGljYXRpbmcgdGhlIGNvZGUgdG8gcHJlc2VydmUg
dGhlIG9sZCBiZWhhdmlvdXIuCgotVG9rZQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpDYWtlIG1haWxpbmcgbGlzdApDYWtlQGxpc3RzLmJ1ZmZlcmJsb2F0
Lm5ldApodHRwczovL2xpc3RzLmJ1ZmZlcmJsb2F0Lm5ldC9saXN0aW5mby9jYWtlCg==

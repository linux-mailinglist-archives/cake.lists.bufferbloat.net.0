Return-Path: <cake-bounces@lists.bufferbloat.net>
X-Original-To: lists+cake@lfdr.de
Delivered-To: lists+cake@lfdr.de
Received: from lists.bufferbloat.net (lists.bufferbloat.net [IPv6:2600:3c03:e000:3ca:f00f:f00f:b33b:b33b])
	by mail.lfdr.de (Postfix) with ESMTPS id 4A4F23C4001
	for <lists+cake@lfdr.de>; Mon, 12 Jul 2021 01:33:56 +0200 (CEST)
Received: from pitt.bufferbloat.net (localhost [127.0.0.1])
	by lists.bufferbloat.net (Postfix) with ESMTP id 547DC3CB39;
	Sun, 11 Jul 2021 19:33:54 -0400 (EDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
	d=lists.bufferbloat.net; s=201610; t=1626046434;
	bh=ObQUVg1zJoVItRuMiy409g1u6CqcNYRMBgfiTAhI+4c=;
	h=References:In-Reply-To:From:Date:To:Subject:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 Cc:From;
	b=R2ijAc4ac3AHKNO3jwFv1I+aIQc1aAehiN/21DelR2Jq6RgpmOqvsw8kz8f+LRQAo
	 JRAImFIlaFcKON+5ytLArFXSvySfQqBTsKRu217nbxb8D9x6sx+eYZecajvqlFMIio
	 r+BFZ1/uLxywn+FxjOFpxIfZZJQgNdvXqcudRThP7A/mKiS9heRjcTqtrllO+IUwEj
	 Om4GE7WRbksdxP+ZX1V5UsUSyTNT8G8GaD1AI99k/YU+QeZhq1Oe0Ke+R3i9YBTKBJ
	 1fmSkoz6SJeMGb7KGTTuAh2v19pk3U70wkzuFv3vmrk5Jucy5ovmfJSoMExiz1X5JI
	 /nx6v/sEcPRjw==
X-Original-To: cake@lists.bufferbloat.net
Delivered-To: cake@lists.bufferbloat.net
Received: from mail-lj1-x22e.google.com (mail-lj1-x22e.google.com
 [IPv6:2a00:1450:4864:20::22e])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by lists.bufferbloat.net (Postfix) with ESMTPS id BDD093B29D
 for <cake@lists.bufferbloat.net>; Sun, 11 Jul 2021 19:33:52 -0400 (EDT)
Received: by mail-lj1-x22e.google.com with SMTP id 141so4099041ljj.2
 for <cake@lists.bufferbloat.net>; Sun, 11 Jul 2021 16:33:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=jackrabbitwireless.com; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=Lu9M/MsD05iS0M0qSzD+5CvkLDMoh001cdPu3OrEsHY=;
 b=11G4bAHLnvUmnY8F8W2B3iuvZu7SX28mRFbAiV8uMlpTjrkMbdmW4nzrpbkLZZiA8L
 HNLtrau05hPZZfiRVI6hei38R9umolwtpwCgJYTBQMKNqqjgmHYjHY+ZFD/nM9jsAbFM
 zh9aXHT5Dm+BPEzQodjjgsdMY1SRAGgRDnDKA=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=Lu9M/MsD05iS0M0qSzD+5CvkLDMoh001cdPu3OrEsHY=;
 b=pAQL+i1QL6wrPfpQmK1ei+GxSgmvo7og2DFzaApoK8ygYAWmQh+o2JJx4Gd3w+7EqJ
 Dun4reKXyvC1NAn/d4yFepku98Ey/IhF3dX4KdhxeBAfYfLfd/W+mI3bz8fpv9ICi4UA
 lCKvkPVwOTHxkJmKs1DG2xCxktHIsfKm7DKgpjR0RXFAaVx4FilepeJb1oBOyDSE1tD9
 4zar2XlCEz6sSsXGe40xkVIsouk7lBVi0Jxos3mCcBCDjSldZVil+rZ/i3OQyveYJlg3
 HGEW5E8sCvLoJd+4ml5yW50+JdzHFQOxkAo8CqKqz1pWJmo4DCxIPjuU2Vsd5FBfHrI6
 prZw==
X-Gm-Message-State: AOAM5302hEYURJRJBGGy+DsDCDdeQH1cVm3KuS6rQw/uKb26toiUTSGD
 wJvshlLUXVoC1v+k++xk7lI6zpyUMV/0LaA51vX2lQ==
X-Google-Smtp-Source: ABdhPJwX9z9vpQwXSllTpV+ZXUFHJM9UQSLQodlIgzX+TP2b4ckJdaQRXQUmAS11AGd7qlglthR6LV/IlVoXmwXPvF0=
X-Received: by 2002:a2e:97d1:: with SMTP id m17mr26207687ljj.168.1626046431163; 
 Sun, 11 Jul 2021 16:33:51 -0700 (PDT)
MIME-Version: 1.0
References: <1625910047-56840-1-git-send-email-shenjian15@huawei.com>
 <CAA93jw4oWpoWkRk+YrzLfWX+0PpMHMJmALup6BLBczwLrjn-hA@mail.gmail.com>
 <CAOZyJouL=pM+GTTQ3AfEiwE6j5Jt3DFLMJYjasnJLBUszTd=tA@mail.gmail.com>
 <CAA93jw7MBjijx0MiWPkmRttEELWsNjCdcHwkjPduto6+F4G24w@mail.gmail.com>
In-Reply-To: <CAA93jw7MBjijx0MiWPkmRttEELWsNjCdcHwkjPduto6+F4G24w@mail.gmail.com>
From: =?UTF-8?Q?Robert_Chac=C3=B3n?= <robert.chacon@jackrabbitwireless.com>
Date: Sun, 11 Jul 2021 17:33:38 -0600
Message-ID: <CAOZyJovbu6LsZOHTe8KWa_W3hOZ1ECiq=VA45d5hbZK96NJ3Sg@mail.gmail.com>
To: Dave Taht <dave.taht@gmail.com>
Subject: Re: [Cake] Fwd: [RFC net-next] net: extend netdev features
X-BeenThere: cake@lists.bufferbloat.net
X-Mailman-Version: 2.1.20
Precedence: list
List-Id: Cake - FQ_codel the next generation <cake.lists.bufferbloat.net>
List-Unsubscribe: <https://lists.bufferbloat.net/options/cake>,
 <mailto:cake-request@lists.bufferbloat.net?subject=unsubscribe>
List-Archive: <https://lists.bufferbloat.net/pipermail/cake>
List-Post: <mailto:cake@lists.bufferbloat.net>
List-Help: <mailto:cake-request@lists.bufferbloat.net?subject=help>
List-Subscribe: <https://lists.bufferbloat.net/listinfo/cake>,
 <mailto:cake-request@lists.bufferbloat.net?subject=subscribe>
Cc: Cake List <cake@lists.bufferbloat.net>,
 cerowrt-devel <cerowrt-devel@lists.bufferbloat.net>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: cake-bounces@lists.bufferbloat.net
Sender: "Cake" <cake-bounces@lists.bufferbloat.net>

SGV5IERhdmUsCgpJIGFtIGNvbXBsZXRlbHkgb3BlbiB0byB1c2luZyBjYWtlJ3MgaW50ZWdyYWwg
c2hhcGVyLCBidXQgZnJvbSB3aGF0IEkKdW5kZXJzdGFuZCwgaXQgaXMgbm90IHBvc3NpYmxlIHRv
IGNyZWF0ZSBjaGlsZCBsZWFmIGNsYXNzZXMgb2YgY2FrZQpxZGlzY3MgYmVjYXVzZSBjYWtlIGlz
IGNsYXNzbGVzcywgcmlnaHQ/CgpGb3Igbm93IEkgdHJpZWQgaHRiICsgY2FrZSBkaWZmc2VydjQg
YWNrLWZpbHRlciBhbmQgaXQgc2VlbWVkIHRvIGNhdXNlCmFuIGluY3JlYXNlIGluIENQVSB1c2Fn
ZSAoMzAlKSB3aXRoIDhtcyBoaWdoZXIgbGF0ZW5jeS4KSG93ZXZlciB3aGVuIEkgdHJpZWQgImNh
a2UgZGlmZnNlcnY0IG5vLWFjay1maWx0ZXIiIGl0IHdvcmtlZCB2ZXJ5CndlbGwuIENQVSB1c2Ug
d2FzIG9ubHkgMyUgaGlnaGVyIHRoYW4gZnFfY29kZWwuCkkgd2lsbCB0ZXN0ICJjYWtlIGRpZmZz
ZXJ2NCBuby1hY2stZmlsdGVyIiBvbiBteSBwcm9kdWN0aW9uIG5ldHdvcmsgdG8Kc2VlIGhvdyBp
dCBkb2VzIHdpdGggbGl2ZSB2aWRlbyBvdmVyIGZpeGVkIHdpcmVsZXNzLiBJZiBpdCB3b3JrcyB3
ZWxsCkkgd2lsbCBtYWtlIGl0IHRoZSBuZXcgZGVmYXVsdCBmb3IgTGlicmVRb1MuClRoYW5rIHlv
dSBmb3IgdGhlIHJlY29tbWVuZGF0aW9uLCBJIGFwcHJlY2lhdGUgaXQhCgpPbiBTYXQsIEp1bCAx
MCwgMjAyMSBhdCAxOjQzIFBNIERhdmUgVGFodCA8ZGF2ZS50YWh0QGdtYWlsLmNvbT4gd3JvdGU6
Cj4KPiBjYW4gSSBlbmNvdXJhZ2UgeW91IHRvIHRyeSBjYWtlIHdpdGggaXQncyBpbnRlZ3JhbCBz
aGFwZXIgaW5zdGVhZCBvZiBodGI/Cj4KPiBvciBodGIgKyBjYWtlIGRpZmZzZXJ2NCBhY2stZmls
dGVyPyAoSSd2ZSBzZXR0bGVkIG9uIHRoYXQgdG8gb3B0aW1pemUKPiBldmVuIGJldHRlciBmb3Ig
bWFya2VkIHZpZGVvY29uZmVyZW5jaW5nIHRyYWZmaWMuCj4gZmFjZXRpbWUsIGluIHBhcnRpY3Vs
YXIsIGRvZXMgbm90IGhhbmRsZSBsb3NzIHdlbGwpCj4KPgo+IE9uIFNhdCwgSnVsIDEwLCAyMDIx
IGF0IDEwOjAwIEFNIFJvYmVydCBDaGFjw7NuCj4gPHJvYmVydC5jaGFjb25AamFja3JhYmJpdHdp
cmVsZXNzLmNvbT4gd3JvdGU6Cj4gPgo+ID4gSSBoYXZlIGEgcXVlc3Rpb24gcmVnYXJkaW5nIHRo
aXMsIGFuZCB0aGUgY3VycmVudCBtYXhpbXVtIG51bWJlciBvZiBodGIgbGVhZiBjbGFzc2VzIGFu
ZC9vciBxZGlzY3MgcGVyIGludGVyZmFjZS4KPiA+IEkgcmVjZW50bHkgaW50ZWdyYXRlZCBKZXNw
ZXIncyB4ZHAtY3B1bWFwLXRjIGNvZGUgaW50byBMaWJyZVFvUywgd2hpY2ggaW5jcmVhc2VkIHRo
cm91Z2hwdXQgdG8gMTBHYnBzIG9uIHRlc3RzLgo+ID4gSSBzdXNwZWN0IHNvbWV3aGVyZSBiZXR3
ZWVuIDEwR2JwcyBhbmQgNDBHYnBzIHRocm91Z2hwdXQgaXMgbm93IHBvc3NpYmxlIGlmIHlvdSB0
aHJvdyBlbm91Z2ggY29yZXMgYXQgaXQuIEFza2luZyBvdXIgbG9jYWwgdW5pdmVyc2l0eSB0byBo
ZWxwIHVzIHRlc3QgdGhpcy4KPiA+IFhkcC1jcHVtYXAtdGMgdXNlcyB4ZHAncyBjcHVtYXAtcmVk
aXJlY3QgZmVhdHVyZSB0byBmaWx0ZXIgcGFja2V0cyBpbnRvIHRoZSBhcHByb3ByaWF0ZSBDUFUg
LyBxdWV1ZSB1c2luZyBlQlBGIGhhc2ggbWFwcywgcmF0aGVyIHRoYW4gbGludXggdGMgZmlsdGVy
cyAvIHUzMi4KPiA+Cj4gPiBRdWVzdGlvbikgU2luY2UgTGlicmVRb1Mgd291bGQgbm90IGRlcGVu
ZCBvbiB0YyBmaWx0ZXJzLCB3b3VsZCB0aGUgY3VycmVudCAzMi1iaXQgb3IgNjQtYml0IGZlYXR1
cmUgbGltaXQgaW1wb3NlIGEgcHJhY3RpY2FsIGNsaWVudCBsaW1pdCBvbiBMaWJyZVFvUz8KPiA+
IFRoZSBhdmVyYWdlIHVzZXIncyB0aHJvdWdocHV0IGlzIGFyb3VuZCAzLjVNYnBzIGF0IHBlYWsg
aG91cnMsIHNvIEknbSB0aGlua2luZyB+NTgwMCBxZGlzY3MgYW5kIH41ODAwIGh0YiBsZWFmIGNs
YXNzZXMgd291bGQgYmUgcmVxdWlyZWQgZm9yIGVhY2ggaW50ZXJmYWNlIGF0IDIwR2JwcyB0aHJv
dWdocHV0IGZvciBleGFtcGxlLgo+ID4gVGhlcmUgbWF5IGJlIHNvbWUgbW9yZSBpbW1lZGlhdGUg
bGltaXRhdGlvbnMgSSdtIG5vdCB1bmRlcnN0YW5kaW5nLiBKdXN0IGN1cmlvdXMgYWJvdXQgdGhl
IHByYWN0aWNhbCBsaW1pdGF0aW9ucyB0aGVyZS4KPiA+Cj4gPiBUaGFua3MhCj4gPiBSb2JlcnQK
PiA+Cj4gPiBPbiBTYXQsIEp1bCAxMCwgMjAyMSBhdCA5OjMzIEFNIERhdmUgVGFodCA8ZGF2ZS50
YWh0QGdtYWlsLmNvbT4gd3JvdGU6Cj4gPiA+Cj4gPiA+IE9uZSB0aGluZyBzb21ld2hhdCByZWxh
dGVkIHRvIHRoaXMgd2FzIGZpbmFsbHkgZXhwYW5kaW5nIHRoZSBzcGFjZQo+ID4gPiBhdmFpbGFi
bGUgZm9yIHRoZSB0YyBhbmQgaXB0YWJsZXMgZnVuY3Rpb25hbGl0eSBmb3IKPiA+ID4gdGhpbmdz
IGxpa2UgaGFzaGluZyBhbmQgYWN0aW9ucyBldGMgZnJvbSAxNiBiaXRzIHRvIDMyLiBUaGF0IGlz
Cj4gPiA+IHNvbWV0aGluZyBvZiBhIGZvcmsgbGlmdCB1cGdyYWRlLCBidXQuLi4gNjRrIHF1ZXVl
cyBpcyBub3QKPiA+ID4gZW5vdWdoIGluIHNvbWUgY2FzZXMsIG5vciBpcyA2NGsgcG9zc2libGUg
dXNlcnMgaW4gbGlicmVxb3MuIHRob3VnaHRzCj4gPiA+Cj4gPiA+IC0tLS0tLS0tLS0gRm9yd2Fy
ZGVkIG1lc3NhZ2UgLS0tLS0tLS0tCj4gPiA+IEZyb206IEppYW4gU2hlbiA8c2hlbmppYW4xNUBo
dWF3ZWkuY29tPgo+ID4gPiBEYXRlOiBTYXQsIEp1bCAxMCwgMjAyMSBhdCAyOjQ3IEFNCj4gPiA+
IFN1YmplY3Q6IFtSRkMgbmV0LW5leHRdIG5ldDogZXh0ZW5kIG5ldGRldiBmZWF0dXJlcwo+ID4g
PiBUbzogPGRhdmVtQGRhdmVtbG9mdC5uZXQ+LCA8a3ViYUBrZXJuZWwub3JnPgo+ID4gPiBDYzog
PG5ldGRldkB2Z2VyLmtlcm5lbC5vcmc+LCA8bGludXhhcm1Ab3BlbmV1bGVyLm9yZz4KPiA+ID4K
PiA+ID4KPiA+ID4gRm9yIHRoZSBwcm90b3R5cGUgb2YgbmV0ZGV2X2ZlYXR1cmVzX3QgaXMgdTY0
LCBhbmQgdGhlIG51bWJlcgo+ID4gPiBvZiBuZXRkZXZpY2UgZmVhdHVyZSBiaXRzIGlzIDY0IG5v
dy4gU28gdGhlcmUgaXMgbm8gc3BhY2UgdG8KPiA+ID4gaW50cm9kdWNlIG5ldyBmZWF0dXJlIGJp
dC4KPiA+ID4KPiA+ID4gSSBkaWQgYSBzbWFsbCBjaGFuZ2UgZm9yIHRoaXMuIEtlZXAgdGhlIHBy
b3RvdHlwZSBvZgo+ID4gPiBuZXRkZXZfZmVhdHVyZV90LCBhbmQgZXh0ZW5kIHRoZSBmZWF0dXJl
IG1lbWJlcnMgaW4gc3RydWN0Cj4gPiA+IG5ldF9kZXZpY2UgdG8gYW4gYXJyYXkgb2YgbmV0ZGV2
X2ZlYXR1cmVzX3QuIFNvIG1vcmUgZmVhdHVyZXMKPiA+ID4gYml0cyBjYW4gYmUgdXNlZC4KPiA+
ID4KPiA+ID4gQXMgdGhpcyBjaGFuZ2UsIHNvbWUgZnVuY3Rpb25zIHdoaWNoIHVzZSBuZXRkZXZf
ZmVhdHVyZXNfdCBhcwo+ID4gPiBwYXJhbWV0ZXIgb3IgcmV0dXJlbiB2YWx1ZSB3aWxsIGJlIGFm
ZmVjdGVkLgo+ID4gPiBJIGRpZCBiZWxvdyBjaGFuZ2VzOgo+ID4gPiBhLiBwYXJhbWV0ZXI6ICJu
ZXRkZXZfZmVhdHVyZXNfdCIgdG8gIm5ldGRldl9mZWF0dXJlc190ICoiCj4gPiA+IGIuIHJldHVy
biB2YWx1ZTogIm5ldGRldl9mZWF0dXJlX3QiIHRvICJ2b2lkIiwgYW5kIGFkZAo+ID4gPiAibmV0
ZGV2X2ZlYXR1cmVfdCAqIiBhcyBvdXRwdXQgcGFyYW1ldGVyLgo+ID4gPgo+ID4gPiBJIGtlcHQg
c29tZSBmdW5jdGlvbnMgbm8gY2hhbmdlLCB3aGljaCBhcmUgc3VyZWx5IHVzZWluZyB0aGUKPiA+
ID4gZmlyc3QgNjQgYml0IG9mIG5ldCBkZXZpY2UgZmVhdHVyZXMgbm93LCBzdWNoIGFzIGZ1bmN0
aW9uCj4gPiA+IG5lZGV2X2FkZF90c29fZmVhdHVyZXMoKS4gSW4gb3JkZXIgdG8gbWluaW1pemUg
dG8gY2hhbmdlcy4KPiA+ID4KPiA+ID4gRm9yIHRoZSBmZWF0dXJlcyBhcmUgYXJyYXkgbm93LCBz
byBpdCdzIHVuYWJsZSB0byBkbyBsb2dpY2FsCj4gPiA+IG9wZXJhdGlvbiBkaXJlY3RseS4gSSBp
bnRyb2R1Y2UgYSBpbmxpbmUgZnVuY3Rpb24gc2V0IGZvcgo+ID4gPiB0aGVtLCBpbmNsdWRpbmcg
Im5ldGRldl9mZWF0dXJlc19hbmQvYW5kbm90L29yL3hvci9lcXVhbC9lbXB0eSIuCj4gPiA+Cj4g
PiA+IEZvciBORVRERVZfRkVBVFVSRV9DT1VOVCBtYXkgYmUgbW9yZSB0aGFuIDY0LCBzbyB0aGUg
c2hpZnQKPiA+ID4gb3BlcmF0aW9uIGZvciBORVRERVZfRkVBVFVSRV9DT1VOVCBpcyBpbGxlZ2Fs
LiBJIGNoYW5nZWQgc29tZQo+ID4gPiBtYWNyb2VzIGFuZCBmdW5jdGlvbnMsIHdoaWNoIGRvZXMg
c2hpZnQgb3BlcnRpb24gd2l0aCBpdC4KPiA+ID4KPiA+ID4gSSBoYXZlbid0IGZpbmlzaGVkIGFs
bCB0aGUgY2hhbmdlcywgZm9yIGl0IGFmZmVjdGVkIGFsbCB0aGUKPiA+ID4gZHJpdmVycyB3aGlj
aCB1c2UgdGhlIGZlYXR1cmUsIG5lZWQgbW9yZSB0aW1lIGFuZCB0ZXN0LiBJCj4gPiA+IHNlbnQg
dGhpcyBSRkMgcGF0Y2gsIHdhbnQgdG8ga25vdyB3aGV0aGVyIHRoaXMgY2hhbmdlIGlzCj4gPiA+
IGFjY2VwdGFibGUsIGFuZCBob3cgdG8gaW1wcm92ZSBpdC4KPiA+ID4KPiA+ID4gQW55IGNvbW1l
bnRzIHdpbGwgYmUgaGVscGZ1bC4KPiA+ID4KPiA+ID4gU2lnbmVkLW9mZi1ieTogSmlhbiBTaGVu
IDxzaGVuamlhbjE1QGh1YXdlaS5jb20+Cj4gPiA+IC0tLQo+ID4gPiAgZHJpdmVycy9uZXQvZXRo
ZXJuZXQvaGlzaWxpY29uL2hucy9obnNfZW5ldC5jICAgfCAgMzQgKy0tCj4gPiA+ICBkcml2ZXJz
L25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zMy9obnMzX2VuZXQuYyB8ICA5NyArKysrLS0tLS0K
PiA+ID4gIGRyaXZlcnMvbmV0L2V0aGVybmV0L2h1YXdlaS9oaW5pYy9oaW5pY19tYWluLmMgIHwg
IDcxICsrKy0tLQo+ID4gPiAgZHJpdmVycy9uZXQvZXRoZXJuZXQvaHVhd2VpL2hpbmljL2hpbmlj
X3J4LmMgICAgfCAgIDQgKy0KPiA+ID4gIGluY2x1ZGUvbGludXgvaWZfdmxhbi5oICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAyICstCj4gPiA+ICBpbmNsdWRlL2xpbnV4L25ldGRldl9mZWF0
dXJlcy5oICAgICAgICAgICAgICAgICB8IDEwNSArKysrKysrKy0KPiA+ID4gIGluY2x1ZGUvbGlu
dXgvbmV0ZGV2aWNlLmggICAgICAgICAgICAgICAgICAgICAgIHwgIDMxICstLQo+ID4gPiAgbmV0
LzgwMjFxL3ZsYW4uYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0KPiA+
ID4gIG5ldC84MDIxcS92bGFuLmggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAy
ICstCj4gPiA+ICBuZXQvODAyMXEvdmxhbl9kZXYuYyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8ICA0OSArKystLQo+ID4gPiAgbmV0L2NvcmUvZGV2LmMgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfCAyNzYgKysrKysrKysrKysrLS0tLS0tLS0tLS0tCj4gPiA+ICBuZXQvY29y
ZS9uZXRwb2xsLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgNiArLQo+ID4gPiAg
bmV0L2V0aHRvb2wvZmVhdHVyZXMuYyAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgNTYgKysr
LS0KPiA+ID4gIG5ldC9ldGh0b29sL2lvY3RsLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgIDkzICsrKysrLS0tCj4gPiA+ICAxNCBmaWxlcyBjaGFuZ2VkLCA0OTMgaW5zZXJ0aW9ucygr
KSwgMzM3IGRlbGV0aW9ucygtKQo+ID4gPgo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQv
ZXRoZXJuZXQvaGlzaWxpY29uL2hucy9obnNfZW5ldC5jCj4gPiA+IGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvaGlzaWxpY29uL2hucy9obnNfZW5ldC5jCj4gPiA+IGluZGV4IGFkNTM0ZjkuLjRmMjQ1
Y2YgMTAwNjQ0Cj4gPiA+IC0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2hpc2lsaWNvbi9obnMv
aG5zX2VuZXQuYwo+ID4gPiArKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5z
L2huc19lbmV0LmMKPiA+ID4gQEAgLTQ3OSw3ICs0NzksNyBAQCBzdGF0aWMgdm9pZCBobnNfbmlj
X3J4X2NoZWNrc3VtKHN0cnVjdAo+ID4gPiBobnNfbmljX3JpbmdfZGF0YSAqcmluZ19kYXRhLAo+
ID4gPiAgICAgICAgIHUzMiBsNGlkOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIGNoZWNrIGlmIFJY
IGNoZWNrc3VtIG9mZmxvYWQgaXMgZW5hYmxlZCAqLwo+ID4gPiAtICAgICAgIGlmICh1bmxpa2Vs
eSghKG5ldGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX1JYQ1NVTSkpKQo+ID4gPiArICAgICAgIGlm
ICh1bmxpa2VseSghKG5ldGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX1JYQ1NVTSkpKQo+ID4g
PiAgICAgICAgICAgICAgICAgcmV0dXJuOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIEluIGhhcmR3
YXJlLCB3ZSBvbmx5IHN1cHBvcnQgY2hlY2tzdW0gZm9yIHRoZSBmb2xsb3dpbmcgcHJvdG9jb2xz
Ogo+ID4gPiBAQCAtMTc2OCwxNyArMTc2OCwxNyBAQCBzdGF0aWMgaW50IGhuc19uaWNfY2hhbmdl
X210dShzdHJ1Y3QKPiA+ID4gbmV0X2RldmljZSAqbmRldiwgaW50IG5ld19tdHUpCj4gPiA+ICB9
Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgaW50IGhuc19uaWNfc2V0X2ZlYXR1cmVzKHN0cnVjdCBuZXRf
ZGV2aWNlICpuZXRkZXYsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1cmVzKQo+ID4gPiAgewo+ID4gPiAgICAgICAg
IHN0cnVjdCBobnNfbmljX3ByaXYgKnByaXYgPSBuZXRkZXZfcHJpdihuZXRkZXYpOwo+ID4gPgo+
ID4gPiAgICAgICAgIHN3aXRjaCAocHJpdi0+ZW5ldF92ZXIpIHsKPiA+ID4gICAgICAgICBjYXNl
IEFFX1ZFUlNJT05fMToKPiA+ID4gLSAgICAgICAgICAgICAgIGlmIChmZWF0dXJlcyAmIChORVRJ
Rl9GX1RTTyB8IE5FVElGX0ZfVFNPNikpCj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoZmVhdHVy
ZXNbMF0gJiAoTkVUSUZfRl9UU08gfCBORVRJRl9GX1RTTzYpKQo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICBuZXRkZXZfaW5mbyhuZXRkZXYsICJlbmV0IHYxIGRvIG5vdCBzdXBwb3J0IHRz
byFcbiIpOwo+ID4gPiAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ICAgICAgICAgZGVmYXVs
dDoKPiA+ID4gLSAgICAgICAgICAgICAgIGlmIChmZWF0dXJlcyAmIChORVRJRl9GX1RTTyB8IE5F
VElGX0ZfVFNPNikpIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChmZWF0dXJlc1swXSAmIChO
RVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNikpIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgcHJpdi0+b3BzLmZpbGxfZGVzYyA9IGZpbGxfdHNvX2Rlc2M7Cj4gPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgIHByaXYtPm9wcy5tYXliZV9zdG9wX3R4ID0gaG5zX25pY19tYXliZV9zdG9w
X3RzbzsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgLyogVGhlIGNoaXAgb25seSBzdXBw
b3J0IDcqNDA5NiAqLwo+ID4gPiBAQCAtMTc4OSwyNCArMTc4OSwyMyBAQCBzdGF0aWMgaW50IGhu
c19uaWNfc2V0X2ZlYXR1cmVzKHN0cnVjdAo+ID4gPiBuZXRfZGV2aWNlICpuZXRkZXYsCj4gPiA+
ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gICAg
ICAgICB9Cj4gPiA+IC0gICAgICAgbmV0ZGV2LT5mZWF0dXJlcyA9IGZlYXR1cmVzOwo+ID4gPiAr
ICAgICAgIG5ldGRldi0+ZmVhdHVyZXNbMF0gPSBmZWF0dXJlc1swXTsKPiA+ID4gICAgICAgICBy
ZXR1cm4gMDsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gLXN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdCBo
bnNfbmljX2ZpeF9mZWF0dXJlcygKPiA+ID4gLSAgICAgICAgICAgICAgIHN0cnVjdCBuZXRfZGV2
aWNlICpuZXRkZXYsIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzKQo+ID4gPiArc3RhdGljIHZv
aWQgaG5zX25pY19maXhfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1
cmVzKQo+ID4gPiAgewo+ID4gPiAgICAgICAgIHN0cnVjdCBobnNfbmljX3ByaXYgKnByaXYgPSBu
ZXRkZXZfcHJpdihuZXRkZXYpOwo+ID4gPgo+ID4gPiAgICAgICAgIHN3aXRjaCAocHJpdi0+ZW5l
dF92ZXIpIHsKPiA+ID4gICAgICAgICBjYXNlIEFFX1ZFUlNJT05fMToKPiA+ID4gLSAgICAgICAg
ICAgICAgIGZlYXR1cmVzICY9IH4oTkVUSUZfRl9UU08gfCBORVRJRl9GX1RTTzYgfAo+ID4gPiAr
ICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfihORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNP
NiB8Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9IV19WTEFO
X0NUQUdfRklMVEVSKTsKPiA+ID4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPiAgICAgICAg
IGRlZmF1bHQ6Cj4gPiA+ICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gICAgICAgICB9Cj4g
PiA+IC0gICAgICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGlj
IGludCBobnNfbmljX3VjX3N5bmMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgY29uc3QgdW5z
aWduZWQKPiA+ID4gY2hhciAqYWRkcikKPiA+ID4gQEAgLTIxNjMsOCArMjE2Miw4IEBAIHN0YXRp
YyB2b2lkIGhuc19uaWNfc2V0X3ByaXZfb3BzKHN0cnVjdAo+ID4gPiBuZXRfZGV2aWNlICpuZXRk
ZXYpCj4gPiA+ICAgICAgICAgICAgICAgICBwcml2LT5vcHMubWF5YmVfc3RvcF90eCA9IGhuc19u
aWNfbWF5YmVfc3RvcF90eDsKPiA+ID4gICAgICAgICB9IGVsc2Ugewo+ID4gPiAgICAgICAgICAg
ICAgICAgcHJpdi0+b3BzLmdldF9yeGRfYm51bSA9IGdldF92MnJ4X2Rlc2NfYm51bTsKPiA+ID4g
LSAgICAgICAgICAgICAgIGlmICgobmV0ZGV2LT5mZWF0dXJlcyAmIE5FVElGX0ZfVFNPKSB8fAo+
ID4gPiAtICAgICAgICAgICAgICAgICAgIChuZXRkZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9UU082
KSkgewo+ID4gPiArICAgICAgICAgICAgICAgaWYgKChuZXRkZXYtPmZlYXR1cmVzWzBdICYgTkVU
SUZfRl9UU08pIHx8Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgKG5ldGRldi0+ZmVhdHVyZXNb
MF0gJiBORVRJRl9GX1RTTzYpKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYt
Pm9wcy5maWxsX2Rlc2MgPSBmaWxsX3Rzb19kZXNjOwo+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICBwcml2LT5vcHMubWF5YmVfc3RvcF90eCA9IGhuc19uaWNfbWF5YmVfc3RvcF90c287Cj4g
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIFRoaXMgY2hpcCBvbmx5IHN1cHBvcnQgNyo0
MDk2ICovCj4gPiA+IEBAIC0yMzI1LDIyICsyMzI0LDIzIEBAIHN0YXRpYyBpbnQgaG5zX25pY19k
ZXZfcHJvYmUoc3RydWN0Cj4gPiA+IHBsYXRmb3JtX2RldmljZSAqcGRldikKPiA+ID4gICAgICAg
ICBuZGV2LT5uZXRkZXZfb3BzID0gJmhuc19uaWNfbmV0ZGV2X29wczsKPiA+ID4gICAgICAgICBo
bnNfZXRodG9vbF9zZXRfb3BzKG5kZXYpOwo+ID4gPgo+ID4gPiAtICAgICAgIG5kZXYtPmZlYXR1
cmVzIHw9IE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNIHwKPiA+ID4gKyAgICAg
ICBuZGV2LT5mZWF0dXJlc1swXSB8PSBORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NV
TSB8Cj4gPiA+ICAgICAgICAgICAgICAgICBORVRJRl9GX1JYQ1NVTSB8IE5FVElGX0ZfU0cgfCBO
RVRJRl9GX0dTTyB8Cj4gPiA+ICAgICAgICAgICAgICAgICBORVRJRl9GX0dSTzsKPiA+ID4gLSAg
ICAgICBuZGV2LT52bGFuX2ZlYXR1cmVzIHw9Cj4gPiA+ICsgICAgICAgbmRldi0+dmxhbl9mZWF0
dXJlc1swXSB8PQo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9JUF9DU1VNIHwgTkVUSUZf
Rl9JUFY2X0NTVU0gfCBORVRJRl9GX1JYQ1NVTTsKPiA+ID4gLSAgICAgICBuZGV2LT52bGFuX2Zl
YXR1cmVzIHw9IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dTTyB8IE5FVElGX0ZfR1JPOwo+ID4gPiAr
ICAgICAgIG5kZXYtPnZsYW5fZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9TRyB8IE5FVElGX0ZfR1NP
IHwgTkVUSUZfRl9HUk87Cj4gPiA+Cj4gPiA+ICAgICAgICAgLyogTVRVIHJhbmdlOiA2OCAtIDk1
NzggKHYxKSBvciA5NzA2ICh2MikgKi8KPiA+ID4gICAgICAgICBuZGV2LT5taW5fbXR1ID0gTUFD
X01JTl9NVFU7Cj4gPiA+ICAgICAgICAgc3dpdGNoIChwcml2LT5lbmV0X3Zlcikgewo+ID4gPiAg
ICAgICAgIGNhc2UgQUVfVkVSU0lPTl8yOgo+ID4gPiAtICAgICAgICAgICAgICAgbmRldi0+ZmVh
dHVyZXMgfD0gTkVUSUZfRl9UU08gfCBORVRJRl9GX1RTTzYgfCBORVRJRl9GX05UVVBMRTsKPiA+
ID4gLSAgICAgICAgICAgICAgIG5kZXYtPmh3X2ZlYXR1cmVzIHw9IE5FVElGX0ZfSVBfQ1NVTSB8
IE5FVElGX0ZfSVBWNl9DU1VNIHwKPiA+ID4gKyAgICAgICAgICAgICAgIG5kZXYtPmZlYXR1cmVz
WzBdIHw9Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9UU08g
fCBORVRJRl9GX1RTTzYgfCBORVRJRl9GX05UVVBMRTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5k
ZXYtPmh3X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VN
IHwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9SWENTVU0gfCBORVRJRl9G
X1NHIHwgTkVUSUZfRl9HU08gfAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9G
X0dSTyB8IE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082Owo+ID4gPiAtICAgICAgICAgICAgICAg
bmRldi0+dmxhbl9mZWF0dXJlcyB8PSBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNjsKPiA+ID4g
KyAgICAgICAgICAgICAgIG5kZXYtPnZsYW5fZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9UU08gfCBO
RVRJRl9GX1RTTzY7Cj4gPiA+ICAgICAgICAgICAgICAgICBuZGV2LT5tYXhfbXR1ID0gTUFDX01B
WF9NVFVfVjIgLQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChFVEhfSExF
TiArIEVUSF9GQ1NfTEVOICsgVkxBTl9ITEVOKTsKPiA+ID4gICAgICAgICAgICAgICAgIGJyZWFr
Owo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvaGlzaWxpY29uL2huczMv
aG5zM19lbmV0LmMKPiA+ID4gYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zMy9o
bnMzX2VuZXQuYwo+ID4gPiBpbmRleCBjZGI1ZjE0Li5iYTU2OTA3IDEwMDY0NAo+ID4gPiAtLS0g
YS9kcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zMy9obnMzX2VuZXQuYwo+ID4gPiAr
KysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zMy9obnMzX2VuZXQuYwo+ID4g
PiBAQCAtMTQ4MSw3ICsxNDgxLDcgQEAgc3RhdGljIGludCBobnMzX2hhbmRsZV92dGFncyhzdHJ1
Y3QKPiA+ID4gaG5zM19lbmV0X3JpbmcgKnR4X3JpbmcsCj4gPiA+ICAgICAgICAgICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAoc2tiLT5wcm90b2NvbCA9PSBo
dG9ucyhFVEhfUF84MDIxUSkgJiYKPiA+ID4gLSAgICAgICAgICAgIShoYW5kbGUtPmtpbmZvLm5l
dGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19UWCkpIHsKPiA+ID4gKyAgICAg
ICAgICAgIShoYW5kbGUtPmtpbmZvLm5ldGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX1ZM
QU5fQ1RBR19UWCkpIHsKPiA+ID4gICAgICAgICAgICAgICAgIC8qIFdoZW4gSFcgVkxBTiBhY2Nl
bGVyYXRpb24gaXMgdHVybmVkIG9mZiwgYW5kIHRoZSBzdGFjawo+ID4gPiAgICAgICAgICAgICAg
ICAgICogc2V0cyB0aGUgcHJvdG9jb2wgdG8gODAyLjFxLCB0aGUgZHJpdmVyIGp1c3QgbmVlZCB0
bwo+ID4gPiAgICAgICAgICAgICAgICAgICogc2V0IHRoZSBwcm90b2NvbCB0byB0aGUgZW5jYXBz
dWxhdGVkIGV0aGVydHlwZS4KPiA+ID4gQEAgLTIzMDAsNTYgKzIzMDAsNTcgQEAgc3RhdGljIGlu
dCBobnMzX25pY19kb19pb2N0bChzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LAo+ID4gPiAgfQo+
ID4gPgo+ID4gPiAgc3RhdGljIGludCBobnMzX25pY19zZXRfZmVhdHVyZXMoc3RydWN0IG5ldF9k
ZXZpY2UgKm5ldGRldiwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG5ldGRldl9mZWF0dXJlc190ICpmZWF0dXJlcykKPiA+ID4gIHsKPiA+ID4gLSAgICAg
ICBuZXRkZXZfZmVhdHVyZXNfdCBjaGFuZ2VkID0gbmV0ZGV2LT5mZWF0dXJlcyBeIGZlYXR1cmVz
Owo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190IGNoYW5nZWRbTkVUREVWX0ZFQVRVUkVf
RFdPUkRTXTsKPiA+ID4gICAgICAgICBzdHJ1Y3QgaG5zM19uaWNfcHJpdiAqcHJpdiA9IG5ldGRl
dl9wcml2KG5ldGRldik7Cj4gPiA+ICAgICAgICAgc3RydWN0IGhuYWUzX2hhbmRsZSAqaCA9IHBy
aXYtPmFlX2hhbmRsZTsKPiA+ID4gICAgICAgICBib29sIGVuYWJsZTsKPiA+ID4gICAgICAgICBp
bnQgcmV0Owo+ID4gPgo+ID4gPiAtICAgICAgIGlmIChjaGFuZ2VkICYgKE5FVElGX0ZfR1JPX0hX
KSAmJiBoLT5hZV9hbGdvLT5vcHMtPnNldF9ncm9fZW4pIHsKPiA+ID4gLSAgICAgICAgICAgICAg
IGVuYWJsZSA9ICEhKGZlYXR1cmVzICYgTkVUSUZfRl9HUk9fSFcpOwo+ID4gPiArICAgICAgIG5l
dGRldl9mZWF0dXJlc194b3IoY2hhbmdlZCwgbmV0ZGV2LT5mZWF0dXJlcywgZmVhdHVyZXMpOwo+
ID4gPiArICAgICAgIGlmIChjaGFuZ2VkWzBdICYgKE5FVElGX0ZfR1JPX0hXKSAmJiBoLT5hZV9h
bGdvLT5vcHMtPnNldF9ncm9fZW4pIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGVuYWJsZSA9ICEh
KGZlYXR1cmVzWzBdICYgTkVUSUZfRl9HUk9fSFcpOwo+ID4gPiAgICAgICAgICAgICAgICAgcmV0
ID0gaC0+YWVfYWxnby0+b3BzLT5zZXRfZ3JvX2VuKGgsIGVuYWJsZSk7Cj4gPiA+ICAgICAgICAg
ICAgICAgICBpZiAocmV0KQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0
Owo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoKGNoYW5nZWQgJiBORVRJ
Rl9GX0hXX1ZMQU5fQ1RBR19SWCkgJiYKPiA+ID4gKyAgICAgICBpZiAoKGNoYW5nZWRbMF0gJiBO
RVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCkgJiYKPiA+ID4gICAgICAgICAgICAgaC0+YWVfYWxnby0+
b3BzLT5lbmFibGVfaHdfc3RyaXBfcnh2dGFnKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICBlbmFi
bGUgPSAhIShmZWF0dXJlcyAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYKTsKPiA+ID4gKyAgICAg
ICAgICAgICAgIGVuYWJsZSA9ICEhKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19WTEFOX0NUQUdf
UlgpOwo+ID4gPiAgICAgICAgICAgICAgICAgcmV0ID0gaC0+YWVfYWxnby0+b3BzLT5lbmFibGVf
aHdfc3RyaXBfcnh2dGFnKGgsIGVuYWJsZSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBpZiAocmV0
KQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+ID4gPiAgICAgICAg
IH0KPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoKGNoYW5nZWQgJiBORVRJRl9GX05UVVBMRSkgJiYg
aC0+YWVfYWxnby0+b3BzLT5lbmFibGVfZmQpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIGVuYWJs
ZSA9ICEhKGZlYXR1cmVzICYgTkVUSUZfRl9OVFVQTEUpOwo+ID4gPiArICAgICAgIGlmICgoY2hh
bmdlZFswXSAmIE5FVElGX0ZfTlRVUExFKSAmJiBoLT5hZV9hbGdvLT5vcHMtPmVuYWJsZV9mZCkg
ewo+ID4gPiArICAgICAgICAgICAgICAgZW5hYmxlID0gISEoZmVhdHVyZXNbMF0gJiBORVRJRl9G
X05UVVBMRSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBoLT5hZV9hbGdvLT5vcHMtPmVuYWJsZV9m
ZChoLCBlbmFibGUpOwo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoKG5l
dGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX0hXX1RDKSA+IChmZWF0dXJlcyAmIE5FVElGX0ZfSFdf
VEMpICYmCj4gPiA+ICsgICAgICAgaWYgKChuZXRkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9I
V19UQykgPgo+ID4gPiArICAgICAgICAgICAgKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19UQykg
JiYKPiA+ID4gICAgICAgICAgICAgaC0+YWVfYWxnby0+b3BzLT5jbHNfZmxvd2VyX2FjdGl2ZSho
KSkgewo+ID4gPiAgICAgICAgICAgICAgICAgbmV0ZGV2X2VycihuZXRkZXYsCj4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICJ0aGVyZSBhcmUgb2ZmbG9hZGVkIFRDIGZpbHRlcnMgYWN0
aXZlLAo+ID4gPiBjYW5ub3QgZGlzYWJsZSBIVyBUQyBvZmZsb2FkIik7Cj4gPiA+ICAgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAg
ICAgaWYgKChjaGFuZ2VkICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfRklMVEVSKSAmJgo+ID4gPiAr
ICAgICAgIGlmICgoY2hhbmdlZFswXSAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRFUikgJiYK
PiA+ID4gICAgICAgICAgICAgaC0+YWVfYWxnby0+b3BzLT5lbmFibGVfdmxhbl9maWx0ZXIpIHsK
PiA+ID4gLSAgICAgICAgICAgICAgIGVuYWJsZSA9ICEhKGZlYXR1cmVzICYgTkVUSUZfRl9IV19W
TEFOX0NUQUdfRklMVEVSKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGVuYWJsZSA9ICEhKGZlYXR1
cmVzWzBdICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfRklMVEVSKTsKPiA+ID4gICAgICAgICAgICAg
ICAgIHJldCA9IGgtPmFlX2FsZ28tPm9wcy0+ZW5hYmxlX3ZsYW5fZmlsdGVyKGgsIGVuYWJsZSk7
Cj4gPiA+ICAgICAgICAgICAgICAgICBpZiAocmV0KQo+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gcmV0Owo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAgICAgICBuZXRk
ZXYtPmZlYXR1cmVzID0gZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2Nv
cHkobmV0ZGV2LT5mZWF0dXJlcywgZmVhdHVyZXMpOwo+ID4gPiAgICAgICAgIHJldHVybiAwOwo+
ID4gPiAgfQo+ID4gPgo+ID4gPiAtc3RhdGljIG5ldGRldl9mZWF0dXJlc190IGhuczNfZmVhdHVy
ZXNfY2hlY2soc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVz
X3QgZmVhdHVyZXMpCj4gPiA+ICtzdGF0aWMgdm9pZCBobnMzX2ZlYXR1cmVzX2NoZWNrKHN0cnVj
dCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1cmVzKQo+ID4gPiAg
ewo+ID4gPiAgI2RlZmluZSBITlMzX01BWF9IRFJfTEVOICAgICAgIDQ4MFUKPiA+ID4gICNkZWZp
bmUgSE5TM19NQVhfTDRfSERSX0xFTiAgICA2MFUKPiA+ID4gQEAgLTIzNzMsOSArMjM3NCw3IEBA
IHN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdAo+ID4gPiBobnMzX2ZlYXR1cmVzX2NoZWNrKHN0cnVj
dCBza19idWZmICpza2IsCj4gPiA+ICAgICAgICAgICogbGVuIG9mIDQ4MCBieXRlcy4KPiA+ID4g
ICAgICAgICAgKi8KPiA+ID4gICAgICAgICBpZiAobGVuID4gSE5TM19NQVhfSERSX0xFTikKPiA+
ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH4oTkVUSUZfRl9DU1VNX01BU0sgfCBORVRJ
Rl9GX0dTT19NQVNLKTsKPiA+ID4gLQo+ID4gPiAtICAgICAgIHJldHVybiBmZWF0dXJlczsKPiA+
ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH4oTkVUSUZfRl9DU1VNX01BU0sgfCBO
RVRJRl9GX0dTT19NQVNLKTsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIHN0YXRpYyB2b2lkIGhuczNf
bmljX2dldF9zdGF0czY0KHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsCj4gPiA+IEBAIC0zMTI3
LDI3ICszMTI2LDI4IEBAIHN0YXRpYyB2b2lkIGhuczNfc2V0X2RlZmF1bHRfZmVhdHVyZShzdHJ1
Y3QKPiA+ID4gbmV0X2RldmljZSAqbmV0ZGV2KQo+ID4gPgo+ID4gPiAgICAgICAgIG5ldGRldi0+
cHJpdl9mbGFncyB8PSBJRkZfVU5JQ0FTVF9GTFQ7Cj4gPiA+Cj4gPiA+IC0gICAgICAgbmV0ZGV2
LT5od19lbmNfZmVhdHVyZXMgfD0gTkVUSUZfRl9SWENTVU0gfCBORVRJRl9GX1NHIHwgTkVUSUZf
Rl9HU08gfAo+ID4gPiArICAgICAgIG5ldGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdIHw9Cj4gPiA+
ICsgICAgICAgICAgICAgICBORVRJRl9GX1JYQ1NVTSB8IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dT
TyB8Cj4gPiA+ICAgICAgICAgICAgICAgICBORVRJRl9GX0dSTyB8IE5FVElGX0ZfVFNPIHwgTkVU
SUZfRl9UU082IHwgTkVUSUZfRl9HU09fR1JFIHwKPiA+ID4gICAgICAgICAgICAgICAgIE5FVElG
X0ZfR1NPX0dSRV9DU1VNIHwgTkVUSUZfRl9HU09fVURQX1RVTk5FTCB8Cj4gPiA+ICAgICAgICAg
ICAgICAgICBORVRJRl9GX1NDVFBfQ1JDIHwgTkVUSUZfRl9UU09fTUFOR0xFSUQgfCBORVRJRl9G
X0ZSQUdMSVNUOwo+ID4gPgo+ID4gPiAgICAgICAgIG5ldGRldi0+Z3NvX3BhcnRpYWxfZmVhdHVy
ZXMgfD0gTkVUSUZfRl9HU09fR1JFX0NTVU07Cj4gPiA+Cj4gPiA+IC0gICAgICAgbmV0ZGV2LT5m
ZWF0dXJlcyB8PSBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIgfAo+ID4gPiArICAgICAgIG5l
dGRldi0+ZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9IV19WTEFOX0NUQUdfRklMVEVSIHwKPiA+ID4g
ICAgICAgICAgICAgICAgIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RYIHwgTkVUSUZfRl9IV19WTEFO
X0NUQUdfUlggfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9SWENTVU0gfCBORVRJRl9G
X1NHIHwgTkVUSUZfRl9HU08gfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9HUk8gfCBO
RVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNiB8IE5FVElGX0ZfR1NPX0dSRSB8Cj4gPiA+ICAgICAg
ICAgICAgICAgICBORVRJRl9GX0dTT19HUkVfQ1NVTSB8IE5FVElGX0ZfR1NPX1VEUF9UVU5ORUwg
fAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9TQ1RQX0NSQyB8IE5FVElGX0ZfRlJBR0xJ
U1Q7Cj4gPiA+Cj4gPiA+IC0gICAgICAgbmV0ZGV2LT52bGFuX2ZlYXR1cmVzIHw9IE5FVElGX0Zf
UlhDU1VNIHwKPiA+ID4gKyAgICAgICBuZXRkZXYtPnZsYW5fZmVhdHVyZXNbMF0gfD0gTkVUSUZf
Rl9SWENTVU0gfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9TRyB8IE5FVElGX0ZfR1NP
IHwgTkVUSUZfRl9HUk8gfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9UU08gfCBORVRJ
Rl9GX1RTTzYgfCBORVRJRl9GX0dTT19HUkUgfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZf
Rl9HU09fR1JFX0NTVU0gfCBORVRJRl9GX0dTT19VRFBfVFVOTkVMIHwKPiA+ID4gICAgICAgICAg
ICAgICAgIE5FVElGX0ZfU0NUUF9DUkMgfCBORVRJRl9GX0ZSQUdMSVNUOwo+ID4gPgo+ID4gPiAt
ICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9IV19WTEFOX0NUQUdfVFggfAo+
ID4gPiArICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9IV19WTEFOX0NU
QUdfVFggfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9IV19WTEFOX0NUQUdfUlggfAo+
ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9SWENTVU0gfCBORVRJRl9GX1NHIHwgTkVUSUZf
Rl9HU08gfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9HUk8gfCBORVRJRl9GX1RTTyB8
IE5FVElGX0ZfVFNPNiB8IE5FVElGX0ZfR1NPX0dSRSB8Cj4gPiA+IEBAIC0zMTU1LDQ4ICszMTU1
LDQ5IEBAIHN0YXRpYyB2b2lkIGhuczNfc2V0X2RlZmF1bHRfZmVhdHVyZShzdHJ1Y3QKPiA+ID4g
bmV0X2RldmljZSAqbmV0ZGV2KQo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9TQ1RQX0NS
QyB8IE5FVElGX0ZfRlJBR0xJU1Q7Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKGFlX2Rldi0+ZGV2
X3ZlcnNpb24gPj0gSE5BRTNfREVWSUNFX1ZFUlNJT05fVjIpIHsKPiA+ID4gLSAgICAgICAgICAg
ICAgIG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9HUk9fSFc7Cj4gPiA+IC0gICAgICAg
ICAgICAgICBuZXRkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfR1JPX0hXOwo+ID4gPiArICAgICAg
ICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlc1swXSB8PSBORVRJRl9GX0dST19IVzsKPiA+ID4g
KyAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9HUk9fSFc7Cj4g
PiA+Cj4gPiA+ICAgICAgICAgICAgICAgICBpZiAoIShoLT5mbGFncyAmIEhOQUUzX1NVUFBPUlRf
VkYpKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXMg
fD0gTkVUSUZfRl9OVFVQTEU7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG5ldGRldi0+
ZmVhdHVyZXMgfD0gTkVUSUZfRl9OVFVQTEU7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
IG5ldGRldi0+aHdfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9OVFVQTEU7Cj4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9OVFVQTEU7Cj4g
PiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAgICAgICAg
IGlmICh0ZXN0X2JpdChITkFFM19ERVZfU1VQUE9SVF9VRFBfR1NPX0IsIGFlX2Rldi0+Y2Fwcykp
IHsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9H
U09fVURQX0w0Owo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5mZWF0dXJlcyB8PSBORVRJ
Rl9GX0dTT19VRFBfTDQ7Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPnZsYW5fZmVhdHVy
ZXMgfD0gTkVUSUZfRl9HU09fVURQX0w0Owo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5o
d19lbmNfZmVhdHVyZXMgfD0gTkVUSUZfRl9HU09fVURQX0w0Owo+ID4gPiArICAgICAgICAgICAg
ICAgbmV0ZGV2LT5od19mZWF0dXJlc1swXSB8PSBORVRJRl9GX0dTT19VRFBfTDQ7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBuZXRkZXYtPmZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfR1NPX1VEUF9MNDsK
PiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+dmxhbl9mZWF0dXJlc1swXSB8PSBORVRJRl9G
X0dTT19VRFBfTDQ7Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2VuY19mZWF0dXJl
c1swXSB8PSBORVRJRl9GX0dTT19VRFBfTDQ7Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAg
ICAgICAgIGlmICh0ZXN0X2JpdChITkFFM19ERVZfU1VQUE9SVF9IV19UWF9DU1VNX0IsIGFlX2Rl
di0+Y2FwcykpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXMgfD0g
TkVUSUZfRl9IV19DU1VNOwo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5mZWF0dXJlcyB8
PSBORVRJRl9GX0hXX0NTVU07Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPnZsYW5fZmVh
dHVyZXMgfD0gTkVUSUZfRl9IV19DU1VNOwo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5o
d19lbmNfZmVhdHVyZXMgfD0gTkVUSUZfRl9IV19DU1VNOwo+ID4gPiArICAgICAgICAgICAgICAg
bmV0ZGV2LT5od19mZWF0dXJlc1swXSB8PSBORVRJRl9GX0hXX0NTVU07Cj4gPiA+ICsgICAgICAg
ICAgICAgICBuZXRkZXYtPmZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSFdfQ1NVTTsKPiA+ID4gKyAg
ICAgICAgICAgICAgIG5ldGRldi0+dmxhbl9mZWF0dXJlc1swXSB8PSBORVRJRl9GX0hXX0NTVU07
Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2VuY19mZWF0dXJlc1swXSB8PSBORVRJ
Rl9GX0hXX0NTVU07Cj4gPiA+ICAgICAgICAgfSBlbHNlIHsKPiA+ID4gLSAgICAgICAgICAgICAg
IG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9JUF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NT
VU07Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfSVBf
Q1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNOwo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT52
bGFuX2ZlYXR1cmVzIHw9IE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNOwo+ID4g
PiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5od19lbmNfZmVhdHVyZXMgfD0gTkVUSUZfRl9JUF9D
U1VNIHwgTkVUSUZfRl9JUFY2X0NTVU07Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3
X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNOwo+ID4g
PiArICAgICAgICAgICAgICAgbmV0ZGV2LT5mZWF0dXJlc1swXSB8PSBORVRJRl9GX0lQX0NTVU0g
fCBORVRJRl9GX0lQVjZfQ1NVTTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+dmxhbl9m
ZWF0dXJlc1swXSB8PSBORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTTsKPiA+ID4g
KyAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdIHw9Cj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0lQX0NTVU0gfCBORVRJ
Rl9GX0lQVjZfQ1NVTTsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKHRl
c3RfYml0KEhOQUUzX0RFVl9TVVBQT1JUX1VEUF9UVU5ORUxfQ1NVTV9CLCBhZV9kZXYtPmNhcHMp
KSB7Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPmh3X2ZlYXR1cmVzIHw9IE5FVElGX0Zf
R1NPX1VEUF9UVU5ORUxfQ1NVTTsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVy
ZXMgfD0gTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiAtICAgICAgICAgICAgICAg
bmV0ZGV2LT52bGFuX2ZlYXR1cmVzIHw9IE5FVElGX0ZfR1NPX1VEUF9UVU5ORUxfQ1NVTTsKPiA+
ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZW5jX2ZlYXR1cmVzIHw9IE5FVElGX0ZfR1NP
X1VEUF9UVU5ORUxfQ1NVTTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVy
ZXNbMF0gfD0gTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiArICAgICAgICAgICAg
ICAgbmV0ZGV2LT5mZWF0dXJlc1swXSB8PSBORVRJRl9GX0dTT19VRFBfVFVOTkVMX0NTVU07Cj4g
PiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPnZsYW5fZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9H
U09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2LT5od19lbmNf
ZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiAgICAgICAg
IH0KPiA+ID4KPiA+ID4gICAgICAgICBpZiAodGVzdF9iaXQoSE5BRTNfREVWX1NVUFBPUlRfRkRf
Rk9SV0FSRF9UQ19CLCBhZV9kZXYtPmNhcHMpKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRk
ZXYtPmh3X2ZlYXR1cmVzIHw9IE5FVElGX0ZfSFdfVEM7Cj4gPiA+IC0gICAgICAgICAgICAgICBu
ZXRkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfSFdfVEM7Cj4gPiA+ICsgICAgICAgICAgICAgICBu
ZXRkZXYtPmh3X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSFdfVEM7Cj4gPiA+ICsgICAgICAgICAg
ICAgICBuZXRkZXYtPmZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSFdfVEM7Cj4gPiA+ICAgICAgICAg
fQo+ID4gPgo+ID4gPiAgICAgICAgIGlmICh0ZXN0X2JpdChITkFFM19ERVZfU1VQUE9SVF9WTEFO
X0ZMVFJfTURGX0IsIGFlX2Rldi0+Y2FwcykpCj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYt
Pmh3X2ZlYXR1cmVzIHw9IE5FVElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRFUjsKPiA+ID4gKyAgICAg
ICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9IV19WTEFOX0NUQUdf
RklMVEVSOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGljIGludCBobnMzX2FsbG9jX2J1ZmZl
cihzdHJ1Y3QgaG5zM19lbmV0X3JpbmcgKnJpbmcsCj4gPiA+IEBAIC0zNzI3LDcgKzM3MjgsNyBA
QCBzdGF0aWMgdm9pZCBobnMzX3J4X2NoZWNrc3VtKHN0cnVjdAo+ID4gPiBobnMzX2VuZXRfcmlu
ZyAqcmluZywgc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4KPiA+ID4gICAgICAgICBza2JfY2hl
Y2tzdW1fbm9uZV9hc3NlcnQoc2tiKTsKPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoIShuZXRkZXYt
PmZlYXR1cmVzICYgTkVUSUZfRl9SWENTVU0pKQo+ID4gPiArICAgICAgIGlmICghKG5ldGRldi0+
ZmVhdHVyZXNbMF0gJiBORVRJRl9GX1JYQ1NVTSkpCj4gPiA+ICAgICAgICAgICAgICAgICByZXR1
cm47Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKHRlc3RfYml0KEhOUzNfTklDX1NUQVRFX1JYRF9B
RFZfTEFZT1VUX0VOQUJMRSwgJnByaXYtPnN0YXRlKSkKPiA+ID4gQEAgLTQwMjQsNyArNDAyNSw3
IEBAIHN0YXRpYyBpbnQgaG5zM19oYW5kbGVfYmRpbmZvKHN0cnVjdAo+ID4gPiBobnMzX2VuZXRf
cmluZyAqcmluZywgc3RydWN0IHNrX2J1ZmYgKnNrYikKPiA+ID4gICAgICAgICAgKiBvdF92bGFu
X3RhZyBpbiB0d28gbGF5ZXIgdGFnIGNhc2UsIGFuZCBzdG9yZWQgYXQgdmxhbl90YWcKPiA+ID4g
ICAgICAgICAgKiBpbiBvbmUgbGF5ZXIgdGFnIGNhc2UuCj4gPiA+ICAgICAgICAgICovCj4gPiA+
IC0gICAgICAgaWYgKG5ldGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCkg
ewo+ID4gPiArICAgICAgIGlmIChuZXRkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19WTEFO
X0NUQUdfUlgpIHsKPiA+ID4gICAgICAgICAgICAgICAgIHUxNiB2bGFuX3RhZzsKPiA+ID4KPiA+
ID4gICAgICAgICAgICAgICAgIGlmIChobnMzX3BhcnNlX3ZsYW5fdGFnKHJpbmcsIGRlc2MsIGwy
MzRpbmZvLCAmdmxhbl90YWcpKQo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvaHVhd2VpL2hpbmljL2hpbmljX21haW4uYwo+ID4gPiBiL2RyaXZlcnMvbmV0L2V0aGVybmV0
L2h1YXdlaS9oaW5pYy9oaW5pY19tYWluLmMKPiA+ID4gaW5kZXggNDA1ZWU0ZC4uYjE5M2VlNCAx
MDA2NDQKPiA+ID4gLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvaHVhd2VpL2hpbmljL2hpbmlj
X21haW4uYwo+ID4gPiArKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9odWF3ZWkvaGluaWMvaGlu
aWNfbWFpbi5jCj4gPiA+IEBAIC03OSw4ICs3OSw4IEBAIE1PRFVMRV9QQVJNX0RFU0Mocnhfd2Vp
Z2h0LCAiTnVtYmVyIFJ4IHBhY2tldHMgZm9yCj4gPiA+IE5BUEkgYnVkZ2V0IChkZWZhdWx0PTY0
KSIpOwo+ID4gPiAgc3RhdGljIGludCBjaGFuZ2VfbWFjX2FkZHIoc3RydWN0IG5ldF9kZXZpY2Ug
Km5ldGRldiwgY29uc3QgdTggKmFkZHIpOwo+ID4gPgo+ID4gPiAgc3RhdGljIGludCBzZXRfZmVh
dHVyZXMoc3RydWN0IGhpbmljX2RldiAqbmljX2RldiwKPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgcHJlX2ZlYXR1cmVzLAo+ID4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcywgYm9vbCBmb3JjZV9jaGFuZ2Up
Owo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAqcHJlX2Zl
YXR1cmVzLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAq
ZmVhdHVyZXMsIGJvb2wgZm9yY2VfY2hhbmdlKTsKPiA+ID4KPiA+ID4gIHN0YXRpYyB2b2lkIHVw
ZGF0ZV9yeF9zdGF0cyhzdHJ1Y3QgaGluaWNfZGV2ICpuaWNfZGV2LCBzdHJ1Y3QgaGluaWNfcnhx
ICpyeHEpCj4gPiA+ICB7Cj4gPiA+IEBAIC04ODAsNyArODgwLDcgQEAgc3RhdGljIHZvaWQgaGlu
aWNfZ2V0X3N0YXRzNjQoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwKPiA+ID4gIH0KPiA+ID4K
PiA+ID4gIHN0YXRpYyBpbnQgaGluaWNfc2V0X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpu
ZXRkZXYsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJl
c190IGZlYXR1cmVzKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZf
ZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgc3RydWN0IGhpbmlj
X2RldiAqbmljX2RldiA9IG5ldGRldl9wcml2KG5ldGRldik7Cj4gPiA+Cj4gPiA+IEBAIC04ODgs
MTggKzg4OCwxNiBAQCBzdGF0aWMgaW50IGhpbmljX3NldF9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2Rl
dmljZSAqbmV0ZGV2LAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMs
IGZhbHNlKTsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gLXN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdCBo
aW5pY19maXhfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwKPiA+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBm
ZWF0dXJlcykKPiA+ID4gK3N0YXRpYyB2b2lkIGhpbmljX2ZpeF9mZWF0dXJlcyhzdHJ1Y3QgbmV0
X2RldmljZSAqbmV0ZGV2LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgc3RydWN0IGhp
bmljX2RldiAqbmljX2RldiA9IG5ldGRldl9wcml2KG5ldGRldik7Cj4gPiA+Cj4gPiA+ICAgICAg
ICAgLyogSWYgUnggY2hlY2tzdW0gaXMgZGlzYWJsZWQsIHRoZW4gTFJPIHNob3VsZCBhbHNvIGJl
IGRpc2FibGVkICovCj4gPiA+IC0gICAgICAgaWYgKCEoZmVhdHVyZXMgJiBORVRJRl9GX1JYQ1NV
TSkpIHsKPiA+ID4gKyAgICAgICBpZiAoIShmZWF0dXJlc1swXSAmIE5FVElGX0ZfUlhDU1VNKSkg
ewo+ID4gPiAgICAgICAgICAgICAgICAgbmV0aWZfaW5mbyhuaWNfZGV2LCBkcnYsIG5ldGRldiwg
ImRpc2FibGluZyBMUk8gYXMKPiA+ID4gUlhDU1VNIGlzIG9mZlxuIik7Cj4gPiA+IC0gICAgICAg
ICAgICAgICBmZWF0dXJlcyAmPSB+TkVUSUZfRl9MUk87Cj4gPiA+ICsgICAgICAgICAgICAgICBm
ZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9MUk87Cj4gPiA+ICAgICAgICAgfQo+ID4gPiAtCj4gPiA+
IC0gICAgICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGljIGNv
bnN0IHN0cnVjdCBuZXRfZGV2aWNlX29wcyBoaW5pY19uZXRkZXZfb3BzID0gewo+ID4gPiBAQCAt
OTQzLDE5ICs5NDEsMjIgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBuZXRfZGV2aWNlX29wcyBoaW5p
Y3ZmX25ldGRldl9vcHMgPSB7Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgdm9pZCBuZXRkZXZfZmVhdHVy
ZXNfaW5pdChzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2KQo+ID4gPiAgewo+ID4gPiAtICAgICAg
IG5ldGRldi0+aHdfZmVhdHVyZXMgPSBORVRJRl9GX1NHIHwgTkVUSUZfRl9ISUdIRE1BIHwgTkVU
SUZfRl9JUF9DU1VNIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZf
Rl9JUFY2X0NTVU0gfCBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNiB8Cj4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfUlhDU1VNIHwgTkVUSUZfRl9MUk8gfAo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0hXX1ZMQU5fQ1RBR19UWCB8
Cj4gPiA+IE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgTkVUSUZfRl9HU09fVURQX1RVTk5FTCB8Cj4gPiA+IE5FVElGX0ZfR1NPX1VE
UF9UVU5ORUxfQ1NVTTsKPiA+ID4gLQo+ID4gPiAtICAgICAgIG5ldGRldi0+dmxhbl9mZWF0dXJl
cyA9IG5ldGRldi0+aHdfZmVhdHVyZXM7Cj4gPiA+IC0KPiA+ID4gLSAgICAgICBuZXRkZXYtPmZl
YXR1cmVzID0gbmV0ZGV2LT5od19mZWF0dXJlcyB8IE5FVElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRF
UjsKPiA+ID4gLQo+ID4gPiAtICAgICAgIG5ldGRldi0+aHdfZW5jX2ZlYXR1cmVzID0gTkVUSUZf
Rl9JUF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NTVU0KPiA+ID4gfCBORVRJRl9GX1NDVFBfQ1JDIHwK
PiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfU0cgfCBORVRJ
Rl9GX1RTTyB8Cj4gPiA+IE5FVElGX0ZfVFNPNiB8IE5FVElGX0ZfVFNPX0VDTiB8Cj4gPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19VRFBfVFVOTkVMX0NT
VU0gfAo+ID4gPiBORVRJRl9GX0dTT19VRFBfVFVOTkVMOwo+ID4gPiArICAgICAgIG5ldGRldi0+
aHdfZmVhdHVyZXNbMF0gPQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX1NH
IHwgTkVUSUZfRl9ISUdIRE1BIHwgTkVUSUZfRl9JUF9DU1VNIHwKPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgTkVUSUZfRl9JUFY2X0NTVU0gfCBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNP
NiB8Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfUlhDU1VNIHwgTkVUSUZf
Rl9MUk8gfAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0hXX1ZMQU5fQ1RB
R19UWCB8IE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYIHwKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgTkVUSUZfRl9HU09fVURQX1RVTk5FTCB8IE5FVElGX0ZfR1NPX1VEUF9UVU5ORUxfQ1NV
TTsKPiA+ID4gKwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc19jb3B5KG5ldGRldi0+dmxh
bl9mZWF0dXJlcywgbmV0ZGV2LT5od19mZWF0dXJlcyk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBu
ZXRkZXYtPmZlYXR1cmVzWzBdID0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2
LT5od19mZWF0dXJlc1swXSB8IE5FVElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRFUjsKPiA+ID4gKwo+
ID4gPiArICAgICAgIG5ldGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdID0KPiA+ID4gKyAgICAgICAg
ICAgICAgIE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNIHwgTkVUSUZfRl9TQ1RQ
X0NSQyB8Cj4gPiA+ICsgICAgICAgICAgICAgICBORVRJRl9GX1NHIHwgTkVUSUZfRl9UU08gfCBO
RVRJRl9GX1RTTzYgfCBORVRJRl9GX1RTT19FQ04gfAo+ID4gPiArICAgICAgICAgICAgICAgTkVU
SUZfRl9HU09fVURQX1RVTk5FTF9DU1VNIHwgTkVUSUZfRl9HU09fVURQX1RVTk5FTDsKPiA+ID4g
IH0KPiA+ID4KPiA+ID4gIHN0YXRpYyB2b2lkIGhpbmljX3JlZnJlc2hfbmljX2NmZyhzdHJ1Y3Qg
aGluaWNfZGV2ICpuaWNfZGV2KQo+ID4gPiBAQCAtMTA3MiwyMSArMTA3MywyMiBAQCBzdGF0aWMg
dm9pZCBsaW5rX2Vycl9ldmVudCh2b2lkICpoYW5kbGUsCj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICBz
dGF0aWMgaW50IHNldF9mZWF0dXJlcyhzdHJ1Y3QgaGluaWNfZGV2ICpuaWNfZGV2LAo+ID4gPiAt
ICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBwcmVfZmVhdHVyZXMsCj4g
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzLCBi
b29sIGZvcmNlX2NoYW5nZSkKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2Zl
YXR1cmVzX3QgKnByZV9mZWF0dXJlcywKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1cmVzLCBib29sIGZvcmNlX2NoYW5nZSkKPiA+ID4gIHsKPiA+
ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBjaGFuZ2VkID0gZm9yY2VfY2hhbmdlID8gfjAg
OiBwcmVfZmVhdHVyZXMgXiBmZWF0dXJlczsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNf
dCBmYWlsZWRfZmVhdHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXSA9IHswfTsKPiA+ID4gICAg
ICAgICB1MzIgY3N1bV9lbiA9IEhJTklDX1JYX0NTVU1fT0ZGTE9BRF9FTjsKPiA+ID4gLSAgICAg
ICBuZXRkZXZfZmVhdHVyZXNfdCBmYWlsZWRfZmVhdHVyZXMgPSAwOwo+ID4gPiArICAgICAgIG5l
dGRldl9mZWF0dXJlc190IGNoYW5nZWQ7Cj4gPiA+ICAgICAgICAgaW50IHJldCA9IDA7Cj4gPiA+
ICAgICAgICAgaW50IGVyciA9IDA7Cj4gPiA+Cj4gPiA+ICsgICAgICAgY2hhbmdlZCA9IGZvcmNl
X2NoYW5nZSA/IH4wIDogcHJlX2ZlYXR1cmVzWzBdIF4gZmVhdHVyZXNbMF07Cj4gPiA+ICAgICAg
ICAgaWYgKGNoYW5nZWQgJiBORVRJRl9GX1RTTykgewo+ID4gPiAtICAgICAgICAgICAgICAgcmV0
ID0gaGluaWNfcG9ydF9zZXRfdHNvKG5pY19kZXYsIChmZWF0dXJlcyAmIE5FVElGX0ZfVFNPKSA/
Cj4gPiA+ICsgICAgICAgICAgICAgICByZXQgPSBoaW5pY19wb3J0X3NldF90c28obmljX2Rldiwg
KGZlYXR1cmVzWzBdICYgTkVUSUZfRl9UU08pID8KPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBISU5JQ19UU09fRU5BQkxFIDogSElOSUNfVFNPX0RJU0FCTEUp
Owo+ID4gPiAgICAgICAgICAgICAgICAgaWYgKHJldCkgewo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICBlcnIgPSByZXQ7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZF9m
ZWF0dXJlcyB8PSBORVRJRl9GX1RTTzsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmFp
bGVkX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfVFNPOwo+ID4gPiAgICAgICAgICAgICAgICAgfQo+
ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gQEAgLTEwOTQsMzMgKzEwOTYsMzQgQEAgc3RhdGlj
IGludCBzZXRfZmVhdHVyZXMoc3RydWN0IGhpbmljX2RldiAqbmljX2RldiwKPiA+ID4gICAgICAg
ICAgICAgICAgIHJldCA9IGhpbmljX3NldF9yeF9jc3VtX29mZmxvYWQobmljX2RldiwgY3N1bV9l
bik7Cj4gPiA+ICAgICAgICAgICAgICAgICBpZiAocmV0KSB7Cj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGVyciA9IHJldDsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVk
X2ZlYXR1cmVzIHw9IE5FVElGX0ZfUlhDU1VNOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICBmYWlsZWRfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9SWENTVU07Cj4gPiA+ICAgICAgICAgICAg
ICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAgICAgICAgIGlmIChjaGFuZ2VkICYg
TkVUSUZfRl9MUk8pIHsKPiA+ID4gICAgICAgICAgICAgICAgIHJldCA9IGhpbmljX3NldF9yeF9s
cm9fc3RhdGUobmljX2RldiwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgISEoZmVhdHVyZXMgJiBORVRJRl9GX0xSTyksCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEhKGZlYXR1cmVzWzBdICYgTkVUSUZf
Rl9MUk8pLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBISU5JQ19MUk9fUlhfVElNRVJfREVGQVVMVCwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgSElOSUNfTFJPX01BWF9XUUVfTlVNX0RFRkFVTFQpOwo+
ID4gPiAgICAgICAgICAgICAgICAgaWYgKHJldCkgewo+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICBlcnIgPSByZXQ7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZF9mZWF0
dXJlcyB8PSBORVRJRl9GX0xSTzsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVk
X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfTFJPOwo+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4g
PiAgICAgICAgIH0KPiA+ID4KPiA+ID4gICAgICAgICBpZiAoY2hhbmdlZCAmIE5FVElGX0ZfSFdf
VkxBTl9DVEFHX1JYKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICByZXQgPSBoaW5pY19zZXRfcnhf
dmxhbl9vZmZsb2FkKG5pY19kZXYsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICEhKGZlYXR1cmVzICYKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgISEoZmVhdHVyZXNbMF0gJgo+ID4gPiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0hX
X1ZMQU5fQ1RBR19SWCkpOwo+ID4gPiAgICAgICAgICAgICAgICAgaWYgKHJldCkgewo+ID4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSByZXQ7Cj4gPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgIGZhaWxlZF9mZWF0dXJlcyB8PSBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWDsKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSFdf
VkxBTl9DVEFHX1JYOwo+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4gPiAgICAgICAgIH0KPiA+
ID4KPiA+ID4gICAgICAgICBpZiAoZXJyKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICBuaWNfZGV2
LT5uZXRkZXYtPmZlYXR1cmVzID0gZmVhdHVyZXMgXiBmYWlsZWRfZmVhdHVyZXM7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfeG9yKG5pY19kZXYtPm5ldGRldi0+ZmVhdHVy
ZXMsIGZlYXR1cmVzLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm
YWlsZWRfZmVhdHVyZXMpCj4gPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTzsKPiA+ID4g
ICAgICAgICB9Cj4gPiA+Cj4gPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9o
dWF3ZWkvaGluaWMvaGluaWNfcnguYwo+ID4gPiBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2h1YXdl
aS9oaW5pYy9oaW5pY19yeC5jCj4gPiA+IGluZGV4IGZlZDNiNmIuLjQ1MmE5MWIgMTAwNjQ0Cj4g
PiA+IC0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2h1YXdlaS9oaW5pYy9oaW5pY19yeC5jCj4g
PiA+ICsrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L2h1YXdlaS9oaW5pYy9oaW5pY19yeC5jCj4g
PiA+IEBAIC0xMDYsNyArMTA2LDcgQEAgc3RhdGljIHZvaWQgcnhfY3N1bShzdHJ1Y3QgaGluaWNf
cnhxICpyeHEsIHUzMiBzdGF0dXMsCj4gPiA+Cj4gPiA+ICAgICAgICAgY3N1bV9lcnIgPSBISU5J
Q19SUV9DUUVfU1RBVFVTX0dFVChzdGF0dXMsIENTVU1fRVJSKTsKPiA+ID4KPiA+ID4gLSAgICAg
ICBpZiAoIShuZXRkZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9SWENTVU0pKQo+ID4gPiArICAgICAg
IGlmICghKG5ldGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX1JYQ1NVTSkpCj4gPiA+ICAgICAg
ICAgICAgICAgICByZXR1cm47Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKCFjc3VtX2Vycikgewo+
ID4gPiBAQCAtNDExLDcgKzQxMSw3IEBAIHN0YXRpYyBpbnQgcnhxX3JlY3Yoc3RydWN0IGhpbmlj
X3J4cSAqcnhxLCBpbnQgYnVkZ2V0KQo+ID4gPgo+ID4gPiAgICAgICAgICAgICAgICAgb2ZmbG9h
ZF90eXBlID0gYmUzMl90b19jcHUoY3FlLT5vZmZsb2FkX3R5cGUpOwo+ID4gPiAgICAgICAgICAg
ICAgICAgdmxhbl9sZW4gPSBiZTMyX3RvX2NwdShjcWUtPmxlbik7Cj4gPiA+IC0gICAgICAgICAg
ICAgICBpZiAoKG5ldGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCkgJiYK
PiA+ID4gKyAgICAgICAgICAgICAgIGlmICgobmV0ZGV2LT5mZWF0dXJlc1swXSAmIE5FVElGX0Zf
SFdfVkxBTl9DVEFHX1JYKSAmJgo+ID4gPiAgICAgICAgICAgICAgICAgICAgIEhJTklDX0dFVF9S
WF9WTEFOX09GRkxPQURfRU4ob2ZmbG9hZF90eXBlKSkgewo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICB2aWQgPSBISU5JQ19HRVRfUlhfVkxBTl9UQUcodmxhbl9sZW4pOwo+ID4gPiAgICAg
ICAgICAgICAgICAgICAgICAgICBfX3ZsYW5faHdhY2NlbF9wdXRfdGFnKHNrYiwgaHRvbnMoRVRI
X1BfODAyMVEpLCB2aWQpOwo+ID4gPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9pZl92bGFu
LmggYi9pbmNsdWRlL2xpbnV4L2lmX3ZsYW4uaAo+ID4gPiBpbmRleCA0MWE1MTgzLi40MTczNDY0
IDEwMDY0NAo+ID4gPiAtLS0gYS9pbmNsdWRlL2xpbnV4L2lmX3ZsYW4uaAo+ID4gPiArKysgYi9p
bmNsdWRlL2xpbnV4L2lmX3ZsYW4uaAo+ID4gPiBAQCAtNTYzLDcgKzU2Myw3IEBAIHN0YXRpYyBp
bmxpbmUgaW50IF9fdmxhbl9od2FjY2VsX2dldF90YWcoY29uc3QKPiA+ID4gc3RydWN0IHNrX2J1
ZmYgKnNrYiwKPiA+ID4gICAqLwo+ID4gPiAgc3RhdGljIGlubGluZSBpbnQgdmxhbl9nZXRfdGFn
KGNvbnN0IHN0cnVjdCBza19idWZmICpza2IsIHUxNiAqdmxhbl90Y2kpCj4gPiA+ICB7Cj4gPiA+
IC0gICAgICAgaWYgKHNrYi0+ZGV2LT5mZWF0dXJlcyAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RY
KSB7Cj4gPiA+ICsgICAgICAgaWYgKHNrYi0+ZGV2LT5mZWF0dXJlc1swXSAmIE5FVElGX0ZfSFdf
VkxBTl9DVEFHX1RYKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gX192bGFuX2h3YWNj
ZWxfZ2V0X3RhZyhza2IsIHZsYW5fdGNpKTsKPiA+ID4gICAgICAgICB9IGVsc2Ugewo+ID4gPiAg
ICAgICAgICAgICAgICAgcmV0dXJuIF9fdmxhbl9nZXRfdGFnKHNrYiwgdmxhbl90Y2kpOwo+ID4g
PiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9uZXRkZXZfZmVhdHVyZXMuaCBiL2luY2x1ZGUv
bGludXgvbmV0ZGV2X2ZlYXR1cmVzLmgKPiA+ID4gaW5kZXggMmM2YjllNC4uOTE4NDk2MyAxMDA2
NDQKPiA+ID4gLS0tIGEvaW5jbHVkZS9saW51eC9uZXRkZXZfZmVhdHVyZXMuaAo+ID4gPiArKysg
Yi9pbmNsdWRlL2xpbnV4L25ldGRldl9mZWF0dXJlcy5oCj4gPiA+IEBAIC0xMDIsNyArMTAyLDgg
QEAgZW51bSB7Cj4gPiA+ICB9Owo+ID4gPgo+ID4gPiAgLyogY29weSduJ3Bhc3RlIGNvbXByZXNz
aW9uIDspICovCj4gPiA+IC0jZGVmaW5lIF9fTkVUSUZfRl9CSVQoYml0KSAgICAgKChuZXRkZXZf
ZmVhdHVyZXNfdCkxIDw8IChiaXQpKQo+ID4gPiArI2RlZmluZSBfX05FVElGX0ZfQklUKGJpdCkg
ICAgICgobmV0ZGV2X2ZlYXR1cmVzX3QpMSA8PCAoYml0ICYgMHgzRikpCj4gPiA+ICsKPiA+ID4g
ICNkZWZpbmUgX19ORVRJRl9GKG5hbWUpICAgICAgICAgICAgICAgIF9fTkVUSUZfRl9CSVQoTkVU
SUZfRl8jI25hbWUjI19CSVQpCj4gPiA+Cj4gPiA+ICAjZGVmaW5lIE5FVElGX0ZfRkNPRV9DUkMg
ICAgICAgX19ORVRJRl9GKEZDT0VfQ1JDKQo+ID4gPiBAQCAtMTY5LDYgKzE3MCw4IEBAIGVudW0g
ewo+ID4gPiAgI2RlZmluZSBORVRJRl9GX0hXX0hTUl9GV0QgICAgIF9fTkVUSUZfRihIV19IU1Jf
RldEKQo+ID4gPiAgI2RlZmluZSBORVRJRl9GX0hXX0hTUl9EVVAgICAgIF9fTkVUSUZfRihIV19I
U1JfRFVQKQo+ID4gPgo+ID4gPiArI2RlZmluZSBORVRERVZfRkVBVFVSRV9EV09SRFMgIERJVl9S
T1VORF9VUChORVRERVZfRkVBVFVSRV9DT1VOVCwgNjQpCj4gPiA+ICsKPiA+ID4gIC8qIEZpbmRz
IHRoZSBuZXh0IGZlYXR1cmUgd2l0aCB0aGUgaGlnaGVzdCBudW1iZXIgb2YgdGhlIHJhbmdlIG9m
IHN0YXJ0IHRpbGwgMC4KPiA+ID4gICAqLwo+ID4gPiAgc3RhdGljIGlubGluZSBpbnQgZmluZF9u
ZXh0X25ldGRldl9mZWF0dXJlKHU2NCBmZWF0dXJlLCB1bnNpZ25lZCBsb25nIHN0YXJ0KQo+ID4g
PiBAQCAtMTg1LDggKzE4OCw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IGZpbmRfbmV4dF9uZXRkZXZf
ZmVhdHVyZSh1NjQKPiA+ID4gZmVhdHVyZSwgdW5zaWduZWQgbG9uZyBzdGFydCkKPiA+ID4gICAq
IG1hc2tfYWRkciBzaG91bGQgYmUgYSB1NjQgYW5kIGJpdCBhbiBpbnQKPiA+ID4gICAqLwo+ID4g
PiAgI2RlZmluZSBmb3JfZWFjaF9uZXRkZXZfZmVhdHVyZShtYXNrX2FkZHIsIGJpdCkKPiA+ID4g
ICAgICAgICAgXAo+ID4gPiAtICAgICAgIGZvciAoKGJpdCkgPSBmaW5kX25leHRfbmV0ZGV2X2Zl
YXR1cmUoKG1hc2tfYWRkciksICAgICAgICAgICAgICBcCj4gPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRERVZfRkVBVFVSRV9DT1VOVCk7ICAgIFwK
PiA+ID4gKyAgICAgICBmb3IgKChiaXQpID0gZmluZF9uZXh0X25ldGRldl9mZWF0dXJlKChtYXNr
X2FkZHIpLCA2NCk7ICAgICAgICAgXAo+ID4gPiAgICAgICAgICAgICAgKGJpdCkgPj0gMDsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4gPiA+ICAgICAg
ICAgICAgICAoYml0KSA9IGZpbmRfbmV4dF9uZXRkZXZfZmVhdHVyZSgobWFza19hZGRyKSwgKGJp
dCkgLSAxKSkKPiA+ID4KPiA+ID4gQEAgLTE5NSwxMSArMTk3LDYgQEAgc3RhdGljIGlubGluZSBp
bnQgZmluZF9uZXh0X25ldGRldl9mZWF0dXJlKHU2NAo+ID4gPiBmZWF0dXJlLCB1bnNpZ25lZCBs
b25nIHN0YXJ0KQo+ID4gPiAgI2RlZmluZSBORVRJRl9GX05FVkVSX0NIQU5HRSAgIChORVRJRl9G
X1ZMQU5fQ0hBTExFTkdFRCB8IFwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgTkVUSUZfRl9MTFRYIHwgTkVUSUZfRl9ORVROU19MT0NBTCkKPiA+ID4KPiA+ID4gLS8qIHJl
bWVtYmVyIHRoYXQgKCh0KTEgPDwgdF9CSVRTKSBpcyB1bmRlZmluZWQgaW4gQzk5ICovCj4gPiA+
IC0jZGVmaW5lIE5FVElGX0ZfRVRIVE9PTF9CSVRTICAgKChfX05FVElGX0ZfQklUKE5FVERFVl9G
RUFUVVJFX0NPVU5UIC0gMSkgfCBcCj4gPiA+IC0gICAgICAgICAgICAgICAoX19ORVRJRl9GX0JJ
VChORVRERVZfRkVBVFVSRV9DT1VOVCAtIDEpIC0gMSkpICYgXAo+ID4gPiAtICAgICAgICAgICAg
ICAgfk5FVElGX0ZfTkVWRVJfQ0hBTkdFKQo+ID4gPiAtCj4gPiA+ICAvKiBTZWdtZW50YXRpb24g
b2ZmbG9hZCBmZWF0dXJlIG1hc2sgKi8KPiA+ID4gICNkZWZpbmUgTkVUSUZfRl9HU09fTUFTSyAg
ICAgICAoX19ORVRJRl9GX0JJVChORVRJRl9GX0dTT19MQVNUICsgMSkgLSBcCj4gPiA+ICAgICAg
ICAgICAgICAgICBfX05FVElGX0ZfQklUKE5FVElGX0ZfR1NPX1NISUZUKSkKPiA+ID4gQEAgLTI2
MSw0ICsyNTgsOTYgQEAgc3RhdGljIGlubGluZSBpbnQgZmluZF9uZXh0X25ldGRldl9mZWF0dXJl
KHU2NAo+ID4gPiBmZWF0dXJlLCB1bnNpZ25lZCBsb25nIHN0YXJ0KQo+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19VRFBfVFVOTkVMIHwgICAgICAgICAg
ICAgICBcCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfR1NP
X1VEUF9UVU5ORUxfQ1NVTSkKPiA+ID4KPiA+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBuZXRkZXZf
ZmVhdHVyZXNfY29weShuZXRkZXZfZmVhdHVyZXNfdCAqZHN0LAo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV0ZGV2X2ZlYXR1cmVzX3QgKnNyYykK
PiA+ID4gK3sKPiA+ID4gKyAgICAgICB1bnNpZ25lZCBpbnQgaTsKPiA+ID4gKwo+ID4gPiArICAg
ICAgIGZvciAoaSA9IDA7IGkgPCBORVRERVZfRkVBVFVSRV9EV09SRFM7IGkrKykKPiA+ID4gKyAg
ICAgICAgICAgICAgIGRzdFtpXSA9IHNyY1tpXTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3Rh
dGljIGlubGluZSB2b2lkIG5ldGRldl9mZWF0dXJlc19hbmQobmV0ZGV2X2ZlYXR1cmVzX3QgKmRz
dCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV0
ZGV2X2ZlYXR1cmVzX3QgKmEsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IG5ldGRldl9mZWF0dXJlc190ICpiKQo+ID4gPiArewo+ID4gPiArICAgICAg
IHVuc2lnbmVkIGludCBpOwo+ID4gPiArCj4gPiA+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5F
VERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+ID4gPiArICAgICAgICAgICAgICAgZHN0W2ldID0g
YVtpXSAmIGJbaV07Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBu
ZXRkZXZfZmVhdHVyZXNfYW5kbm90KG5ldGRldl9mZWF0dXJlc190ICpkc3QsCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ldGRldl9mZWF0dXJl
c190ICphLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBuZXRkZXZfZmVhdHVyZXNfdCAqYikKPiA+ID4gK3sKPiA+ID4gKyAgICAgICB1bnNpZ25l
ZCBpbnQgaTsKPiA+ID4gKwo+ID4gPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBORVRERVZfRkVB
VFVSRV9EV09SRFM7IGkrKykKPiA+ID4gKyAgICAgICAgICAgICAgIGRzdFtpXSA9IGFbaV0gJiB+
YltpXTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIGlubGluZSB2b2lkIG5ldGRldl9m
ZWF0dXJlc19vcihuZXRkZXZfZmVhdHVyZXNfdCAqZHN0LAo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ldGRldl9mZWF0dXJlc190ICphLAo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ldGRldl9mZWF0dXJl
c190ICpiKQo+ID4gPiArewo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPiArCj4g
PiA+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+
ID4gPiArICAgICAgICAgICAgICAgZHN0W2ldID0gYVtpXSB8IGJbaV07Cj4gPiA+ICt9Cj4gPiA+
ICsKPiA+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBuZXRkZXZfZmVhdHVyZXNfeG9yKG5ldGRldl9m
ZWF0dXJlc190ICpkc3QsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNvbnN0IG5ldGRldl9mZWF0dXJlc190ICphLAo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXRkZXZfZmVhdHVyZXNfdCAqYikKPiA+ID4gK3sK
PiA+ID4gKyAgICAgICB1bnNpZ25lZCBpbnQgaTsKPiA+ID4gKwo+ID4gPiArICAgICAgIGZvciAo
aSA9IDA7IGkgPCBORVRERVZfRkVBVFVSRV9EV09SRFM7IGkrKykKPiA+ID4gKyAgICAgICAgICAg
ICAgIGRzdFtpXSA9IGFbaV0gXiBiW2ldOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMg
aW5saW5lIHZvaWQgbmV0ZGV2X2ZlYXR1cmVzX3NldChuZXRkZXZfZmVhdHVyZXNfdCAqZHN0LAo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBpbnQg
Yml0KQo+ID4gPiArewo+ID4gPiArICAgICAgIGRzdFtiaXQgLyA2NF0gfD0gX19ORVRJRl9GX0JJ
VChiaXQpOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW5saW5lIGJvb2wgbmV0ZGV2
X2ZlYXR1cmVzX2VxdWFsKGNvbnN0IG5ldGRldl9mZWF0dXJlc190ICphLAo+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ldGRldl9mZWF0dXJlc190
ICpiKQo+ID4gPiArewo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPiArCj4gPiA+
ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+ID4g
PiArICAgICAgICAgICAgICAgaWYgKGFbaV0gIT0gYltpXSkKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIGZhbHNlOwo+ID4gPiArCj4gPiA+ICsgICAgICAgcmV0dXJuIHRydWU7
Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBuZXRkZXZfZmVhdHVy
ZXNfZW1wdHkobmV0ZGV2X2ZlYXR1cmVzX3QgKnNyYykKPiA+ID4gK3sKPiA+ID4gKyAgICAgICB1
bnNpZ25lZCBpbnQgaTsKPiA+ID4gKwo+ID4gPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBORVRE
RVZfRkVBVFVSRV9EV09SRFM7IGkrKykKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChzcmNbaV0p
Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKPiA+ID4gKwo+ID4g
PiArICAgICAgIHJldHVybiB0cnVlOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW5s
aW5lIHZvaWQgbmV0ZGV2X2ZlYXR1cmVzX2V0aHRvb2xfYml0cyhuZXRkZXZfZmVhdHVyZXNfdCAq
ZHN0KQo+ID4gPiArewo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPiArCj4gPiA+
ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKSB7Cj4g
PiA+ICsgICAgICAgICAgICAgICBpZiAoTkVUREVWX0ZFQVRVUkVfQ09VTlQgPj0gKGkgKyAxKSAq
IDY0KQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBkc3RbaV0gPSBHRU5NQVNLX1VMTCg2
MywgMCk7Cj4gPiA+ICsgICAgICAgICAgICAgICBlbHNlCj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGRzdFtpXSA9IEdFTk1BU0tfVUxMKE5FVERFVl9GRUFUVVJFX0NPVU5UIC0gaSAqIDY0
LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDApOwo+ID4gPiArICAgICAgIH0KPiA+ID4gKyAgICAgICBkc3RbMF0gJj0gfk5FVElGX0ZfTkVW
RVJfQ0hBTkdFOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICAjZW5kaWYgLyogX0xJTlVYX05FVERF
Vl9GRUFUVVJFU19IICovCj4gPiA+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L25ldGRldmlj
ZS5oIGIvaW5jbHVkZS9saW51eC9uZXRkZXZpY2UuaAo+ID4gPiBpbmRleCBlYWY1YmIwLi40YTI5
NDg3IDEwMDY0NAo+ID4gPiAtLS0gYS9pbmNsdWRlL2xpbnV4L25ldGRldmljZS5oCj4gPiA+ICsr
KyBiL2luY2x1ZGUvbGludXgvbmV0ZGV2aWNlLmgKPiA+ID4gQEAgLTEzNDcsOSArMTM0Nyw5IEBA
IHN0cnVjdCBuZXRfZGV2aWNlX29wcyB7Cj4gPiA+ICAgICAgICAgaW50ICAgICAgICAgICAgICAg
ICAgICAgKCpuZG9fc3RvcCkoc3RydWN0IG5ldF9kZXZpY2UgKmRldik7Cj4gPiA+ICAgICAgICAg
bmV0ZGV2X3R4X3QgICAgICAgICAgICAgKCpuZG9fc3RhcnRfeG1pdCkoc3RydWN0IHNrX2J1ZmYg
KnNrYiwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVy
ZXNfdCAgICAgICAoKm5kb19mZWF0dXJlc19jaGVjaykoc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+
ID4gKyAgICAgICB2b2lkICAgICAgICAgICAgICAgICAgICAoKm5kb19mZWF0dXJlc19jaGVjayko
c3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gLQo+
ID4gPiBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcyk7Cj4gPiA+ICsKPiA+ID4gbmV0ZGV2X2Zl
YXR1cmVzX3QgKmZlYXR1cmVzKTsKPiA+ID4gICAgICAgICB1MTYgICAgICAgICAgICAgICAgICAg
ICAoKm5kb19zZWxlY3RfcXVldWUpKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2tf
YnVmZiAqc2tiLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKnNiX2Rldik7Cj4gPiA+IEBAIC0xNDY3LDEw
ICsxNDY3LDEwIEBAIHN0cnVjdCBuZXRfZGV2aWNlX29wcyB7Cj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgYWxsX3NsYXZlcyk7
Cj4gPiA+ICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UqICAgICAgKCpuZG9fc2tfZ2V0X2xvd2Vy
X2Rldikoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc29jayAqc2spOwo+ID4g
PiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190ICAgICAgICgqbmRvX2ZpeF9mZWF0dXJlcykoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzKTsKPiA+ID4g
KyAgICAgICB2b2lkICAgICAgICAgICAgICAgICAgICAoKm5kb19maXhfZmVhdHVyZXMpKHN0cnVj
dCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdAo+ID4gPiAqZmVhdHVyZXMpOwo+
ID4gPiAgICAgICAgIGludCAgICAgICAgICAgICAgICAgICAgICgqbmRvX3NldF9mZWF0dXJlcyko
c3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzKTsKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5l
dGRldl9mZWF0dXJlc190Cj4gPiA+ICpmZWF0dXJlcyk7Cj4gPiA+ICAgICAgICAgaW50ICAgICAg
ICAgICAgICAgICAgICAgKCpuZG9fbmVpZ2hfY29uc3RydWN0KShzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2LAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IG5laWdoYm91ciAqbik7Cj4gPiA+ICAgICAgICAgdm9pZCAgICAgICAg
ICAgICAgICAgICAgKCpuZG9fbmVpZ2hfZGVzdHJveSkoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwK
PiA+ID4gQEAgLTE5NzgsMTIgKzE5NzgsMTIgQEAgc3RydWN0IG5ldF9kZXZpY2Ugewo+ID4gPiAg
ICAgICAgIHVuc2lnbmVkIHNob3J0ICAgICAgICAgIG5lZWRlZF9oZWFkcm9vbTsKPiA+ID4gICAg
ICAgICB1bnNpZ25lZCBzaG9ydCAgICAgICAgICBuZWVkZWRfdGFpbHJvb207Cj4gPiA+Cj4gPiA+
IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgICAgICAgZmVhdHVyZXM7Cj4gPiA+IC0gICAgICAg
bmV0ZGV2X2ZlYXR1cmVzX3QgICAgICAgaHdfZmVhdHVyZXM7Cj4gPiA+IC0gICAgICAgbmV0ZGV2
X2ZlYXR1cmVzX3QgICAgICAgd2FudGVkX2ZlYXR1cmVzOwo+ID4gPiAtICAgICAgIG5ldGRldl9m
ZWF0dXJlc190ICAgICAgIHZsYW5fZmVhdHVyZXM7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX3QgICAgICAgaHdfZW5jX2ZlYXR1cmVzOwo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJl
c190ICAgICAgIG1wbHNfZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3Qg
ICAgICAgZmVhdHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4gKyAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfdCAgICAgICBod19mZWF0dXJlc1tORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+
ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190ICAgICAgIHdhbnRlZF9mZWF0dXJlc1tORVRE
RVZfRkVBVFVSRV9EV09SRFNdOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190ICAgICAg
IHZsYW5fZmVhdHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4gKyAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfdCAgICAgICBod19lbmNfZmVhdHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRT
XTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAgICAgICBtcGxzX2ZlYXR1cmVzW05F
VERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+ICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgICAg
ICAgZ3NvX3BhcnRpYWxfZmVhdHVyZXM7Cj4gPiA+Cj4gPiA+ICAgICAgICAgdW5zaWduZWQgaW50
ICAgICAgICAgICAgbWluX210dTsKPiA+ID4gQEAgLTQ5ODYsMTAgKzQ5ODYsMTEgQEAgc3RhdGlj
IGlubGluZSBuZXRkZXZfZmVhdHVyZXNfdAo+ID4gPiBuZXRkZXZfaW50ZXJzZWN0X2ZlYXR1cmVz
KG5ldGRldl9mZWF0dXJlc190IGYxLAo+ID4gPiAgICAgICAgIHJldHVybiBmMSAmIGYyOwo+ID4g
PiAgfQo+ID4gPgo+ID4gPiAtc3RhdGljIGlubGluZSBuZXRkZXZfZmVhdHVyZXNfdCBuZXRkZXZf
Z2V0X3dhbnRlZF9mZWF0dXJlcygKPiA+ID4gLSAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
KQo+ID4gPiArc3RhdGljIGlubGluZSB2b2lkIG5ldGRldl9nZXRfd2FudGVkX2ZlYXR1cmVzKHN0
cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAqd2FudGVkKQo+ID4gPiAgewo+ID4g
PiAtICAgICAgIHJldHVybiAoZGV2LT5mZWF0dXJlcyAmIH5kZXYtPmh3X2ZlYXR1cmVzKSB8IGRl
di0+d2FudGVkX2ZlYXR1cmVzOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc19hbmRub3Qo
d2FudGVkLCBkZXYtPmZlYXR1cmVzLCBkZXYtPmh3X2ZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICBu
ZXRkZXZfZmVhdHVyZXNfb3Iod2FudGVkLCB3YW50ZWQsIGRldi0+d2FudGVkX2ZlYXR1cmVzKTsK
PiA+ID4gIH0KPiA+ID4gIG5ldGRldl9mZWF0dXJlc190IG5ldGRldl9pbmNyZW1lbnRfZmVhdHVy
ZXMobmV0ZGV2X2ZlYXR1cmVzX3QgYWxsLAo+ID4gPiAgICAgICAgIG5ldGRldl9mZWF0dXJlc190
IG9uZSwgbmV0ZGV2X2ZlYXR1cmVzX3QgbWFzayk7Cj4gPiA+IEBAIC01MDE0LDcgKzUwMTUsNyBA
QCB2b2lkIG5ldGlmX3N0YWNrZWRfdHJhbnNmZXJfb3BlcnN0YXRlKGNvbnN0Cj4gPiA+IHN0cnVj
dCBuZXRfZGV2aWNlICpyb290ZGV2LAo+ID4gPiAgbmV0ZGV2X2ZlYXR1cmVzX3QgcGFzc3RocnVf
ZmVhdHVyZXNfY2hlY2soc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVz
X3QgZmVhdHVyZXMpOwo+ID4gPiAtbmV0ZGV2X2ZlYXR1cmVzX3QgbmV0aWZfc2tiX2ZlYXR1cmVz
KHN0cnVjdCBza19idWZmICpza2IpOwo+ID4gPiArdm9pZCBuZXRpZl9za2JfZmVhdHVyZXMoc3Ry
dWN0IHNrX2J1ZmYgKnNrYiwgbmV0ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1cmVzKTsKPiA+ID4KPiA+
ID4gIHN0YXRpYyBpbmxpbmUgYm9vbCBuZXRfZ3NvX29rKG5ldGRldl9mZWF0dXJlc190IGZlYXR1
cmVzLCBpbnQgZ3NvX3R5cGUpCj4gPiA+ICB7Cj4gPiA+IGRpZmYgLS1naXQgYS9uZXQvODAyMXEv
dmxhbi5jIGIvbmV0LzgwMjFxL3ZsYW4uYwo+ID4gPiBpbmRleCA0Y2RmODQxLi43ZDc3NjkyIDEw
MDY0NAo+ID4gPiAtLS0gYS9uZXQvODAyMXEvdmxhbi5jCj4gPiA+ICsrKyBiL25ldC84MDIxcS92
bGFuLmMKPiA+ID4gQEAgLTMyOCw3ICszMjgsNyBAQCBzdGF0aWMgdm9pZCB2bGFuX3RyYW5zZmVy
X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICAgICAgICAgdmxhbmRldi0+
Z3NvX21heF9zaXplID0gZGV2LT5nc29fbWF4X3NpemU7Cj4gPiA+ICAgICAgICAgdmxhbmRldi0+
Z3NvX21heF9zZWdzID0gZGV2LT5nc29fbWF4X3NlZ3M7Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYg
KHZsYW5faHdfb2ZmbG9hZF9jYXBhYmxlKGRldi0+ZmVhdHVyZXMsIHZsYW4tPnZsYW5fcHJvdG8p
KQo+ID4gPiArICAgICAgIGlmICh2bGFuX2h3X29mZmxvYWRfY2FwYWJsZShkZXYtPmZlYXR1cmVz
WzBdLCB2bGFuLT52bGFuX3Byb3RvKSkKPiA+ID4gICAgICAgICAgICAgICAgIHZsYW5kZXYtPmhh
cmRfaGVhZGVyX2xlbiA9IGRldi0+aGFyZF9oZWFkZXJfbGVuOwo+ID4gPiAgICAgICAgIGVsc2UK
PiA+ID4gICAgICAgICAgICAgICAgIHZsYW5kZXYtPmhhcmRfaGVhZGVyX2xlbiA9IGRldi0+aGFy
ZF9oZWFkZXJfbGVuICsgVkxBTl9ITEVOOwo+ID4gPiBAQCAtMzM5LDcgKzMzOSw3IEBAIHN0YXRp
YyB2b2lkIHZsYW5fdHJhbnNmZXJfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+
ID4KPiA+ID4gICAgICAgICB2bGFuZGV2LT5wcml2X2ZsYWdzICY9IH5JRkZfWE1JVF9EU1RfUkVM
RUFTRTsKPiA+ID4gICAgICAgICB2bGFuZGV2LT5wcml2X2ZsYWdzIHw9ICh2bGFuLT5yZWFsX2Rl
di0+cHJpdl9mbGFncyAmCj4gPiA+IElGRl9YTUlUX0RTVF9SRUxFQVNFKTsKPiA+ID4gLSAgICAg
ICB2bGFuZGV2LT5od19lbmNfZmVhdHVyZXMgPSB2bGFuX3RubF9mZWF0dXJlcyh2bGFuLT5yZWFs
X2Rldik7Cj4gPiA+ICsgICAgICAgdmxhbmRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdID0gdmxhbl90
bmxfZmVhdHVyZXModmxhbi0+cmVhbF9kZXYpOwo+ID4gPgo+ID4gPiAgICAgICAgIG5ldGRldl91
cGRhdGVfZmVhdHVyZXModmxhbmRldik7Cj4gPiA+ICB9Cj4gPiA+IGRpZmYgLS1naXQgYS9uZXQv
ODAyMXEvdmxhbi5oIGIvbmV0LzgwMjFxL3ZsYW4uaAo+ID4gPiBpbmRleCAxYTcwNWE0Li40ZTc4
NGExIDEwMDY0NAo+ID4gPiAtLS0gYS9uZXQvODAyMXEvdmxhbi5oCj4gPiA+ICsrKyBiL25ldC84
MDIxcS92bGFuLmgKPiA+ID4gQEAgLTEwNyw3ICsxMDcsNyBAQCBzdGF0aWMgaW5saW5lIG5ldGRl
dl9mZWF0dXJlc190Cj4gPiA+IHZsYW5fdG5sX2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpy
ZWFsX2RldikKPiA+ID4gIHsKPiA+ID4gICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCByZXQ7Cj4g
PiA+Cj4gPiA+IC0gICAgICAgcmV0ID0gcmVhbF9kZXYtPmh3X2VuY19mZWF0dXJlcyAmCj4gPiA+
ICsgICAgICAgcmV0ID0gcmVhbF9kZXYtPmh3X2VuY19mZWF0dXJlc1swXSAmCj4gPiA+ICAgICAg
ICAgICAgICAgKE5FVElGX0ZfQ1NVTV9NQVNLIHwgTkVUSUZfRl9HU09fU09GVFdBUkUgfAo+ID4g
PiAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19FTkNBUF9BTEwpOwo+ID4gPgo+ID4gPiBkaWZm
IC0tZ2l0IGEvbmV0LzgwMjFxL3ZsYW5fZGV2LmMgYi9uZXQvODAyMXEvdmxhbl9kZXYuYwo+ID4g
PiBpbmRleCBhMDM2N2IzLi42ZDQ5NzYxIDEwMDY0NAo+ID4gPiAtLS0gYS9uZXQvODAyMXEvdmxh
bl9kZXYuYwo+ID4gPiArKysgYi9uZXQvODAyMXEvdmxhbl9kZXYuYwo+ID4gPiBAQCAtNTY2LDIx
ICs1NjYsMjEgQEAgc3RhdGljIGludCB2bGFuX2Rldl9pbml0KHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYpCj4gPiA+ICAgICAgICAgaWYgKHZsYW4tPmZsYWdzICYgVkxBTl9GTEFHX0JSSURHRV9CSU5E
SU5HKQo+ID4gPiAgICAgICAgICAgICAgICAgZGV2LT5zdGF0ZSB8PSAoMSA8PCBfX0xJTktfU1RB
VEVfTk9DQVJSSUVSKTsKPiA+ID4KPiA+ID4gLSAgICAgICBkZXYtPmh3X2ZlYXR1cmVzID0gTkVU
SUZfRl9IV19DU1VNIHwgTkVUSUZfRl9TRyB8Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgIE5FVElGX0ZfRlJBR0xJU1QgfCBORVRJRl9GX0dTT19TT0ZUV0FSRSB8Cj4gPiA+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfR1NPX0VOQ0FQX0FMTCB8Cj4gPiA+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfSElHSERNQSB8IE5FVElGX0ZfU0NUUF9DUkMg
fAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0FMTF9GQ09FOwo+ID4g
PiArICAgICAgIGRldi0+aHdfZmVhdHVyZXNbMF0gPSBORVRJRl9GX0hXX0NTVU0gfCBORVRJRl9G
X1NHIHwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9GUkFHTElT
VCB8IE5FVElGX0ZfR1NPX1NPRlRXQVJFIHwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgTkVUSUZfRl9HU09fRU5DQVBfQUxMIHwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgTkVUSUZfRl9ISUdIRE1BIHwgTkVUSUZfRl9TQ1RQX0NSQyB8Cj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfQUxMX0ZDT0U7Cj4gPiA+Cj4gPiA+IC0g
ICAgICAgZGV2LT5mZWF0dXJlcyB8PSBkZXYtPmh3X2ZlYXR1cmVzIHwgTkVUSUZfRl9MTFRYOwo+
ID4gPiArICAgICAgIGRldi0+ZmVhdHVyZXNbMF0gfD0gZGV2LT5od19mZWF0dXJlc1swXSB8IE5F
VElGX0ZfTExUWDsKPiA+ID4gICAgICAgICBkZXYtPmdzb19tYXhfc2l6ZSA9IHJlYWxfZGV2LT5n
c29fbWF4X3NpemU7Cj4gPiA+ICAgICAgICAgZGV2LT5nc29fbWF4X3NlZ3MgPSByZWFsX2Rldi0+
Z3NvX21heF9zZWdzOwo+ID4gPiAtICAgICAgIGlmIChkZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9W
TEFOX0ZFQVRVUkVTKQo+ID4gPiArICAgICAgIGlmIChkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZf
Rl9WTEFOX0ZFQVRVUkVTKQo+ID4gPiAgICAgICAgICAgICAgICAgbmV0ZGV2X3dhcm4ocmVhbF9k
ZXYsICJWTEFOIGZlYXR1cmVzIGFyZSBzZXQKPiA+ID4gaW5jb3JyZWN0bHkuICBRLWluLVEgY29u
ZmlndXJhdGlvbnMgbWF5IG5vdCB3b3JrIGNvcnJlY3RseS5cbiIpOwo+ID4gPgo+ID4gPiAtICAg
ICAgIGRldi0+dmxhbl9mZWF0dXJlcyA9IHJlYWxfZGV2LT52bGFuX2ZlYXR1cmVzICYgfk5FVElG
X0ZfQUxMX0ZDT0U7Cj4gPiA+IC0gICAgICAgZGV2LT5od19lbmNfZmVhdHVyZXMgPSB2bGFuX3Ru
bF9mZWF0dXJlcyhyZWFsX2Rldik7Cj4gPiA+IC0gICAgICAgZGV2LT5tcGxzX2ZlYXR1cmVzID0g
cmVhbF9kZXYtPm1wbHNfZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgZGV2LT52bGFuX2ZlYXR1cmVz
WzBdID0gcmVhbF9kZXYtPnZsYW5fZmVhdHVyZXNbMF0gJiB+TkVUSUZfRl9BTExfRkNPRTsKPiA+
ID4gKyAgICAgICBkZXYtPmh3X2VuY19mZWF0dXJlc1swXSA9IHZsYW5fdG5sX2ZlYXR1cmVzKHJl
YWxfZGV2KTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfY29weShkZXYtPm1wbHNfZmVh
dHVyZXMsIHJlYWxfZGV2LT5tcGxzX2ZlYXR1cmVzKTsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBp
cHY2IHNoYXJlZCBjYXJkIHJlbGF0ZWQgc3R1ZmYgKi8KPiA+ID4gICAgICAgICBkZXYtPmRldl9p
ZCA9IHJlYWxfZGV2LT5kZXZfaWQ7Cj4gPiA+IEBAIC02MzMsMjcgKzYzMywzMCBAQCB2b2lkIHZs
YW5fZGV2X3VuaW5pdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgICAgICAgIH0KPiA+
ID4gIH0KPiA+ID4KPiA+ID4gLXN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdCB2bGFuX2Rldl9maXhf
ZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVh
dHVyZXNfdCBmZWF0dXJlcykKPiA+ID4gK3N0YXRpYyB2b2lkIHZsYW5fZGV2X2ZpeF9mZWF0dXJl
cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1cmVzKQo+ID4gPiAgewo+ID4gPiAgICAg
ICAgIHN0cnVjdCBuZXRfZGV2aWNlICpyZWFsX2RldiA9IHZsYW5fZGV2X3ByaXYoZGV2KS0+cmVh
bF9kZXY7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3Qgb2xkX2ZlYXR1cmVzID0gZmVh
dHVyZXM7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgbG93ZXJfZmVhdHVyZXM7Cj4g
PiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgbG93ZXJfZmVhdHVyZXNbTkVUREVWX0ZFQVRV
UkVfRFdPUkRTXTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBvbGRfZmVhdHVyZXNb
TkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4KPiA+ID4gLSAgICAgICBsb3dlcl9mZWF0dXJl
cyA9IG5ldGRldl9pbnRlcnNlY3RfZmVhdHVyZXMoKHJlYWxfZGV2LT52bGFuX2ZlYXR1cmVzIHwK
PiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IE5FVElGX0ZfUlhDU1VNKSwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcmVhbF9kZXYtPmZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfY29weShsb3dlcl9mZWF0dXJlcywgZmVhdHVyZXMpOwo+ID4gPiArCj4gPiA+
ICsgICAgICAgbG93ZXJfZmVhdHVyZXNbMF0gPQo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2
X2ludGVyc2VjdF9mZWF0dXJlcygocmVhbF9kZXYtPnZsYW5fZmVhdHVyZXNbMF0gfAo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9SWENTVU0p
LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFsX2Rl
di0+ZmVhdHVyZXNbMF0pOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIEFkZCBIV19DU1VNIHNldHRp
bmcgdG8gcHJlc2VydmUgdXNlciBhYmlsaXR5IHRvIGNvbnRyb2wKPiA+ID4gICAgICAgICAgKiBj
aGVja3N1bSBvZmZsb2FkIG9uIHRoZSB2bGFuIGRldmljZS4KPiA+ID4gICAgICAgICAgKi8KPiA+
ID4gLSAgICAgICBpZiAobG93ZXJfZmVhdHVyZXMgJiAoTkVUSUZfRl9JUF9DU1VNfE5FVElGX0Zf
SVBWNl9DU1VNKSkKPiA+ID4gLSAgICAgICAgICAgICAgIGxvd2VyX2ZlYXR1cmVzIHw9IE5FVElG
X0ZfSFdfQ1NVTTsKPiA+ID4gLSAgICAgICBmZWF0dXJlcyA9IG5ldGRldl9pbnRlcnNlY3RfZmVh
dHVyZXMoZmVhdHVyZXMsIGxvd2VyX2ZlYXR1cmVzKTsKPiA+ID4gLSAgICAgICBmZWF0dXJlcyB8
PSBvbGRfZmVhdHVyZXMgJiAoTkVUSUZfRl9TT0ZUX0ZFQVRVUkVTIHwKPiA+ID4gTkVUSUZfRl9H
U09fU09GVFdBUkUpOwo+ID4gPiAtICAgICAgIGZlYXR1cmVzIHw9IE5FVElGX0ZfTExUWDsKPiA+
ID4gKyAgICAgICBpZiAobG93ZXJfZmVhdHVyZXNbMF0gJiAoTkVUSUZfRl9JUF9DU1VNIHwgTkVU
SUZfRl9JUFY2X0NTVU0pKQo+ID4gPiArICAgICAgICAgICAgICAgbG93ZXJfZmVhdHVyZXNbMF0g
fD0gTkVUSUZfRl9IV19DU1VNOwo+ID4gPgo+ID4gPiAtICAgICAgIHJldHVybiBmZWF0dXJlczsK
PiA+ID4gKyAgICAgICBmZWF0dXJlc1swXSA9IG5ldGRldl9pbnRlcnNlY3RfZmVhdHVyZXMoZmVh
dHVyZXNbMF0sIGxvd2VyX2ZlYXR1cmVzWzBdKTsKPiA+ID4gKyAgICAgICBmZWF0dXJlc1swXSB8
PSBvbGRfZmVhdHVyZXNbMF0gJgo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAoTkVUSUZf
Rl9TT0ZUX0ZFQVRVUkVTIHwgTkVUSUZfRl9HU09fU09GVFdBUkUpOwo+ID4gPiArICAgICAgIGZl
YXR1cmVzWzBdIHw9IE5FVElGX0ZfTExUWDsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIHN0YXRpYyBp
bnQgdmxhbl9ldGh0b29sX2dldF9saW5rX2tzZXR0aW5ncyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
LAo+ID4gPiBkaWZmIC0tZ2l0IGEvbmV0L2NvcmUvZGV2LmMgYi9uZXQvY29yZS9kZXYuYwo+ID4g
PiBpbmRleCBjMjUzYzJhLi43MDY2YmYzIDEwMDY0NAo+ID4gPiAtLS0gYS9uZXQvY29yZS9kZXYu
Ywo+ID4gPiArKysgYi9uZXQvY29yZS9kZXYuYwo+ID4gPiBAQCAtMTc2NSw3ICsxNzY1LDcgQEAg
dm9pZCBkZXZfZGlzYWJsZV9scm8oc3RydWN0IG5ldF9kZXZpY2UgKmRldikKPiA+ID4gICAgICAg
ICBkZXYtPndhbnRlZF9mZWF0dXJlcyAmPSB+TkVUSUZfRl9MUk87Cj4gPiA+ICAgICAgICAgbmV0
ZGV2X3VwZGF0ZV9mZWF0dXJlcyhkZXYpOwo+ID4gPgo+ID4gPiAtICAgICAgIGlmICh1bmxpa2Vs
eShkZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9MUk8pKQo+ID4gPiArICAgICAgIGlmICh1bmxpa2Vs
eShkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9MUk8pKQo+ID4gPiAgICAgICAgICAgICAgICAg
bmV0ZGV2X1dBUk4oZGV2LCAiZmFpbGVkIHRvIGRpc2FibGUgTFJPIVxuIik7Cj4gPiA+Cj4gPiA+
ICAgICAgICAgbmV0ZGV2X2Zvcl9lYWNoX2xvd2VyX2RldihkZXYsIGxvd2VyX2RldiwgaXRlcikK
PiA+ID4gQEAgLTE3ODYsNyArMTc4Niw3IEBAIHN0YXRpYyB2b2lkIGRldl9kaXNhYmxlX2dyb19o
dyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgICAgICAgIGRldi0+d2FudGVkX2ZlYXR1
cmVzICY9IH5ORVRJRl9GX0dST19IVzsKPiA+ID4gICAgICAgICBuZXRkZXZfdXBkYXRlX2ZlYXR1
cmVzKGRldik7Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKHVubGlrZWx5KGRldi0+ZmVhdHVyZXMg
JiBORVRJRl9GX0dST19IVykpCj4gPiA+ICsgICAgICAgaWYgKHVubGlrZWx5KGRldi0+ZmVhdHVy
ZXNbMF0gJiBORVRJRl9GX0dST19IVykpCj4gPiA+ICAgICAgICAgICAgICAgICBuZXRkZXZfV0FS
TihkZXYsICJmYWlsZWQgdG8gZGlzYWJsZSBHUk9fSFchXG4iKTsKPiA+ID4gIH0KPiA+ID4KPiA+
ID4gQEAgLTMyNzYsNyArMzI3Niw3IEBAIHN0YXRpYyB2b2lkIHNrYl93YXJuX2JhZF9vZmZsb2Fk
KGNvbnN0IHN0cnVjdAo+ID4gPiBza19idWZmICpza2IpCj4gPiA+ICAgICAgICAgfQo+ID4gPiAg
ICAgICAgIHNrYl9kdW1wKEtFUk5fV0FSTklORywgc2tiLCBmYWxzZSk7Cj4gPiA+ICAgICAgICAg
V0FSTigxLCAiJXM6IGNhcHM9KCVwTkYsICVwTkYpXG4iLAo+ID4gPiAtICAgICAgICAgICAgbmFt
ZSwgZGV2ID8gJmRldi0+ZmVhdHVyZXMgOiAmbnVsbF9mZWF0dXJlcywKPiA+ID4gKyAgICAgICAg
ICAgIG5hbWUsIGRldiA/ICZkZXYtPmZlYXR1cmVzWzBdIDogJm51bGxfZmVhdHVyZXMsCj4gPiA+
ICAgICAgICAgICAgICBza2ItPnNrID8gJnNrYi0+c2stPnNrX3JvdXRlX2NhcHMgOiAmbnVsbF9m
ZWF0dXJlcyk7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+IEBAIC0zNDYzLDcgKzM0NjMsOCBAQCBzdHJ1
Y3Qgc2tfYnVmZiAqX19za2JfZ3NvX3NlZ21lbnQoc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4g
ICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IHBhcnRpYWxfZmVhdHVyZXMgPSBORVRJ
Rl9GX0dTT19ST0JVU1Q7Cj4gPiA+ICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2ID0gc2tiLT5kZXY7Cj4gPiA+Cj4gPiA+IC0gICAgICAgICAgICAgICBwYXJ0aWFsX2ZlYXR1
cmVzIHw9IGRldi0+ZmVhdHVyZXMgJiBkZXYtPmdzb19wYXJ0aWFsX2ZlYXR1cmVzOwo+ID4gPiAr
ICAgICAgICAgICAgICAgcGFydGlhbF9mZWF0dXJlcyB8PQo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGRldi0+ZmVhdHVyZXNbMF0gJiBkZXYtPmdzb19wYXJ0aWFsX2ZlYXR1
cmVzOwo+ID4gPiAgICAgICAgICAgICAgICAgaWYgKCFza2JfZ3NvX29rKHNrYiwgZmVhdHVyZXMg
fCBwYXJ0aWFsX2ZlYXR1cmVzKSkKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVy
ZXMgJj0gfk5FVElGX0ZfR1NPX1BBUlRJQUw7Cj4gPiA+ICAgICAgICAgfQo+ID4gPiBAQCAtMzUw
OCw3ICszNTA5LDcgQEAgc3RhdGljIGludCBpbGxlZ2FsX2hpZ2hkbWEoc3RydWN0IG5ldF9kZXZp
Y2UKPiA+ID4gKmRldiwgc3RydWN0IHNrX2J1ZmYgKnNrYikKPiA+ID4gICNpZmRlZiBDT05GSUdf
SElHSE1FTQo+ID4gPiAgICAgICAgIGludCBpOwo+ID4gPgo+ID4gPiAtICAgICAgIGlmICghKGRl
di0+ZmVhdHVyZXMgJiBORVRJRl9GX0hJR0hETUEpKSB7Cj4gPiA+ICsgICAgICAgaWYgKCEoZGV2
LT5mZWF0dXJlc1swXSAmIE5FVElGX0ZfSElHSERNQSkpIHsKPiA+ID4gICAgICAgICAgICAgICAg
IGZvciAoaSA9IDA7IGkgPCBza2Jfc2hpbmZvKHNrYiktPm5yX2ZyYWdzOyBpKyspIHsKPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgc2tiX2ZyYWdfdCAqZnJhZyA9ICZza2Jfc2hpbmZvKHNr
YiktPmZyYWdzW2ldOwo+ID4gPgo+ID4gPiBAQCAtMzYxMiwzNCArMzYxMywzMyBAQCBzdGF0aWMg
bmV0ZGV2X2ZlYXR1cmVzX3QKPiA+ID4gZ3NvX2ZlYXR1cmVzX2NoZWNrKGNvbnN0IHN0cnVjdCBz
a19idWZmICpza2IsCj4gPiA+ICAgICAgICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiAgfQo+ID4g
Pgo+ID4gPiAtbmV0ZGV2X2ZlYXR1cmVzX3QgbmV0aWZfc2tiX2ZlYXR1cmVzKHN0cnVjdCBza19i
dWZmICpza2IpCj4gPiA+ICt2b2lkIG5ldGlmX3NrYl9mZWF0dXJlcyhzdHJ1Y3Qgc2tfYnVmZiAq
c2tiLCBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAg
c3RydWN0IG5ldF9kZXZpY2UgKmRldiA9IHNrYi0+ZGV2Owo+ID4gPiAtICAgICAgIG5ldGRldl9m
ZWF0dXJlc190IGZlYXR1cmVzID0gZGV2LT5mZWF0dXJlczsKPiA+ID4KPiA+ID4gKyAgICAgICBu
ZXRkZXZfZmVhdHVyZXNfY29weShmZWF0dXJlcywgZGV2LT5mZWF0dXJlcyk7Cj4gPiA+ICAgICAg
ICAgaWYgKHNrYl9pc19nc28oc2tiKSkKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzID0g
Z3NvX2ZlYXR1cmVzX2NoZWNrKHNrYiwgZGV2LCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgICAg
ICAgICBmZWF0dXJlc1swXSA9IGdzb19mZWF0dXJlc19jaGVjayhza2IsIGRldiwgZmVhdHVyZXNb
MF0pOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIElmIGVuY2Fwc3VsYXRpb24gb2ZmbG9hZCByZXF1
ZXN0LCB2ZXJpZnkgd2UgYXJlIHRlc3RpbmcKPiA+ID4gICAgICAgICAgKiBoYXJkd2FyZSBlbmNh
cHN1bGF0aW9uIGZlYXR1cmVzIGluc3RlYWQgb2Ygc3RhbmRhcmQKPiA+ID4gICAgICAgICAgKiBm
ZWF0dXJlcyBmb3IgdGhlIG5ldGRldgo+ID4gPiAgICAgICAgICAqLwo+ID4gPiAgICAgICAgIGlm
IChza2ItPmVuY2Fwc3VsYXRpb24pCj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAmPSBk
ZXYtPmh3X2VuY19mZWF0dXJlczsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJl
c19hbmQoZmVhdHVyZXMsIGRldi0+aHdfZW5jX2ZlYXR1cmVzKTsKPiA+ID4KPiA+ID4gICAgICAg
ICBpZiAoc2tiX3ZsYW5fdGFnZ2VkKHNrYikpCj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJl
cyA9IG5ldGRldl9pbnRlcnNlY3RfZmVhdHVyZXMoZmVhdHVyZXMsCj4gPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT52bGFuX2ZlYXR1
cmVzIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBORVRJRl9GX0hXX1ZMQU5fQ1RBR19UWCB8Cj4gPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9IV19WTEFOX1NUQUdf
VFgpOwo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gPSBuZXRkZXZfaW50ZXJzZWN0
X2ZlYXR1cmVzKGZlYXR1cmVzWzBdLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+dmxhbl9mZWF0dXJlc1swXSB8Cj4gPiA+
ICsKPiA+ID4gTkVUSUZfRl9IV19WTEFOX0NUQUdfVFggfAo+ID4gPiArCj4gPiA+IE5FVElGX0Zf
SFdfVkxBTl9TVEFHX1RYKTsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAoZGV2LT5uZXRkZXZfb3Bz
LT5uZG9fZmVhdHVyZXNfY2hlY2spCj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAmPSBk
ZXYtPm5ldGRldl9vcHMtPm5kb19mZWF0dXJlc19jaGVjayhza2IsIGRldiwKPiA+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGRldi0+bmV0ZGV2X29wcy0+bmRvX2Zl
YXR1cmVzX2NoZWNrKHNrYiwgZGV2LCBmZWF0dXJlcyk7Cj4gPiA+ICAgICAgICAgZWxzZQo+ID4g
PiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gZGZsdF9mZWF0dXJlc19jaGVjayhza2IsIGRl
diwgZmVhdHVyZXMpOwo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gZGZsdF9m
ZWF0dXJlc19jaGVjayhza2IsIGRldiwgZmVhdHVyZXNbMF0pOwo+ID4gPgo+ID4gPiAtICAgICAg
IHJldHVybiBoYXJtb25pemVfZmVhdHVyZXMoc2tiLCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAg
ZmVhdHVyZXNbMF0gPSBoYXJtb25pemVfZmVhdHVyZXMoc2tiLCBmZWF0dXJlc1swXSk7Cj4gPiA+
ICB9Cj4gPiA+ICBFWFBPUlRfU1lNQk9MKG5ldGlmX3NrYl9mZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+
IEBAIC0zNzIyLDEwICszNzIyLDEwIEBAIEVYUE9SVF9TWU1CT0woc2tiX2NzdW1faHdvZmZsb2Fk
X2hlbHApOwo+ID4gPgo+ID4gPiAgc3RhdGljIHN0cnVjdCBza19idWZmICp2YWxpZGF0ZV94bWl0
X3NrYihzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QKPiA+ID4gbmV0X2RldmljZSAqZGV2LCBi
b29sICphZ2FpbikKPiA+ID4gIHsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0
dXJlczsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlc1tORVRERVZfRkVB
VFVSRV9EV09SRFNdOwo+ID4gPgo+ID4gPiAtICAgICAgIGZlYXR1cmVzID0gbmV0aWZfc2tiX2Zl
YXR1cmVzKHNrYik7Cj4gPiA+IC0gICAgICAgc2tiID0gdmFsaWRhdGVfeG1pdF92bGFuKHNrYiwg
ZmVhdHVyZXMpOwo+ID4gPiArICAgICAgIG5ldGlmX3NrYl9mZWF0dXJlcyhza2IsIGZlYXR1cmVz
KTsKPiA+ID4gKyAgICAgICBza2IgPSB2YWxpZGF0ZV94bWl0X3ZsYW4oc2tiLCBmZWF0dXJlc1sw
XSk7Cj4gPiA+ICAgICAgICAgaWYgKHVubGlrZWx5KCFza2IpKQo+ID4gPiAgICAgICAgICAgICAg
ICAgZ290byBvdXRfbnVsbDsKPiA+ID4KPiA+ID4gQEAgLTM3MzMsMTAgKzM3MzMsMTAgQEAgc3Rh
dGljIHN0cnVjdCBza19idWZmCj4gPiA+ICp2YWxpZGF0ZV94bWl0X3NrYihzdHJ1Y3Qgc2tfYnVm
ZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZQo+ID4gPiAgICAgICAgIGlmICh1bmxpa2VseSghc2ti
KSkKPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gb3V0X251bGw7Cj4gPiA+Cj4gPiA+IC0gICAg
ICAgaWYgKG5ldGlmX25lZWRzX2dzbyhza2IsIGZlYXR1cmVzKSkgewo+ID4gPiArICAgICAgIGlm
IChuZXRpZl9uZWVkc19nc28oc2tiLCBmZWF0dXJlc1swXSkpIHsKPiA+ID4gICAgICAgICAgICAg
ICAgIHN0cnVjdCBza19idWZmICpzZWdzOwo+ID4gPgo+ID4gPiAtICAgICAgICAgICAgICAgc2Vn
cyA9IHNrYl9nc29fc2VnbWVudChza2IsIGZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICAgICAgICAg
IHNlZ3MgPSBza2JfZ3NvX3NlZ21lbnQoc2tiLCBmZWF0dXJlc1swXSk7Cj4gPiA+ICAgICAgICAg
ICAgICAgICBpZiAoSVNfRVJSKHNlZ3MpKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
IGdvdG8gb3V0X2tmcmVlX3NrYjsKPiA+ID4gICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2Vn
cykgewo+ID4gPiBAQCAtMzc0NCw3ICszNzQ0LDcgQEAgc3RhdGljIHN0cnVjdCBza19idWZmICp2
YWxpZGF0ZV94bWl0X3NrYihzdHJ1Y3QKPiA+ID4gc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2Rl
dmljZQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBza2IgPSBzZWdzOwo+ID4gPiAgICAg
ICAgICAgICAgICAgfQo+ID4gPiAgICAgICAgIH0gZWxzZSB7Cj4gPiA+IC0gICAgICAgICAgICAg
ICBpZiAoc2tiX25lZWRzX2xpbmVhcml6ZShza2IsIGZlYXR1cmVzKSAmJgo+ID4gPiArICAgICAg
ICAgICAgICAgaWYgKHNrYl9uZWVkc19saW5lYXJpemUoc2tiLCBmZWF0dXJlc1swXSkgJiYKPiA+
ID4gICAgICAgICAgICAgICAgICAgICBfX3NrYl9saW5lYXJpemUoc2tiKSkKPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgZ290byBvdXRfa2ZyZWVfc2tiOwo+ID4gPgo+ID4gPiBAQCAtMzc1
OSwxMiArMzc1OSwxMiBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYKPiA+ID4gKnZhbGlkYXRlX3ht
aXRfc2tiKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlCj4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgIGVsc2UKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBza2Jfc2V0X3RyYW5zcG9ydF9oZWFkZXIoc2tiLAo+ID4gPgo+ID4gPiBza2JfY2hlY2tz
dW1fc3RhcnRfb2Zmc2V0KHNrYikpOwo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBpZiAo
c2tiX2NzdW1faHdvZmZsb2FkX2hlbHAoc2tiLCBmZWF0dXJlcykpCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGlmIChza2JfY3N1bV9od29mZmxvYWRfaGVscChza2IsIGZlYXR1cmVzWzBd
KSkKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9rZnJlZV9z
a2I7Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAt
ICAgICAgIHNrYiA9IHZhbGlkYXRlX3htaXRfeGZybShza2IsIGZlYXR1cmVzLCBhZ2Fpbik7Cj4g
PiA+ICsgICAgICAgc2tiID0gdmFsaWRhdGVfeG1pdF94ZnJtKHNrYiwgZmVhdHVyZXNbMF0sIGFn
YWluKTsKPiA+ID4KPiA+ID4gICAgICAgICByZXR1cm4gc2tiOwo+ID4gPgo+ID4gPiBAQCAtNDQy
OSw3ICs0NDI5LDcgQEAgc2V0X3Jwc19jcHUoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgc3RydWN0
IHNrX2J1ZmYgKnNrYiwKPiA+ID4KPiA+ID4gICAgICAgICAgICAgICAgIC8qIFNob3VsZCB3ZSBz
dGVlciB0aGlzIGZsb3cgdG8gYSBkaWZmZXJlbnQgaGFyZHdhcmUgcXVldWU/ICovCj4gPiA+ICAg
ICAgICAgICAgICAgICBpZiAoIXNrYl9yeF9xdWV1ZV9yZWNvcmRlZChza2IpIHx8ICFkZXYtPnJ4
X2NwdV9ybWFwIHx8Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgIShkZXYtPmZlYXR1cmVzICYg
TkVUSUZfRl9OVFVQTEUpKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICEoZGV2LT5mZWF0dXJl
c1swXSAmIE5FVElGX0ZfTlRVUExFKSkKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZ290
byBvdXQ7Cj4gPiA+ICAgICAgICAgICAgICAgICByeHFfaW5kZXggPSBjcHVfcm1hcF9sb29rdXBf
aW5kZXgoZGV2LT5yeF9jcHVfcm1hcCwgbmV4dF9jcHUpOwo+ID4gPiAgICAgICAgICAgICAgICAg
aWYgKHJ4cV9pbmRleCA9PSBza2JfZ2V0X3J4X3F1ZXVlKHNrYikpCj4gPiA+IEBAIC05Nzk5LDE3
MSArOTc5OSwxNzkgQEAgc3RhdGljIHZvaWQgbmV0X3NldF90b2RvKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYpCj4gPiA+ICAgICAgICAgZGV2X25ldChkZXYpLT5kZXZfdW5yZWdfY291bnQrKzsKPiA+
ID4gIH0KPiA+ID4KPiA+ID4gLXN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdCBuZXRkZXZfc3luY191
cHBlcl9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqbG93ZXIsCj4gPiA+IC0gICAgICAgc3Ry
dWN0IG5ldF9kZXZpY2UgKnVwcGVyLCBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcykKPiA+ID4g
K3N0YXRpYyB2b2lkIG5ldGRldl9zeW5jX3VwcGVyX2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNl
ICpsb3dlciwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IG5ldF9kZXZpY2UgKnVwcGVyLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAg
ICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgdXBwZXJfZGlzYWJsZXMgPSBORVRJRl9GX1VQUEVSX0RJ
U0FCTEVTOwo+ID4gPiAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmU7Cj4gPiA+ICAg
ICAgICAgaW50IGZlYXR1cmVfYml0Owo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4g
Pgo+ID4gPiAtICAgICAgIGZvcl9lYWNoX25ldGRldl9mZWF0dXJlKHVwcGVyX2Rpc2FibGVzLCBm
ZWF0dXJlX2JpdCkgewo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZSA9IF9fTkVUSUZfRl9C
SVQoZmVhdHVyZV9iaXQpOwo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKCEodXBwZXItPndhbnRl
ZF9mZWF0dXJlcyAmIGZlYXR1cmUpCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgJiYgKGZlYXR1
cmVzICYgZmVhdHVyZSkpIHsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2Ri
Zyhsb3dlciwgIkRyb3BwaW5nIGZlYXR1cmUgJXBORiwKPiA+ID4gdXBwZXIgZGV2ICVzIGhhcyBp
dCBvZmYuXG4iLAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmZWF0
dXJlLCB1cHBlci0+bmFtZSk7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVz
ICY9IH5mZWF0dXJlOwo+ID4gPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBORVRERVZfRkVBVFVS
RV9EV09SRFM7IGkrKykgewo+ID4gPiArICAgICAgICAgICAgICAgZm9yX2VhY2hfbmV0ZGV2X2Zl
YXR1cmUodXBwZXJfZGlzYWJsZXMsIGZlYXR1cmVfYml0KSB7Cj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGZlYXR1cmUgPSBfX05FVElGX0ZfQklUKGZlYXR1cmVfYml0KTsKPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKCEodXBwZXItPndhbnRlZF9mZWF0dXJlc1tpXSAmIGZl
YXR1cmUpICYmCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAoZmVhdHVyZXNbaV0g
JiBmZWF0dXJlKSkgewo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRl
dl9kYmcobG93ZXIsICJEcm9wcGluZwo+ID4gPiBmZWF0dXJlWyV1XSAlcE5GLCB1cHBlciBkZXYg
JXMgaGFzIGl0IG9mZi5cbiIsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpLCAmZmVhdHVyZSwgdXBwZXItPm5hbWUpOwo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzW2ldICY9IH5mZWF0dXJlOwo+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAg
fQo+ID4gPiAtCj4gPiA+IC0gICAgICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiAgfQo+ID4gPgo+
ID4gPiAgc3RhdGljIHZvaWQgbmV0ZGV2X3N5bmNfbG93ZXJfZmVhdHVyZXMoc3RydWN0IG5ldF9k
ZXZpY2UgKnVwcGVyLAo+ID4gPiAtICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpsb3dlciwgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICsgICAgICAgc3RydWN0IG5ldF9kZXZpY2Ug
Kmxvd2VyLCBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAg
ICAgbmV0ZGV2X2ZlYXR1cmVzX3QgdXBwZXJfZGlzYWJsZXMgPSBORVRJRl9GX1VQUEVSX0RJU0FC
TEVTOwo+ID4gPiAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmU7Cj4gPiA+ICAgICAg
ICAgaW50IGZlYXR1cmVfYml0Owo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPgo+
ID4gPiAtICAgICAgIGZvcl9lYWNoX25ldGRldl9mZWF0dXJlKHVwcGVyX2Rpc2FibGVzLCBmZWF0
dXJlX2JpdCkgewo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZSA9IF9fTkVUSUZfRl9CSVQo
ZmVhdHVyZV9iaXQpOwo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKCEoZmVhdHVyZXMgJiBmZWF0
dXJlKSAmJiAobG93ZXItPmZlYXR1cmVzICYgZmVhdHVyZSkpIHsKPiA+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgbmV0ZGV2X2RiZyh1cHBlciwgIkRpc2FibGluZyBmZWF0dXJlICVwTkYgb24K
PiA+ID4gbG93ZXIgZGV2ICVzLlxuIiwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAmZmVhdHVyZSwgbG93ZXItPm5hbWUpOwo+ID4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICBsb3dlci0+d2FudGVkX2ZlYXR1cmVzICY9IH5mZWF0dXJlOwo+ID4gPiAtICAgICAgICAg
ICAgICAgICAgICAgICBfX25ldGRldl91cGRhdGVfZmVhdHVyZXMobG93ZXIpOwo+ID4gPiAtCj4g
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseShsb3dlci0+ZmVhdHVyZXMg
JiBmZWF0dXJlKSkKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZf
V0FSTih1cHBlciwgImZhaWxlZCB0byBkaXNhYmxlCj4gPiA+ICVwTkYgb24gJXMhXG4iLAo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmZWF0dXJlLCBs
b3dlci0+bmFtZSk7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGVsc2UKPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfY2hhbmdlKGxvd2Vy
KTsKPiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgTkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBp
KyspIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGZvcl9lYWNoX25ldGRldl9mZWF0dXJlKHVwcGVy
X2Rpc2FibGVzLCBmZWF0dXJlX2JpdCkgewo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBm
ZWF0dXJlID0gX19ORVRJRl9GX0JJVChmZWF0dXJlX2JpdCk7Cj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGlmICghKGZlYXR1cmVzW2ldICYgZmVhdHVyZSkgJiYKPiA+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChsb3dlci0+ZmVhdHVyZXNbaV0gJiBmZWF0dXJlKSkgewo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9kYmcodXBwZXIsICJEaXNh
YmxpbmcKPiA+ID4gZmVhdHVyZVsldV0gJXBORiBvbiBsb3dlciBkZXYgJXMuXG4iLAo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSwgJmZlYXR1cmUsIGxv
d2VyLT5uYW1lKTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dlci0+
d2FudGVkX2ZlYXR1cmVzW2ldICY9IH5mZWF0dXJlW2ldOwo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIF9fbmV0ZGV2X3VwZGF0ZV9mZWF0dXJlcyhsb3dlcik7Cj4gPiA+ICsK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodW5saWtlbHkobG93ZXIt
PmZlYXR1cmVzW2ldICYgZmVhdHVyZSkpCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBuZXRkZXZfV0FSTih1cHBlciwgImZhaWxlZCB0bwo+ID4gPiBkaXNhYmxl
IGZlYXR1cmVbJXVdICVwTkYgb24gJXMhXG4iLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSwgJmZlYXR1cmUsIGxvd2VyLT5uYW1lKTsK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCj4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfY2hhbmdlKGxv
d2VyKTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgfQo+ID4gPiAgICAgICAgICAgICAg
ICAgfQo+ID4gPiAgICAgICAgIH0KPiA+ID4gIH0KPiA+ID4KPiA+ID4gLXN0YXRpYyBuZXRkZXZf
ZmVhdHVyZXNfdCBuZXRkZXZfZml4X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4g
PiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICtzdGF0aWMgdm9p
ZCBuZXRkZXZfZml4X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgKmZlYXR1cmVzKQo+
ID4gPiAgewo+ID4gPiAgICAgICAgIC8qIEZpeCBpbGxlZ2FsIGNoZWNrc3VtIGNvbWJpbmF0aW9u
cyAqLwo+ID4gPiAtICAgICAgIGlmICgoZmVhdHVyZXMgJiBORVRJRl9GX0hXX0NTVU0pICYmCj4g
PiA+IC0gICAgICAgICAgIChmZWF0dXJlcyAmIChORVRJRl9GX0lQX0NTVU18TkVUSUZfRl9JUFY2
X0NTVU0pKSkgewo+ID4gPiArICAgICAgIGlmICgoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX0NT
VU0pICYmCj4gPiA+ICsgICAgICAgICAgIChmZWF0dXJlc1swXSAmIChORVRJRl9GX0lQX0NTVU0g
fCBORVRJRl9GX0lQVjZfQ1NVTSkpKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICBuZXRkZXZfd2Fy
bihkZXYsICJtaXhlZCBIVyBhbmQgSVAgY2hlY2tzdW0gc2V0dGluZ3MuXG4iKTsKPiA+ID4gLSAg
ICAgICAgICAgICAgIGZlYXR1cmVzICY9IH4oTkVUSUZfRl9JUF9DU1VNfE5FVElGX0ZfSVBWNl9D
U1VNKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH4oTkVUSUZfRl9JUF9D
U1VNIHwgTkVUSUZfRl9JUFY2X0NTVU0pOwo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gICAg
ICAgICAvKiBUU08gcmVxdWlyZXMgdGhhdCBTRyBpcyBwcmVzZW50IGFzIHdlbGwuICovCj4gPiA+
IC0gICAgICAgaWYgKChmZWF0dXJlcyAmIE5FVElGX0ZfQUxMX1RTTykgJiYgIShmZWF0dXJlcyAm
IE5FVElGX0ZfU0cpKSB7Cj4gPiA+ICsgICAgICAgaWYgKChmZWF0dXJlc1swXSAmIE5FVElGX0Zf
QUxMX1RTTykgJiYgIShmZWF0dXJlc1swXSAmIE5FVElGX0ZfU0cpKSB7Cj4gPiA+ICAgICAgICAg
ICAgICAgICBuZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIFRTTyBmZWF0dXJlcyBzaW5jZSBubyBT
RyBmZWF0dXJlLlxuIik7Cj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAmPSB+TkVUSUZf
Rl9BTExfVFNPOwo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfk5FVElGX0Zf
QUxMX1RTTzsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKChmZWF0dXJl
cyAmIE5FVElGX0ZfVFNPKSAmJiAhKGZlYXR1cmVzICYgTkVUSUZfRl9IV19DU1VNKSAmJgo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIShmZWF0dXJlcyAmIE5F
VElGX0ZfSVBfQ1NVTSkpIHsKPiA+ID4gKyAgICAgICBpZiAoKGZlYXR1cmVzWzBdICYgTkVUSUZf
Rl9UU08pICYmICEoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX0NTVU0pICYmCj4gPiA+ICsgICAg
ICAgICAgICEoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0lQX0NTVU0pKSB7Cj4gPiA+ICAgICAgICAg
ICAgICAgICBuZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIFRTTyBmZWF0dXJlcyBzaW5jZSBubyBD
U1VNCj4gPiA+IGZlYXR1cmUuXG4iKTsKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9
IH5ORVRJRl9GX1RTTzsKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9G
X1RTT19FQ047Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9U
U087Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9UU09fRUNO
Owo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoKGZlYXR1cmVzICYgTkVU
SUZfRl9UU082KSAmJiAhKGZlYXR1cmVzICYgTkVUSUZfRl9IV19DU1VNKSAmJgo+ID4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEoZmVhdHVyZXMgJiBORVRJRl9G
X0lQVjZfQ1NVTSkpIHsKPiA+ID4gKyAgICAgICBpZiAoKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9U
U082KSAmJiAhKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19DU1VNKSAmJgo+ID4gPiArICAgICAg
ICAgICAhKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9JUFY2X0NTVU0pKSB7Cj4gPiA+ICAgICAgICAg
ICAgICAgICBuZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIFRTTzYgZmVhdHVyZXMgc2luY2Ugbm8g
Q1NVTQo+ID4gPiBmZWF0dXJlLlxuIik7Cj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAm
PSB+TkVUSUZfRl9UU082Owo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfk5F
VElGX0ZfVFNPNjsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgLyogVFNPIHdp
dGggSVB2NCBJRCBtYW5nbGluZyByZXF1aXJlcyBJUHY0IFRTTyBiZSBlbmFibGVkICovCj4gPiA+
IC0gICAgICAgaWYgKChmZWF0dXJlcyAmIE5FVElGX0ZfVFNPX01BTkdMRUlEKSAmJiAhKGZlYXR1
cmVzICYgTkVUSUZfRl9UU08pKQo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gfk5F
VElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPiArICAgICAgIGlmICgoZmVhdHVyZXNbMF0gJiBORVRJ
Rl9GX1RTT19NQU5HTEVJRCkgJiYKPiA+ID4gKyAgICAgICAgICAgIShmZWF0dXJlc1swXSAmIE5F
VElGX0ZfVFNPKSkKPiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH5ORVRJRl9G
X1RTT19NQU5HTEVJRDsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBUU08gRUNOIHJlcXVpcmVzIHRo
YXQgVFNPIGlzIHByZXNlbnQgYXMgd2VsbC4gKi8KPiA+ID4gLSAgICAgICBpZiAoKGZlYXR1cmVz
ICYgTkVUSUZfRl9BTExfVFNPKSA9PSBORVRJRl9GX1RTT19FQ04pCj4gPiA+IC0gICAgICAgICAg
ICAgICBmZWF0dXJlcyAmPSB+TkVUSUZfRl9UU09fRUNOOwo+ID4gPiArICAgICAgIGlmICgoZmVh
dHVyZXNbMF0gJiBORVRJRl9GX0FMTF9UU08pID09IE5FVElGX0ZfVFNPX0VDTikKPiA+ID4gKyAg
ICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH5ORVRJRl9GX1RTT19FQ047Cj4gPiA+Cj4gPiA+
ICAgICAgICAgLyogU29mdHdhcmUgR1NPIGRlcGVuZHMgb24gU0cuICovCj4gPiA+IC0gICAgICAg
aWYgKChmZWF0dXJlcyAmIE5FVElGX0ZfR1NPKSAmJiAhKGZlYXR1cmVzICYgTkVUSUZfRl9TRykp
IHsKPiA+ID4gKyAgICAgICBpZiAoKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9HU08pICYmICEoZmVh
dHVyZXNbMF0gJiBORVRJRl9GX1NHKSkgewo+ID4gPiAgICAgICAgICAgICAgICAgbmV0ZGV2X2Ri
ZyhkZXYsICJEcm9wcGluZyBORVRJRl9GX0dTTyBzaW5jZSBubyBTRyBmZWF0dXJlLlxuIik7Cj4g
PiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAmPSB+TkVUSUZfRl9HU087Cj4gPiA+ICsgICAg
ICAgICAgICAgICBmZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9HU087Cj4gPiA+ICAgICAgICAgfQo+
ID4gPgo+ID4gPiAgICAgICAgIC8qIEdTTyBwYXJ0aWFsIGZlYXR1cmVzIHJlcXVpcmUgR1NPIHBh
cnRpYWwgYmUgc2V0ICovCj4gPiA+IC0gICAgICAgaWYgKChmZWF0dXJlcyAmIGRldi0+Z3NvX3Bh
cnRpYWxfZmVhdHVyZXMpICYmCj4gPiA+IC0gICAgICAgICAgICEoZmVhdHVyZXMgJiBORVRJRl9G
X0dTT19QQVJUSUFMKSkgewo+ID4gPiArICAgICAgIGlmICgoZmVhdHVyZXNbMF0gJiBkZXYtPmdz
b19wYXJ0aWFsX2ZlYXR1cmVzKSAmJgo+ID4gPiArICAgICAgICAgICAhKGZlYXR1cmVzWzBdICYg
TkVUSUZfRl9HU09fUEFSVElBTCkpIHsKPiA+ID4gICAgICAgICAgICAgICAgIG5ldGRldl9kYmco
ZGV2LAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRHJvcHBpbmcgcGFydGlhbGx5
IHN1cHBvcnRlZCBHU08gZmVhdHVyZXMKPiA+ID4gc2luY2Ugbm8gR1NPIHBhcnRpYWwuXG4iKTsK
PiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5kZXYtPmdzb19wYXJ0aWFsX2ZlYXR1
cmVzOwo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfmRldi0+Z3NvX3BhcnRp
YWxfZmVhdHVyZXM7Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAtICAgICAgIGlmICghKGZl
YXR1cmVzICYgTkVUSUZfRl9SWENTVU0pKSB7Cj4gPiA+ICsgICAgICAgaWYgKCEoZmVhdHVyZXNb
MF0gJiBORVRJRl9GX1JYQ1NVTSkpIHsKPiA+ID4gICAgICAgICAgICAgICAgIC8qIE5FVElGX0Zf
R1JPX0hXIGltcGxpZXMgZG9pbmcgUlhDU1VNIHNpbmNlIGV2ZXJ5IHBhY2tldAo+ID4gPiAgICAg
ICAgICAgICAgICAgICogc3VjY2Vzc2Z1bGx5IG1lcmdlZCBieSBoYXJkd2FyZSBtdXN0IGFsc28g
aGF2ZSB0aGUKPiA+ID4gICAgICAgICAgICAgICAgICAqIGNoZWNrc3VtIHZlcmlmaWVkIGJ5IGhh
cmR3YXJlLiAgSWYgdGhlIHVzZXIgZG9lcyBub3QKPiA+ID4gICAgICAgICAgICAgICAgICAqIHdh
bnQgdG8gZW5hYmxlIFJYQ1NVTSwgbG9naWNhbGx5LCB3ZSBzaG91bGQgZGlzYWJsZSBHUk9fSFcu
Cj4gPiA+ICAgICAgICAgICAgICAgICAgKi8KPiA+ID4gLSAgICAgICAgICAgICAgIGlmIChmZWF0
dXJlcyAmIE5FVElGX0ZfR1JPX0hXKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoZmVhdHVy
ZXNbMF0gJiBORVRJRl9GX0dST19IVykgewo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBu
ZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIE5FVElGX0ZfR1JPX0hXIHNpbmNlCj4gPiA+IG5vIFJY
Q1NVTSBmZWF0dXJlLlxuIik7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVz
ICY9IH5ORVRJRl9GX0dST19IVzsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVy
ZXNbMF0gJj0gfk5FVElGX0ZfR1JPX0hXOwo+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4gPiAg
ICAgICAgIH0KPiA+ID4KPiA+ID4gICAgICAgICAvKiBMUk8vSFctR1JPIGZlYXR1cmVzIGNhbm5v
dCBiZSBjb21iaW5lZCB3aXRoIFJYLUZDUyAqLwo+ID4gPiAtICAgICAgIGlmIChmZWF0dXJlcyAm
IE5FVElGX0ZfUlhGQ1MpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIGlmIChmZWF0dXJlcyAmIE5F
VElGX0ZfTFJPKSB7Cj4gPiA+ICsgICAgICAgaWYgKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9SWEZD
Uykgewo+ID4gPiArICAgICAgICAgICAgICAgaWYgKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9MUk8p
IHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2RiZyhkZXYsICJEcm9wcGlu
ZyBMUk8gZmVhdHVyZSBzaW5jZQo+ID4gPiBSWC1GQ1MgaXMgcmVxdWVzdGVkLlxuIik7Cj4gPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9GX0xSTzsKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfk5FVElGX0ZfTFJPOwo+ID4g
PiAgICAgICAgICAgICAgICAgfQo+ID4gPgo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKGZlYXR1
cmVzICYgTkVUSUZfRl9HUk9fSFcpIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChmZWF0dXJl
c1swXSAmIE5FVElGX0ZfR1JPX0hXKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIG5l
dGRldl9kYmcoZGV2LCAiRHJvcHBpbmcgSFctR1JPIGZlYXR1cmUgc2luY2UKPiA+ID4gUlgtRkNT
IGlzIHJlcXVlc3RlZC5cbiIpOwo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJl
cyAmPSB+TkVUSUZfRl9HUk9fSFc7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1
cmVzWzBdICY9IH5ORVRJRl9GX0dST19IVzsKPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4g
ICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKGZlYXR1cmVzICYgTkVUSUZfRl9IV19U
TFNfVFgpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIGJvb2wgaXBfY3N1bSA9IChmZWF0dXJlcyAm
IChORVRJRl9GX0lQX0NTVU0gfAo+ID4gPiBORVRJRl9GX0lQVjZfQ1NVTSkpID09Cj4gPiA+ICsg
ICAgICAgaWYgKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19UTFNfVFgpIHsKPiA+ID4gKyAgICAg
ICAgICAgICAgIGJvb2wgaXBfY3N1bSA9IChmZWF0dXJlc1swXSAmIChORVRJRl9GX0lQX0NTVU0g
fAo+ID4gPiBORVRJRl9GX0lQVjZfQ1NVTSkpID09Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgIChORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTSk7Cj4gPiA+IC0gICAgICAg
ICAgICAgICBib29sIGh3X2NzdW0gPSBmZWF0dXJlcyAmIE5FVElGX0ZfSFdfQ1NVTTsKPiA+ID4g
KyAgICAgICAgICAgICAgIGJvb2wgaHdfY3N1bSA9IGZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19D
U1VNOwo+ID4gPgo+ID4gPiAgICAgICAgICAgICAgICAgaWYgKCFpcF9jc3VtICYmICFod19jc3Vt
KSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9kYmcoZGV2LCAiRHJvcHBp
bmcgVExTIFRYIEhXIG9mZmxvYWQKPiA+ID4gZmVhdHVyZSBzaW5jZSBubyBDU1VNIGZlYXR1cmUu
XG4iKTsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gfk5FVElGX0Zf
SFdfVExTX1RYOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlc1swXSAmPSB+
TkVUSUZfRl9IV19UTFNfVFg7Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAg
fQo+ID4gPgo+ID4gPiAtICAgICAgIGlmICgoZmVhdHVyZXMgJiBORVRJRl9GX0hXX1RMU19SWCkg
JiYgIShmZWF0dXJlcyAmIE5FVElGX0ZfUlhDU1VNKSkgewo+ID4gPiArICAgICAgIGlmICgoZmVh
dHVyZXNbMF0gJiBORVRJRl9GX0hXX1RMU19SWCkgJiYKPiA+ID4gKyAgICAgICAgICAgIShmZWF0
dXJlc1swXSAmIE5FVElGX0ZfUlhDU1VNKSkgewo+ID4gPiAgICAgICAgICAgICAgICAgbmV0ZGV2
X2RiZyhkZXYsICJEcm9wcGluZyBUTFMgUlggSFcgb2ZmbG9hZCBmZWF0dXJlCj4gPiA+IHNpbmNl
IG5vIFJYQ1NVTSBmZWF0dXJlLlxuIik7Cj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAm
PSB+TkVUSUZfRl9IV19UTFNfUlg7Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1swXSAm
PSB+TkVUSUZfRl9IV19UTFNfUlg7Cj4gPiA+ICAgICAgICAgfQo+ID4gPiAtCj4gPiA+IC0gICAg
ICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgaW50IF9fbmV0ZGV2X3Vw
ZGF0ZV9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgewo+ID4gPiArICAg
ICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzW05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4g
PiA+ICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKnVwcGVyLCAqbG93ZXI7Cj4gPiA+IC0gICAg
ICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXM7Cj4gPiA+ICAgICAgICAgc3RydWN0IGxpc3Rf
aGVhZCAqaXRlcjsKPiA+ID4gKyAgICAgICB1bnNpZ25lZCBpbnQgaTsKPiA+ID4gICAgICAgICBp
bnQgZXJyID0gLTE7Cj4gPiA+Cj4gPiA+ICAgICAgICAgQVNTRVJUX1JUTkwoKTsKPiA+ID4KPiA+
ID4gLSAgICAgICBmZWF0dXJlcyA9IG5ldGRldl9nZXRfd2FudGVkX2ZlYXR1cmVzKGRldik7Cj4g
PiA+ICsgICAgICAgbmV0ZGV2X2dldF93YW50ZWRfZmVhdHVyZXMoZGV2LCBmZWF0dXJlcyk7Cj4g
PiA+Cj4gPiA+ICAgICAgICAgaWYgKGRldi0+bmV0ZGV2X29wcy0+bmRvX2ZpeF9mZWF0dXJlcykK
PiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzID0gZGV2LT5uZXRkZXZfb3BzLT5uZG9fZml4
X2ZlYXR1cmVzKGRldiwgZmVhdHVyZXMpOwo+ID4gPiArICAgICAgICAgICAgICAgZGV2LT5uZXRk
ZXZfb3BzLT5uZG9fZml4X2ZlYXR1cmVzKGRldiwgZmVhdHVyZXMpOwo+ID4gPgo+ID4gPiAgICAg
ICAgIC8qIGRyaXZlciBtaWdodCBiZSBsZXNzIHN0cmljdCBhYm91dCBmZWF0dXJlIGRlcGVuZGVu
Y2llcyAqLwo+ID4gPiAtICAgICAgIGZlYXR1cmVzID0gbmV0ZGV2X2ZpeF9mZWF0dXJlcyhkZXYs
IGZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZml4X2ZlYXR1cmVzKGRldiwgZmVhdHVy
ZXMpOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIHNvbWUgZmVhdHVyZXMgY2FuJ3QgYmUgZW5hYmxl
ZCBpZiB0aGV5J3JlIG9mZiBvbiBhbiB1cHBlciBkZXZpY2UgKi8KPiA+ID4gICAgICAgICBuZXRk
ZXZfZm9yX2VhY2hfdXBwZXJfZGV2X3JjdShkZXYsIHVwcGVyLCBpdGVyKQo+ID4gPiAtICAgICAg
ICAgICAgICAgZmVhdHVyZXMgPSBuZXRkZXZfc3luY191cHBlcl9mZWF0dXJlcyhkZXYsIHVwcGVy
LCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXZfc3luY191cHBlcl9mZWF0
dXJlcyhkZXYsIHVwcGVyLCBmZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKGRldi0+
ZmVhdHVyZXMgPT0gZmVhdHVyZXMpCj4gPiA+ICsgICAgICAgaWYgKG5ldGRldl9mZWF0dXJlc19l
cXVhbChkZXYtPmZlYXR1cmVzLCBmZWF0dXJlcykpCj4gPiA+ICAgICAgICAgICAgICAgICBnb3Rv
IHN5bmNfbG93ZXI7Cj4gPiA+Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2RiZyhkZXYsICJGZWF0dXJl
cyBjaGFuZ2VkOiAlcE5GIC0+ICVwTkZcbiIsCj4gPiA+IC0gICAgICAgICAgICAgICAmZGV2LT5m
ZWF0dXJlcywgJmZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgTkVUREVW
X0ZFQVRVUkVfRFdPUkRTOyBpKyspCj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXZfZGJnKGRl
diwgIkZlYXR1cmVzWyV1XSBjaGFuZ2VkOiAlcE5GIC0+ICVwTkZcbiIsCj4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgIGksICZkZXYtPmZlYXR1cmVzW2ldLCAmZmVhdHVyZXNbaV0pOwo+
ID4gPgo+ID4gPiAgICAgICAgIGlmIChkZXYtPm5ldGRldl9vcHMtPm5kb19zZXRfZmVhdHVyZXMp
Cj4gPiA+ICAgICAgICAgICAgICAgICBlcnIgPSBkZXYtPm5ldGRldl9vcHMtPm5kb19zZXRfZmVh
dHVyZXMoZGV2LCBmZWF0dXJlcyk7Cj4gPiA+IEBAIC05OTcxLDkgKzk5NzksMTAgQEAgaW50IF9f
bmV0ZGV2X3VwZGF0ZV9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgICAg
ICAgICAgICAgICAgZXJyID0gMDsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAodW5saWtlbHkoZXJy
IDwgMCkpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldl9lcnIoZGV2LAo+ID4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAic2V0X2ZlYXR1cmVzKCkgZmFpbGVkICglZCk7IHdhbnRlZCAl
cE5GLCBsZWZ0ICVwTkZcbiIsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGVyciwgJmZl
YXR1cmVzLCAmZGV2LT5mZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgICAgICAgICBmb3IgKGkgPSAw
OyBpIDwgTkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBpKyspCj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgIG5ldGRldl9lcnIoZGV2LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICJzZXRfZmVhdHVyZXMoKSBmYWlsZWQgKCVkKTsKPiA+ID4gd2FudGVkWyV1XSAlcE5G
LCBsZWZ0WyV1XSAlcE5GXG4iLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGVyciwgaSwgJmZlYXR1cmVzW2ldLCBpLCAmZGV2LT5mZWF0dXJlc1tpXSk7Cj4gPiA+ICAg
ICAgICAgICAgICAgICAvKiByZXR1cm4gbm9uLTAgc2luY2Ugc29tZSBmZWF0dXJlcyBtaWdodCBo
YXZlIGNoYW5nZWQgYW5kCj4gPiA+ICAgICAgICAgICAgICAgICAgKiBpdCdzIGJldHRlciB0byBm
aXJlIGEgc3B1cmlvdXMgbm90aWZpY2F0aW9uIHRoYW4gbWlzcyBpdAo+ID4gPiAgICAgICAgICAg
ICAgICAgICovCj4gPiA+IEBAIC05OTg4LDkgKzk5OTcsMTAgQEAgaW50IF9fbmV0ZGV2X3VwZGF0
ZV9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgICAgICAgICAgICAgICAg
bmV0ZGV2X3N5bmNfbG93ZXJfZmVhdHVyZXMoZGV2LCBsb3dlciwgZmVhdHVyZXMpOwo+ID4gPgo+
ID4gPiAgICAgICAgIGlmICghZXJyKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXZfZmVh
dHVyZXNfdCBkaWZmID0gZmVhdHVyZXMgXiBkZXYtPmZlYXR1cmVzOwo+ID4gPiArICAgICAgICAg
ICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZGlmZltORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+ID4g
Pgo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKGRpZmYgJiBORVRJRl9GX1JYX1VEUF9UVU5ORUxf
UE9SVCkgewo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3hvcihkaWZmLCBm
ZWF0dXJlcywgZGV2LT5mZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoZGlmZlsw
XSAmIE5FVElGX0ZfUlhfVURQX1RVTk5FTF9QT1JUKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgIC8qIHVkcF90dW5uZWxfe2dldCxkcm9wfV9yeF9pbmZvIGJvdGggbmVlZAo+ID4gPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgKiBORVRJRl9GX1JYX1VEUF9UVU5ORUxfUE9SVCBlbmFi
bGVkIG9uIHRoZQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkZXZpY2UsIG9yIHRo
ZXkgd29uJ3QgZG8gYW55dGhpbmcuCj4gPiA+IEBAIC05OTk4LDMzICsxMDAwOCwzMyBAQCBpbnQg
X19uZXRkZXZfdXBkYXRlX2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCj4gPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgICAqICpiZWZvcmUqIGNhbGxpbmcgdWRwX3R1bm5lbF9nZXRf
cnhfaW5mbywKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICogYnV0ICphZnRlciogY2Fs
bGluZyB1ZHBfdHVubmVsX2Ryb3BfcnhfaW5mby4KPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgICovCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmIChmZWF0dXJlcyAmIE5FVElG
X0ZfUlhfVURQX1RVTk5FTF9QT1JUKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZGV2LT5mZWF0dXJlcyA9IGZlYXR1cmVzOwo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoZmVhdHVyZXNbMF0gJiBORVRJRl9GX1JYX1VEUF9UVU5ORUxfUE9SVCkgewo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZmVhdHVyZXNbMF0gPSBmZWF0
dXJlc1swXTsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ZHBfdHVubmVs
X2dldF9yeF9pbmZvKGRldik7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7
Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWRwX3R1bm5lbF9kcm9wX3J4
X2luZm8oZGV2KTsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgfQo+ID4gPiAgICAgICAg
ICAgICAgICAgfQo+ID4gPgo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKGRpZmYgJiBORVRJRl9G
X0hXX1ZMQU5fQ1RBR19GSUxURVIpIHsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYg
KGZlYXR1cmVzICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfRklMVEVSKSB7Cj4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5mZWF0dXJlcyA9IGZlYXR1cmVzOwo+ID4gPiAr
ICAgICAgICAgICAgICAgaWYgKGRpZmZbMF0gJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIp
IHsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZlYXR1cmVzWzBdICYgTkVUSUZf
Rl9IV19WTEFOX0NUQUdfRklMVEVSKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZGV2LT5mZWF0dXJlc1swXSA9IGZlYXR1cmVzWzBdOwo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGVyciB8PSB2bGFuX2dldF9yeF9jdGFnX2ZpbHRlcl9pbmZvKGRl
dik7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdmxhbl9kcm9wX3J4X2N0YWdfZmlsdGVyX2luZm8oZGV2
KTsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgfQo+ID4gPiAgICAgICAgICAgICAgICAg
fQo+ID4gPgo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKGRpZmYgJiBORVRJRl9GX0hXX1ZMQU5f
U1RBR19GSUxURVIpIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChkaWZmWzBdICYgTkVUSUZf
Rl9IV19WTEFOX1NUQUdfRklMVEVSKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGlm
IChmZWF0dXJlcyAmIE5FVElGX0ZfSFdfVkxBTl9TVEFHX0ZJTFRFUikgewo+ID4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+ZmVhdHVyZXMgPSBmZWF0dXJlczsKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzWzBdID0gZmVhdHVy
ZXNbMF07Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyIHw9IHZsYW5f
Z2V0X3J4X3N0YWdfZmlsdGVyX2luZm8oZGV2KTsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgfSBlbHNlIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bGFuX2Ry
b3Bfcnhfc3RhZ19maWx0ZXJfaW5mbyhkZXYpOwo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAg
ICB9Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgICAgICAgICBk
ZXYtPmZlYXR1cmVzID0gZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXZfZmVh
dHVyZXNfY29weShkZXYtPmZlYXR1cmVzLCBmZWF0dXJlcyk7Cj4gPiA+ICAgICAgICAgfQo+ID4g
Pgo+ID4gPiAgICAgICAgIHJldHVybiBlcnIgPCAwID8gMCA6IDE7Cj4gPiA+IEBAIC0xMDIxMyw3
ICsxMDIyMyw3IEBAIGludCByZWdpc3Rlcl9uZXRkZXZpY2Uoc3RydWN0IG5ldF9kZXZpY2UgKmRl
dikKPiA+ID4gICAgICAgICBpbnQgcmV0Owo+ID4gPiAgICAgICAgIHN0cnVjdCBuZXQgKm5ldCA9
IGRldl9uZXQoZGV2KTsKPiA+ID4KPiA+ID4gLSAgICAgICBCVUlMRF9CVUdfT04oc2l6ZW9mKG5l
dGRldl9mZWF0dXJlc190KSAqIEJJVFNfUEVSX0JZVEUgPAo+ID4gPiArICAgICAgIEJVSUxEX0JV
R19PTihzaXplb2YoZGV2LT5mZWF0dXJlcykgKiBCSVRTX1BFUl9CWVRFIDwKPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgTkVUREVWX0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAgICAgICAgIEJVR19P
TihkZXZfYm9vdF9waGFzZSk7Cj4gPiA+ICAgICAgICAgQVNTRVJUX1JUTkwoKTsKPiA+ID4gQEAg
LTEwMjUwLDcgKzEwMjYwLDcgQEAgaW50IHJlZ2lzdGVyX25ldGRldmljZShzdHJ1Y3QgbmV0X2Rl
dmljZSAqZGV2KQo+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4gPiAgICAgICAgIH0KPiA+ID4K
PiA+ID4gLSAgICAgICBpZiAoKChkZXYtPmh3X2ZlYXR1cmVzIHwgZGV2LT5mZWF0dXJlcykgJgo+
ID4gPiArICAgICAgIGlmICgoKGRldi0+aHdfZmVhdHVyZXNbMF0gfCBkZXYtPmZlYXR1cmVzWzBd
KSAmCj4gPiA+ICAgICAgICAgICAgICBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIpICYmCj4g
PiA+ICAgICAgICAgICAgICghZGV2LT5uZXRkZXZfb3BzLT5uZG9fdmxhbl9yeF9hZGRfdmlkIHx8
Cj4gPiA+ICAgICAgICAgICAgICAhZGV2LT5uZXRkZXZfb3BzLT5uZG9fdmxhbl9yeF9raWxsX3Zp
ZCkpIHsKPiA+ID4gQEAgLTEwMjY4LDQ0ICsxMDI3OCw0NiBAQCBpbnQgcmVnaXN0ZXJfbmV0ZGV2
aWNlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCj4gPiA+ICAgICAgICAgLyogVHJhbnNmZXIgY2hh
bmdlYWJsZSBmZWF0dXJlcyB0byB3YW50ZWRfZmVhdHVyZXMgYW5kIGVuYWJsZQo+ID4gPiAgICAg
ICAgICAqIHNvZnR3YXJlIG9mZmxvYWRzIChHU08gYW5kIEdSTykuCj4gPiA+ICAgICAgICAgICov
Cj4gPiA+IC0gICAgICAgZGV2LT5od19mZWF0dXJlcyB8PSAoTkVUSUZfRl9TT0ZUX0ZFQVRVUkVT
IHwgTkVUSUZfRl9TT0ZUX0ZFQVRVUkVTX09GRik7Cj4gPiA+IC0gICAgICAgZGV2LT5mZWF0dXJl
cyB8PSBORVRJRl9GX1NPRlRfRkVBVFVSRVM7Cj4gPiA+ICsgICAgICAgZGV2LT5od19mZWF0dXJl
c1swXSB8PQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAoTkVUSUZfRl9TT0ZUX0ZFQVRV
UkVTIHwgTkVUSUZfRl9TT0ZUX0ZFQVRVUkVTX09GRik7Cj4gPiA+ICsgICAgICAgZGV2LT5mZWF0
dXJlc1swXSB8PSBORVRJRl9GX1NPRlRfRkVBVFVSRVM7Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYg
KGRldi0+dWRwX3R1bm5lbF9uaWNfaW5mbykgewo+ID4gPiAtICAgICAgICAgICAgICAgZGV2LT5m
ZWF0dXJlcyB8PSBORVRJRl9GX1JYX1VEUF9UVU5ORUxfUE9SVDsKPiA+ID4gLSAgICAgICAgICAg
ICAgIGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9SWF9VRFBfVFVOTkVMX1BPUlQ7Cj4gPiA+
ICsgICAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfUlhfVURQX1RVTk5F
TF9QT1JUOwo+ID4gPiArICAgICAgICAgICAgICAgZGV2LT5od19mZWF0dXJlc1swXSB8PSBORVRJ
Rl9GX1JYX1VEUF9UVU5ORUxfUE9SVDsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAg
ICAgZGV2LT53YW50ZWRfZmVhdHVyZXMgPSBkZXYtPmZlYXR1cmVzICYgZGV2LT5od19mZWF0dXJl
czsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfYW5kKGRldi0+d2FudGVkX2ZlYXR1cmVz
LCBkZXYtPmZlYXR1cmVzLAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5o
d19mZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKCEoZGV2LT5mbGFncyAmIElGRl9M
T09QQkFDSykpCj4gPiA+IC0gICAgICAgICAgICAgICBkZXYtPmh3X2ZlYXR1cmVzIHw9IE5FVElG
X0ZfTk9DQUNIRV9DT1BZOwo+ID4gPiArICAgICAgICAgICAgICAgZGV2LT5od19mZWF0dXJlc1sw
XSB8PSBORVRJRl9GX05PQ0FDSEVfQ09QWTsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBJZiBJUHY0
IFRDUCBzZWdtZW50YXRpb24gb2ZmbG9hZCBpcyBzdXBwb3J0ZWQgd2Ugc2hvdWxkIGFsc28KPiA+
ID4gICAgICAgICAgKiBhbGxvdyB0aGUgZGV2aWNlIHRvIGVuYWJsZSBzZWdtZW50aW5nIHRoZSBm
cmFtZSB3aXRoIHRoZSBvcHRpb24KPiA+ID4gICAgICAgICAgKiBvZiBpZ25vcmluZyBhIHN0YXRp
YyBJUCBJRCB2YWx1ZS4gIFRoaXMgZG9lc24ndCBlbmFibGUgdGhlCj4gPiA+ICAgICAgICAgICog
ZmVhdHVyZSBpdHNlbGYgYnV0IGFsbG93cyB0aGUgdXNlciB0byBlbmFibGUgaXQgbGF0ZXIuCj4g
PiA+ICAgICAgICAgICovCj4gPiA+IC0gICAgICAgaWYgKGRldi0+aHdfZmVhdHVyZXMgJiBORVRJ
Rl9GX1RTTykKPiA+ID4gLSAgICAgICAgICAgICAgIGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZf
Rl9UU09fTUFOR0xFSUQ7Cj4gPiA+IC0gICAgICAgaWYgKGRldi0+dmxhbl9mZWF0dXJlcyAmIE5F
VElGX0ZfVFNPKQo+ID4gPiAtICAgICAgICAgICAgICAgZGV2LT52bGFuX2ZlYXR1cmVzIHw9IE5F
VElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPiAtICAgICAgIGlmIChkZXYtPm1wbHNfZmVhdHVyZXMg
JiBORVRJRl9GX1RTTykKPiA+ID4gLSAgICAgICAgICAgICAgIGRldi0+bXBsc19mZWF0dXJlcyB8
PSBORVRJRl9GX1RTT19NQU5HTEVJRDsKPiA+ID4gLSAgICAgICBpZiAoZGV2LT5od19lbmNfZmVh
dHVyZXMgJiBORVRJRl9GX1RTTykKPiA+ID4gLSAgICAgICAgICAgICAgIGRldi0+aHdfZW5jX2Zl
YXR1cmVzIHw9IE5FVElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPiArICAgICAgIGlmIChkZXYtPmh3
X2ZlYXR1cmVzWzBdICYgTkVUSUZfRl9UU08pCj4gPiA+ICsgICAgICAgICAgICAgICBkZXYtPmh3
X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPiArICAgICAgIGlmIChk
ZXYtPnZsYW5fZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RTTykKPiA+ID4gKyAgICAgICAgICAgICAg
IGRldi0+dmxhbl9mZWF0dXJlc1swXSB8PSBORVRJRl9GX1RTT19NQU5HTEVJRDsKPiA+ID4gKyAg
ICAgICBpZiAoZGV2LT5tcGxzX2ZlYXR1cmVzWzBdICYgTkVUSUZfRl9UU08pCj4gPiA+ICsgICAg
ICAgICAgICAgICBkZXYtPm1wbHNfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9UU09fTUFOR0xFSUQ7
Cj4gPiA+ICsgICAgICAgaWYgKGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdICYgTkVUSUZfRl9UU08p
Cj4gPiA+ICsgICAgICAgICAgICAgICBkZXYtPmh3X2VuY19mZWF0dXJlc1swXSB8PSBORVRJRl9G
X1RTT19NQU5HTEVJRDsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBNYWtlIE5FVElGX0ZfSElHSERN
QSBpbmhlcml0YWJsZSB0byBWTEFOIGRldmljZXMuCj4gPiA+ICAgICAgICAgICovCj4gPiA+IC0g
ICAgICAgZGV2LT52bGFuX2ZlYXR1cmVzIHw9IE5FVElGX0ZfSElHSERNQTsKPiA+ID4gKyAgICAg
ICBkZXYtPnZsYW5fZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9ISUdIRE1BOwo+ID4gPgo+ID4gPiAg
ICAgICAgIC8qIE1ha2UgTkVUSUZfRl9TRyBpbmhlcml0YWJsZSB0byB0dW5uZWwgZGV2aWNlcy4K
PiA+ID4gICAgICAgICAgKi8KPiA+ID4gLSAgICAgICBkZXYtPmh3X2VuY19mZWF0dXJlcyB8PSBO
RVRJRl9GX1NHIHwgTkVUSUZfRl9HU09fUEFSVElBTDsKPiA+ID4gKyAgICAgICBkZXYtPmh3X2Vu
Y19mZWF0dXJlc1swXSB8PSBORVRJRl9GX1NHIHwgTkVUSUZfRl9HU09fUEFSVElBTDsKPiA+ID4K
PiA+ID4gICAgICAgICAvKiBNYWtlIE5FVElGX0ZfU0cgaW5oZXJpdGFibGUgdG8gTVBMUy4KPiA+
ID4gICAgICAgICAgKi8KPiA+ID4gLSAgICAgICBkZXYtPm1wbHNfZmVhdHVyZXMgfD0gTkVUSUZf
Rl9TRzsKPiA+ID4gKyAgICAgICBkZXYtPm1wbHNfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9TRzsK
PiA+ID4KPiA+ID4gICAgICAgICByZXQgPSBjYWxsX25ldGRldmljZV9ub3RpZmllcnMoTkVUREVW
X1BPU1RfSU5JVCwgZGV2KTsKPiA+ID4gICAgICAgICByZXQgPSBub3RpZmllcl90b19lcnJubyhy
ZXQpOwo+ID4gPiBAQCAtMTExNDYsNyArMTExNTgsNyBAQCBpbnQgX19kZXZfY2hhbmdlX25ldF9u
YW1lc3BhY2Uoc3RydWN0Cj4gPiA+IG5ldF9kZXZpY2UgKmRldiwgc3RydWN0IG5ldCAqbmV0LAo+
ID4gPgo+ID4gPiAgICAgICAgIC8qIERvbid0IGFsbG93IG5hbWVzcGFjZSBsb2NhbCBkZXZpY2Vz
IHRvIGJlIG1vdmVkLiAqLwo+ID4gPiAgICAgICAgIGVyciA9IC1FSU5WQUw7Cj4gPiA+IC0gICAg
ICAgaWYgKGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX05FVE5TX0xPQ0FMKQo+ID4gPiArICAgICAg
IGlmIChkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9ORVROU19MT0NBTCkKPiA+ID4gICAgICAg
ICAgICAgICAgIGdvdG8gb3V0Owo+ID4gPgo+ID4gPiAgICAgICAgIC8qIEVuc3VyZSB0aGUgZGV2
aWNlIGhhcyBiZWVuIHJlZ2lzdHJlcmVkICovCj4gPiA+IEBAIC0xMTUwNiw3ICsxMTUxOCw3IEBA
IHN0YXRpYyB2b2lkIF9fbmV0X2V4aXQKPiA+ID4gZGVmYXVsdF9kZXZpY2VfZXhpdChzdHJ1Y3Qg
bmV0ICpuZXQpCj4gPiA+ICAgICAgICAgICAgICAgICBjaGFyIGZiX25hbWVbSUZOQU1TSVpdOwo+
ID4gPgo+ID4gPiAgICAgICAgICAgICAgICAgLyogSWdub3JlIHVubW92ZWFibGUgZGV2aWNlcyAo
aS5lLiBsb29wYmFjaykgKi8KPiA+ID4gLSAgICAgICAgICAgICAgIGlmIChkZXYtPmZlYXR1cmVz
ICYgTkVUSUZfRl9ORVROU19MT0NBTCkKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChkZXYtPmZl
YXR1cmVzWzBdICYgTkVUSUZfRl9ORVROU19MT0NBTCkKPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgY29udGludWU7Cj4gPiA+Cj4gPiA+ICAgICAgICAgICAgICAgICAvKiBMZWF2ZSB2aXJ0
dWFsIGRldmljZXMgZm9yIHRoZSBnZW5lcmljIGNsZWFudXAgKi8KPiA+ID4gZGlmZiAtLWdpdCBh
L25ldC9jb3JlL25ldHBvbGwuYyBiL25ldC9jb3JlL25ldHBvbGwuYwo+ID4gPiBpbmRleCAwYTZi
MDQ3Li4yYzBhZGY0IDEwMDY0NAo+ID4gPiAtLS0gYS9uZXQvY29yZS9uZXRwb2xsLmMKPiA+ID4g
KysrIGIvbmV0L2NvcmUvbmV0cG9sbC5jCj4gPiA+IEBAIC03NCwxMyArNzQsMTMgQEAgc3RhdGlj
IG5ldGRldl90eF90IG5ldHBvbGxfc3RhcnRfeG1pdChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IG5ldGRldl9xdWV1ZSAqdHhxKQo+ID4gPiAgewo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJl
c190IGZlYXR1cmVzW05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+ICAgICAgICAgbmV0ZGV2
X3R4X3Qgc3RhdHVzID0gTkVUREVWX1RYX09LOwo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJl
c190IGZlYXR1cmVzOwo+ID4gPgo+ID4gPiAtICAgICAgIGZlYXR1cmVzID0gbmV0aWZfc2tiX2Zl
YXR1cmVzKHNrYik7Cj4gPiA+ICsgICAgICAgbmV0aWZfc2tiX2ZlYXR1cmVzKHNrYiwgZmVhdHVy
ZXMpOwo+ID4gPgo+ID4gPiAgICAgICAgIGlmIChza2Jfdmxhbl90YWdfcHJlc2VudChza2IpICYm
Cj4gPiA+IC0gICAgICAgICAgICF2bGFuX2h3X29mZmxvYWRfY2FwYWJsZShmZWF0dXJlcywgc2ti
LT52bGFuX3Byb3RvKSkgewo+ID4gPiArICAgICAgICAgICAhdmxhbl9od19vZmZsb2FkX2NhcGFi
bGUoZmVhdHVyZXNbMF0sIHNrYi0+dmxhbl9wcm90bykpIHsKPiA+ID4gICAgICAgICAgICAgICAg
IHNrYiA9IF9fdmxhbl9od2FjY2VsX3B1c2hfaW5zaWRlKHNrYik7Cj4gPiA+ICAgICAgICAgICAg
ICAgICBpZiAodW5saWtlbHkoIXNrYikpIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
LyogVGhpcyBpcyBhY3R1YWxseSBhIHBhY2tldCBkcm9wLCBidXQgd2UKPiA+ID4gZGlmZiAtLWdp
dCBhL25ldC9ldGh0b29sL2ZlYXR1cmVzLmMgYi9uZXQvZXRodG9vbC9mZWF0dXJlcy5jCj4gPiA+
IGluZGV4IDFjOWY0ZGYuLjBlZWRiMTcgMTAwNjQ0Cj4gPiA+IC0tLSBhL25ldC9ldGh0b29sL2Zl
YXR1cmVzLmMKPiA+ID4gKysrIGIvbmV0L2V0aHRvb2wvZmVhdHVyZXMuYwo+ID4gPiBAQCAtMjUs
MTIgKzI1LDEzIEBAIGNvbnN0IHN0cnVjdCBubGFfcG9saWN5IGV0aG5sX2ZlYXR1cmVzX2dldF9w
b2xpY3lbXSA9IHsKPiA+ID4gICAgICAgICAgICAgICAgIE5MQV9QT0xJQ1lfTkVTVEVEKGV0aG5s
X2hlYWRlcl9wb2xpY3kpLAo+ID4gPiAgfTsKPiA+ID4KPiA+ID4gLXN0YXRpYyB2b2lkIGV0aG5s
X2ZlYXR1cmVzX3RvX2JpdG1hcDMyKHUzMiAqZGVzdCwgbmV0ZGV2X2ZlYXR1cmVzX3Qgc3JjKQo+
ID4gPiArc3RhdGljIHZvaWQgZXRobmxfZmVhdHVyZXNfdG9fYml0bWFwMzIodTMyICpkZXN0LCBu
ZXRkZXZfZmVhdHVyZXNfdCAqc3JjKQo+ID4gPiAgewo+ID4gPiArICAgICAgIHUzMiAqX19zcmMg
PSAodTMyICopc3JjOwo+ID4gPiAgICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPgo+ID4gPiAg
ICAgICAgIGZvciAoaSA9IDA7IGkgPCBFVEhUT09MX0RFVl9GRUFUVVJFX1dPUkRTOyBpKyspCj4g
PiA+IC0gICAgICAgICAgICAgICBkZXN0W2ldID0gc3JjID4+ICgzMiAqIGkpOwo+ID4gPiArICAg
ICAgICAgICAgICAgZGVzdFtpXSA9IF9fc3JjW2ldOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3Rh
dGljIGludCBmZWF0dXJlc19wcmVwYXJlX2RhdGEoY29uc3Qgc3RydWN0IGV0aG5sX3JlcV9pbmZv
ICpyZXFfYmFzZSwKPiA+ID4gQEAgLTM4LDE1ICszOSwyMyBAQCBzdGF0aWMgaW50IGZlYXR1cmVz
X3ByZXBhcmVfZGF0YShjb25zdCBzdHJ1Y3QKPiA+ID4gZXRobmxfcmVxX2luZm8gKnJlcV9iYXNl
LAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZ2VubF9pbmZv
ICppbmZvKQo+ID4gPiAgewo+ID4gPiAgICAgICAgIHN0cnVjdCBmZWF0dXJlc19yZXBseV9kYXRh
ICpkYXRhID0gRkVBVFVSRVNfUkVQREFUQShyZXBseV9iYXNlKTsKPiA+ID4gKyAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfdCBmZWF0dXJlc1tORVRERVZfRkVBVFVSRV9EV09SRFNdID0gezB9Owo+ID4g
PiAgICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSByZXBseV9iYXNlLT5kZXY7Cj4gPiA+
IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgYWxsX2ZlYXR1cmVzOwo+ID4gPiArICAgICAgIHVu
c2lnbmVkIGludCBpOwo+ID4gPgo+ID4gPiAgICAgICAgIGV0aG5sX2ZlYXR1cmVzX3RvX2JpdG1h
cDMyKGRhdGEtPmh3LCBkZXYtPmh3X2ZlYXR1cmVzKTsKPiA+ID4gICAgICAgICBldGhubF9mZWF0
dXJlc190b19iaXRtYXAzMihkYXRhLT53YW50ZWQsIGRldi0+d2FudGVkX2ZlYXR1cmVzKTsKPiA+
ID4gICAgICAgICBldGhubF9mZWF0dXJlc190b19iaXRtYXAzMihkYXRhLT5hY3RpdmUsIGRldi0+
ZmVhdHVyZXMpOwo+ID4gPiAtICAgICAgIGV0aG5sX2ZlYXR1cmVzX3RvX2JpdG1hcDMyKGRhdGEt
Pm5vY2hhbmdlLCBORVRJRl9GX05FVkVSX0NIQU5HRSk7Cj4gPiA+IC0gICAgICAgYWxsX2ZlYXR1
cmVzID0gR0VOTUFTS19VTEwoTkVUREVWX0ZFQVRVUkVfQ09VTlQgLSAxLCAwKTsKPiA+ID4gLSAg
ICAgICBldGhubF9mZWF0dXJlc190b19iaXRtYXAzMihkYXRhLT5hbGwsIGFsbF9mZWF0dXJlcyk7
Cj4gPiA+ICsgICAgICAgZmVhdHVyZXNbMF0gPSBORVRJRl9GX05FVkVSX0NIQU5HRTsKPiA+ID4g
KyAgICAgICBldGhubF9mZWF0dXJlc190b19iaXRtYXAzMihkYXRhLT5ub2NoYW5nZSwgZmVhdHVy
ZXMpOwo+ID4gPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBORVRERVZfRkVBVFVSRV9EV09SRFM7
IGkrKykgewo+ID4gPiArICAgICAgICAgICAgICAgaWYgKE5FVERFVl9GRUFUVVJFX0NPVU5UID49
IChpICsgMSkgKiA2NCkKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXNbaV0g
PSBHRU5NQVNLX1VMTCg2MywgMCk7Cj4gPiA+ICsgICAgICAgICAgICAgICBlbHNlCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzW2ldID0gR0VOTUFTS19VTEwoTkVUREVWX0ZF
QVRVUkVfQ09VTlQgLSBpICogNjQsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgMCk7Cj4gPiA+ICsgICAgICAgfQo+ID4gPiArICAgICAgIGV0
aG5sX2ZlYXR1cmVzX3RvX2JpdG1hcDMyKGRhdGEtPmFsbCwgZmVhdHVyZXMpOwo+ID4gPgo+ID4g
PiAgICAgICAgIHJldHVybiAwOwo+ID4gPiAgfQo+ID4gPiBAQCAtMTMxLDI3ICsxNDAsMjkgQEAg
Y29uc3Qgc3RydWN0IG5sYV9wb2xpY3kgZXRobmxfZmVhdHVyZXNfc2V0X3BvbGljeVtdID0gewo+
ID4gPiAgICAgICAgIFtFVEhUT09MX0FfRkVBVFVSRVNfV0FOVEVEXSAgICAgPSB7IC50eXBlID0g
TkxBX05FU1RFRCB9LAo+ID4gPiAgfTsKPiA+ID4KPiA+ID4gLXN0YXRpYyB2b2lkIGV0aG5sX2Zl
YXR1cmVzX3RvX2JpdG1hcCh1bnNpZ25lZCBsb25nICpkZXN0LAo+ID4gPiBuZXRkZXZfZmVhdHVy
ZXNfdCB2YWwpCj4gPiA+ICtzdGF0aWMgdm9pZCBldGhubF9mZWF0dXJlc190b19iaXRtYXAodW5z
aWduZWQgbG9uZyAqZGVzdCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG5ldGRldl9mZWF0dXJlc190ICp2YWwpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgY29uc3Qg
dW5zaWduZWQgaW50IHdvcmRzID0gQklUU19UT19MT05HUyhORVRERVZfRkVBVFVSRV9DT1VOVCk7
Cj4gPiA+ICAgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgYml0bWFw
X3plcm8oZGVzdCwgTkVUREVWX0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAgICAgICAgIGZvciAoaSA9
IDA7IGkgPCB3b3JkczsgaSsrKQo+ID4gPiAtICAgICAgICAgICAgICAgZGVzdFtpXSA9ICh1bnNp
Z25lZCBsb25nKSh2YWwgPj4gKGkgKiBCSVRTX1BFUl9MT05HKSk7Cj4gPiA+ICsgICAgICAgICAg
ICAgICBkZXN0W2ldID0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgKHVuc2lnbmVkIGxv
bmcpKHZhbFtpIC8gMl0gPj4gKGkgJSAyICogQklUU19QRVJfTE9ORykpOwo+ID4gPiAgfQo+ID4g
Pgo+ID4gPiAtc3RhdGljIG5ldGRldl9mZWF0dXJlc190IGV0aG5sX2JpdG1hcF90b19mZWF0dXJl
cyh1bnNpZ25lZCBsb25nICpzcmMpCj4gPiA+ICtzdGF0aWMgdm9pZCBldGhubF9iaXRtYXBfdG9f
ZmVhdHVyZXMobmV0ZGV2X2ZlYXR1cmVzX3QgKnZhbCwgdW5zaWduZWQKPiA+ID4gbG9uZyAqc3Jj
KQo+ID4gPiAgewo+ID4gPiAtICAgICAgIGNvbnN0IHVuc2lnbmVkIGludCBuZnRfYml0cyA9IHNp
emVvZihuZXRkZXZfZmVhdHVyZXNfdCkgKiBCSVRTX1BFUl9CWVRFOwo+ID4gPiAgICAgICAgIGNv
bnN0IHVuc2lnbmVkIGludCB3b3JkcyA9IEJJVFNfVE9fTE9OR1MoTkVUREVWX0ZFQVRVUkVfQ09V
TlQpOwo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IHJldCA9IDA7Cj4gPiA+ICAgICAg
ICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+Cj4gPiA+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5F
VERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+ID4gPiArICAgICAgICAgICAgICAgdmFsW2ldID0g
MDsKPiA+ID4gKwo+ID4gPiAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB3b3JkczsgaSsrKQo+ID4g
PiAtICAgICAgICAgICAgICAgcmV0IHw9IChuZXRkZXZfZmVhdHVyZXNfdCkoc3JjW2ldKSA8PCAo
aSAqIEJJVFNfUEVSX0xPTkcpOwo+ID4gPiAtICAgICAgIHJldCAmPSB+KG5ldGRldl9mZWF0dXJl
c190KTAgPj4gKG5mdF9iaXRzIC0gTkVUREVWX0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAtICAgICAg
IHJldHVybiByZXQ7Cj4gPiA+ICsgICAgICAgICAgICAgICB2YWxbaSAvIDJdIHw9Cj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIChuZXRkZXZfZmVhdHVyZXNfdCkoc3JjW2ldKSA8PCAoaSAl
IDIgKiBCSVRTX1BFUl9MT05HKTsKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIHN0YXRpYyBpbnQgZmVh
dHVyZXNfc2VuZF9yZXBseShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgZ2VubF9pbmZv
ICppbmZvLAo+ID4gPiBAQCAtMjEyLDEyICsyMjMsMTQgQEAgaW50IGV0aG5sX3NldF9mZWF0dXJl
cyhzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPiBzdHJ1Y3QgZ2VubF9pbmZvICppbmZvKQo+ID4g
PiAgewo+ID4gPiAgICAgICAgIERFQ0xBUkVfQklUTUFQKHdhbnRlZF9kaWZmX21hc2ssIE5FVERF
Vl9GRUFUVVJFX0NPVU5UKTsKPiA+ID4gICAgICAgICBERUNMQVJFX0JJVE1BUChhY3RpdmVfZGlm
Zl9tYXNrLCBORVRERVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX3QgZmVhdHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4gICAgICAgICBERUNM
QVJFX0JJVE1BUChvbGRfYWN0aXZlLCBORVRERVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+ICAgICAg
ICAgREVDTEFSRV9CSVRNQVAob2xkX3dhbnRlZCwgTkVUREVWX0ZFQVRVUkVfQ09VTlQpOwo+ID4g
PiAgICAgICAgIERFQ0xBUkVfQklUTUFQKG5ld19hY3RpdmUsIE5FVERFVl9GRUFUVVJFX0NPVU5U
KTsKPiA+ID4gICAgICAgICBERUNMQVJFX0JJVE1BUChuZXdfd2FudGVkLCBORVRERVZfRkVBVFVS
RV9DT1VOVCk7Cj4gPiA+ICAgICAgICAgREVDTEFSRV9CSVRNQVAocmVxX3dhbnRlZCwgTkVUREVW
X0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAgICAgICAgIERFQ0xBUkVfQklUTUFQKHJlcV9tYXNrLCBO
RVRERVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgdG1w
W05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+ICAgICAgICAgc3RydWN0IGV0aG5sX3JlcV9p
bmZvIHJlcV9pbmZvID0ge307Cj4gPiA+ICAgICAgICAgc3RydWN0IG5sYXR0ciAqKnRiID0gaW5m
by0+YXR0cnM7Cj4gPiA+ICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldjsKPiA+ID4gQEAg
LTI0Miw3ICsyNTUsMTEgQEAgaW50IGV0aG5sX3NldF9mZWF0dXJlcyhzdHJ1Y3Qgc2tfYnVmZiAq
c2tiLAo+ID4gPiBzdHJ1Y3QgZ2VubF9pbmZvICppbmZvKQo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfc3RyaW5ncywgaW5mby0+ZXh0YWNrKTsK
PiA+ID4gICAgICAgICBpZiAocmV0IDwgMCkKPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gb3V0
X3J0bmw7Cj4gPiA+IC0gICAgICAgaWYgKGV0aG5sX2JpdG1hcF90b19mZWF0dXJlcyhyZXFfbWFz
aykgJiB+TkVUSUZfRl9FVEhUT09MX0JJVFMpIHsKPiA+ID4gKwo+ID4gPiArICAgICAgIGV0aG5s
X2JpdG1hcF90b19mZWF0dXJlcyhmZWF0dXJlcywgcmVxX21hc2spOwo+ID4gPiArICAgICAgIG5l
dGRldl9mZWF0dXJlc19ldGh0b29sX2JpdHModG1wKTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVh
dHVyZXNfYW5kbm90KGZlYXR1cmVzLCBmZWF0dXJlcywgdG1wKTsKPiA+ID4gKyAgICAgICBpZiAo
IW5ldGRldl9mZWF0dXJlc19lbXB0eShmZWF0dXJlcykpIHsKPiA+ID4gICAgICAgICAgICAgICAg
IEdFTkxfU0VUX0VSUl9NU0coaW5mbywgImF0dGVtcHQgdG8gY2hhbmdlIG5vbi1ldGh0b29sCj4g
PiA+IGZlYXR1cmVzIik7Cj4gPiA+ICAgICAgICAgICAgICAgICByZXQgPSAtRUlOVkFMOwo+ID4g
PiAgICAgICAgICAgICAgICAgZ290byBvdXRfcnRubDsKPiA+ID4gQEAgLTI1Myw4ICsyNzAsMTMg
QEAgaW50IGV0aG5sX3NldF9mZWF0dXJlcyhzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPiBzdHJ1
Y3QgZ2VubF9pbmZvICppbmZvKQo+ID4gPiAgICAgICAgIGJpdG1hcF9hbmRub3QobmV3X3dhbnRl
ZCwgb2xkX3dhbnRlZCwgcmVxX21hc2ssIE5FVERFVl9GRUFUVVJFX0NPVU5UKTsKPiA+ID4gICAg
ICAgICBiaXRtYXBfb3IocmVxX3dhbnRlZCwgbmV3X3dhbnRlZCwgcmVxX3dhbnRlZCwgTkVUREVW
X0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAgICAgICAgIGlmICghYml0bWFwX2VxdWFsKHJlcV93YW50
ZWQsIG9sZF93YW50ZWQsIE5FVERFVl9GRUFUVVJFX0NPVU5UKSkgewo+ID4gPiAtICAgICAgICAg
ICAgICAgZGV2LT53YW50ZWRfZmVhdHVyZXMgJj0gfmRldi0+aHdfZmVhdHVyZXM7Cj4gPiA+IC0g
ICAgICAgICAgICAgICBkZXYtPndhbnRlZF9mZWF0dXJlcyB8PQo+ID4gPiBldGhubF9iaXRtYXBf
dG9fZmVhdHVyZXMocmVxX3dhbnRlZCkgJiBkZXYtPmh3X2ZlYXR1cmVzOwo+ID4gPiArICAgICAg
ICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2FuZG5vdChkZXYtPndhbnRlZF9mZWF0dXJlcywKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT53YW50ZWRfZmVh
dHVyZXMsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+
aHdfZmVhdHVyZXMpOwo+ID4gPiArICAgICAgICAgICAgICAgZXRobmxfYml0bWFwX3RvX2ZlYXR1
cmVzKGZlYXR1cmVzLCByZXFfd2FudGVkKTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9m
ZWF0dXJlc19hbmQoZmVhdHVyZXMsIGZlYXR1cmVzLCBkZXYtPmh3X2ZlYXR1cmVzKTsKPiA+ID4g
KyAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc19vcihkZXYtPndhbnRlZF9mZWF0dXJlcywg
ZGV2LT53YW50ZWRfZmVhdHVyZXMsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZmVhdHVyZXMpOwo+ID4gPiAgICAgICAgICAgICAgICAgX19uZXRkZXZfdXBkYXRlX2Zl
YXR1cmVzKGRldik7Cj4gPiA+ICAgICAgICAgfQo+ID4gPiAgICAgICAgIGV0aG5sX2ZlYXR1cmVz
X3RvX2JpdG1hcChuZXdfYWN0aXZlLCBkZXYtPmZlYXR1cmVzKTsKPiA+ID4gZGlmZiAtLWdpdCBh
L25ldC9ldGh0b29sL2lvY3RsLmMgYi9uZXQvZXRodG9vbC9pb2N0bC5jCj4gPiA+IGluZGV4IGJh
YTVkMTAuLmYyMTNlYzkgMTAwNjQ0Cj4gPiA+IC0tLSBhL25ldC9ldGh0b29sL2lvY3RsLmMKPiA+
ID4gKysrIGIvbmV0L2V0aHRvb2wvaW9jdGwuYwo+ID4gPiBAQCAtNjcsMTIgKzY3LDE1IEBAIHN0
YXRpYyBpbnQgZXRodG9vbF9nZXRfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UKPiA+ID4gKmRl
diwgdm9pZCBfX3VzZXIgKnVzZXJhZGRyKQo+ID4gPiAgICAgICAgIGludCBpOwo+ID4gPgo+ID4g
PiAgICAgICAgIC8qIGluIGNhc2UgZmVhdHVyZSBiaXRzIHJ1biBvdXQgYWdhaW4gKi8KPiA+ID4g
LSAgICAgICBCVUlMRF9CVUdfT04oRVRIVE9PTF9ERVZfRkVBVFVSRV9XT1JEUyAqIHNpemVvZih1
MzIpID4KPiA+ID4gc2l6ZW9mKG5ldGRldl9mZWF0dXJlc190KSk7Cj4gPiA+ICsgICAgICAgQlVJ
TERfQlVHX09OKEVUSFRPT0xfREVWX0ZFQVRVUkVfV09SRFMgKiBzaXplb2YodTMyKSA+Cj4gPiA+
IHNpemVvZihkZXYtPmZlYXR1cmVzKSk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgZm9yIChpID0gMDsg
aSA8IEVUSFRPT0xfREVWX0ZFQVRVUkVfV09SRFM7ICsraSkgewo+ID4gPiAtICAgICAgICAgICAg
ICAgZmVhdHVyZXNbaV0uYXZhaWxhYmxlID0gKHUzMikoZGV2LT5od19mZWF0dXJlcyA+PiAoMzIg
KiBpKSk7Cj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlc1tpXS5yZXF1ZXN0ZWQgPSAodTMy
KShkZXYtPndhbnRlZF9mZWF0dXJlcyA+PiAoMzIgKiBpKSk7Cj4gPiA+IC0gICAgICAgICAgICAg
ICBmZWF0dXJlc1tpXS5hY3RpdmUgPSAodTMyKShkZXYtPmZlYXR1cmVzID4+ICgzMiAqIGkpKTsK
PiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzW2ldLmF2YWlsYWJsZSA9Cj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICh1MzIpKGRldi0+aHdfZmVhdHVyZXNbaSAvIDJdID4+IChpICUg
MiAqIDMyKSk7Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1tpXS5yZXF1ZXN0ZWQgPQo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAodTMyKShkZXYtPndhbnRlZF9mZWF0dXJlc1tp
IC8gMl0gPj4gKGkgJSAyICogMzIpKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzW2ld
LmFjdGl2ZSA9Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICh1MzIpKGRldi0+ZmVhdHVy
ZXNbaSAvIDJdID4+IChpICUgMiAqIDMyKSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBmZWF0dXJl
c1tpXS5uZXZlcl9jaGFuZ2VkID0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgKHUzMiko
TkVUSUZfRl9ORVZFUl9DSEFOR0UgPj4gKDMyICogaSkpOwo+ID4gPiAgICAgICAgIH0KPiA+ID4g
QEAgLTk3LDcgKzEwMCw5IEBAIHN0YXRpYyBpbnQgZXRodG9vbF9zZXRfZmVhdHVyZXMoc3RydWN0
IG5ldF9kZXZpY2UKPiA+ID4gKmRldiwgdm9pZCBfX3VzZXIgKnVzZXJhZGRyKQo+ID4gPiAgewo+
ID4gPiAgICAgICAgIHN0cnVjdCBldGh0b29sX3NmZWF0dXJlcyBjbWQ7Cj4gPiA+ICAgICAgICAg
c3RydWN0IGV0aHRvb2xfc2V0X2ZlYXR1cmVzX2Jsb2NrIGZlYXR1cmVzW0VUSFRPT0xfREVWX0ZF
QVRVUkVfV09SRFNdOwo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IHdhbnRlZCA9IDAs
IHZhbGlkID0gMDsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCB3YW50ZWRbTkVUREVW
X0ZFQVRVUkVfRFdPUkRTXSA9IHswfTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCB2
YWxpZFtORVRERVZfRkVBVFVSRV9EV09SRFNdID0gezB9Owo+ID4gPiArICAgICAgIG5ldGRldl9m
ZWF0dXJlc190IHRtcFtORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+ID4gPiAgICAgICAgIGludCBp
LCByZXQgPSAwOwo+ID4gPgo+ID4gPiAgICAgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmY21kLCB1
c2VyYWRkciwgc2l6ZW9mKGNtZCkpKQo+ID4gPiBAQCAtMTExLDIzICsxMTYsMzMgQEAgc3RhdGlj
IGludCBldGh0b29sX3NldF9mZWF0dXJlcyhzdHJ1Y3QKPiA+ID4gbmV0X2RldmljZSAqZGV2LCB2
b2lkIF9fdXNlciAqdXNlcmFkZHIpCj4gPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVGQVVM
VDsKPiA+ID4KPiA+ID4gICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRVRIVE9PTF9ERVZfRkVBVFVS
RV9XT1JEUzsgKytpKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICB2YWxpZCB8PSAobmV0ZGV2X2Zl
YXR1cmVzX3QpZmVhdHVyZXNbaV0udmFsaWQgPDwgKDMyICogaSk7Cj4gPiA+IC0gICAgICAgICAg
ICAgICB3YW50ZWQgfD0gKG5ldGRldl9mZWF0dXJlc190KWZlYXR1cmVzW2ldLnJlcXVlc3RlZCA8
PCAoMzIgKiBpKTsKPiA+ID4gKyAgICAgICAgICAgICAgIHZhbGlkW2kgLyAyXSB8PQo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAobmV0ZGV2X2ZlYXR1cmVzX3QpZmVhdHVyZXNbaV0udmFs
aWQgPDwgKDMyICogaSk7Cj4gPiA+ICsgICAgICAgICAgICAgICB3YW50ZWRbaSAvIDJdIHw9Cj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIChuZXRkZXZfZmVhdHVyZXNfdClmZWF0dXJlc1tp
XS5yZXF1ZXN0ZWQgPDwgKDMyICogaSk7Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAtICAg
ICAgIGlmICh2YWxpZCAmIH5ORVRJRl9GX0VUSFRPT0xfQklUUykKPiA+ID4gKyAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfZXRodG9vbF9iaXRzKHRtcCk7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX2FuZG5vdCh0bXAsIGZlYXR1cmVzLCB0bXApOwo+ID4gPiArICAgICAgIGlmICghbmV0ZGV2
X2ZlYXR1cmVzX2VtcHR5KHRtcCkpCj4gPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZB
TDsKPiA+ID4KPiA+ID4gLSAgICAgICBpZiAodmFsaWQgJiB+ZGV2LT5od19mZWF0dXJlcykgewo+
ID4gPiAtICAgICAgICAgICAgICAgdmFsaWQgJj0gZGV2LT5od19mZWF0dXJlczsKPiA+ID4gKyAg
ICAgICBuZXRkZXZfZmVhdHVyZXNfYW5kbm90KHRtcCwgdmFsaWQsIGRldi0+aHdfZmVhdHVyZXMp
Owo+ID4gPiArCj4gPiA+ICsgICAgICAgaWYgKCFuZXRkZXZfZmVhdHVyZXNfZW1wdHkodG1wKSkg
ewo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2FuZCh2YWxpZCwgdmFsaWQs
IGRldi0+aHdfZmVhdHVyZXMpOwo+ID4gPiAgICAgICAgICAgICAgICAgcmV0IHw9IEVUSFRPT0xf
Rl9VTlNVUFBPUlRFRDsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgZGV2LT53
YW50ZWRfZmVhdHVyZXMgJj0gfnZhbGlkOwo+ID4gPiAtICAgICAgIGRldi0+d2FudGVkX2ZlYXR1
cmVzIHw9IHdhbnRlZCAmIHZhbGlkOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc19hbmRu
b3QoZGV2LT53YW50ZWRfZmVhdHVyZXMsIGRldi0+d2FudGVkX2ZlYXR1cmVzLAo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWQpOwo+ID4gPiArICAgICAgIG5ldGRldl9m
ZWF0dXJlc19hbmQod2FudGVkLCB3YW50ZWQsIHZhbGlkKTsKPiA+ID4gKyAgICAgICBuZXRkZXZf
ZmVhdHVyZXNfb3IoZGV2LT53YW50ZWRfZmVhdHVyZXMsIGRldi0+d2FudGVkX2ZlYXR1cmVzLCB3
YW50ZWQpOwo+ID4gPiAgICAgICAgIF9fbmV0ZGV2X3VwZGF0ZV9mZWF0dXJlcyhkZXYpOwo+ID4g
Pgo+ID4gPiAtICAgICAgIGlmICgoZGV2LT53YW50ZWRfZmVhdHVyZXMgXiBkZXYtPmZlYXR1cmVz
KSAmIHZhbGlkKQo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc194b3IodG1wLCBkZXYtPndh
bnRlZF9mZWF0dXJlcywgZGV2LT5mZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX2FuZCh0bXAsIHRtcCwgdmFsaWQpOwo+ID4gPiArICAgICAgIGlmICghbmV0ZGV2X2ZlYXR1
cmVzX2VtcHR5KHRtcCkpCj4gPiA+ICAgICAgICAgICAgICAgICByZXQgfD0gRVRIVE9PTF9GX1dJ
U0g7Cj4gPiA+Cj4gPiA+ICAgICAgICAgcmV0dXJuIHJldDsKPiA+ID4gQEAgLTIyNyw3ICsyNDIs
NyBAQCBzdGF0aWMgaW50IGV0aHRvb2xfZ2V0X29uZV9mZWF0dXJlKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCj4gPiA+ICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgbWFzayA9IGV0aHRvb2xfZ2V0
X2ZlYXR1cmVfbWFzayhldGhjbWQpOwo+ID4gPiAgICAgICAgIHN0cnVjdCBldGh0b29sX3ZhbHVl
IGVkYXRhID0gewo+ID4gPiAgICAgICAgICAgICAgICAgLmNtZCA9IGV0aGNtZCwKPiA+ID4gLSAg
ICAgICAgICAgICAgIC5kYXRhID0gISEoZGV2LT5mZWF0dXJlcyAmIG1hc2spLAo+ID4gPiArICAg
ICAgICAgICAgICAgLmRhdGEgPSAhIShkZXYtPmZlYXR1cmVzWzBdICYgbWFzayksCj4gPiA+ICAg
ICAgICAgfTsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCAm
ZWRhdGEsIHNpemVvZihlZGF0YSkpKQo+ID4gPiBAQCAtMjM4LDIxICsyNTMsMjMgQEAgc3RhdGlj
IGludCBldGh0b29sX2dldF9vbmVfZmVhdHVyZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4g
PiAgc3RhdGljIGludCBldGh0b29sX3NldF9vbmVfZmVhdHVyZShzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2LAo+ID4gPiAgICAgICAgIHZvaWQgX191c2VyICp1c2VyYWRkciwgdTMyIGV0aGNtZCkKPiA+
ID4gIHsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBtYXNrW05FVERFVl9GRUFUVVJF
X0RXT1JEU10gPSB7MH07Cj4gPiA+ICAgICAgICAgc3RydWN0IGV0aHRvb2xfdmFsdWUgZWRhdGE7
Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgbWFzazsKPiA+ID4KPiA+ID4gICAgICAg
ICBpZiAoY29weV9mcm9tX3VzZXIoJmVkYXRhLCB1c2VyYWRkciwgc2l6ZW9mKGVkYXRhKSkpCj4g
PiA+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsKPiA+ID4KPiA+ID4gLSAgICAgICBt
YXNrID0gZXRodG9vbF9nZXRfZmVhdHVyZV9tYXNrKGV0aGNtZCk7Cj4gPiA+IC0gICAgICAgbWFz
ayAmPSBkZXYtPmh3X2ZlYXR1cmVzOwo+ID4gPiAtICAgICAgIGlmICghbWFzaykKPiA+ID4gKyAg
ICAgICBtYXNrWzBdID0gZXRodG9vbF9nZXRfZmVhdHVyZV9tYXNrKGV0aGNtZCk7Cj4gPiA+ICsg
ICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2FuZChtYXNrLCBtYXNrLCBkZXYtPmh3X2ZlYXR1cmVzKTsK
PiA+ID4gKyAgICAgICBpZiAobmV0ZGV2X2ZlYXR1cmVzX2VtcHR5KG1hc2spKQo+ID4gPiAgICAg
ICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOwo+ID4gPgo+ID4gPiAgICAgICAgIGlmIChl
ZGF0YS5kYXRhKQo+ID4gPiAtICAgICAgICAgICAgICAgZGV2LT53YW50ZWRfZmVhdHVyZXMgfD0g
bWFzazsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc19vcihkZXYtPndhbnRl
ZF9mZWF0dXJlcywgZGV2LT53YW50ZWRfZmVhdHVyZXMsCj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbWFzaykKPiA+ID4gICAgICAgICBlbHNlCj4gPiA+IC0gICAgICAg
ICAgICAgICBkZXYtPndhbnRlZF9mZWF0dXJlcyAmPSB+bWFzazsKPiA+ID4gKyAgICAgICAgICAg
ICAgIG5ldGRldl9mZWF0dXJlc19hbmRub3QoZGV2LT53YW50ZWRfZmVhdHVyZXMsCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+d2FudGVkX2ZlYXR1cmVz
LCBtYXNrKTsKPiA+ID4KPiA+ID4gICAgICAgICBfX25ldGRldl91cGRhdGVfZmVhdHVyZXMoZGV2
KTsKPiA+ID4KPiA+ID4gQEAgLTI4NSwyOSArMzAyLDM3IEBAIHN0YXRpYyB1MzIgX19ldGh0b29s
X2dldF9mbGFncyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPgo+ID4gPiAgc3RhdGljIGlu
dCBfX2V0aHRvb2xfc2V0X2ZsYWdzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHUzMiBkYXRhKQo+
ID4gPiAgewo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzID0gMCwgY2hh
bmdlZDsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlc1tORVRERVZfRkVB
VFVSRV9EV09SRFNdID0gezB9Owo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190IGNoYW5n
ZWRbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNf
dCB0bXBbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAoZGF0
YSAmIH5FVEhfQUxMX0ZMQUdTKQo+ID4gPiAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKGRhdGEgJiBFVEhfRkxBR19MUk8pCj4gPiA+IC0gICAg
ICAgICAgICAgICBmZWF0dXJlcyB8PSBORVRJRl9GX0xSTzsKPiA+ID4gKyAgICAgICAgICAgICAg
IGZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfTFJPOwo+ID4gPiAgICAgICAgIGlmIChkYXRhICYgRVRI
X0ZMQUdfUlhWTEFOKQo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgfD0gTkVUSUZfRl9I
V19WTEFOX0NUQUdfUlg7Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1swXSB8PSBORVRJ
Rl9GX0hXX1ZMQU5fQ1RBR19SWDsKPiA+ID4gICAgICAgICBpZiAoZGF0YSAmIEVUSF9GTEFHX1RY
VkxBTikKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzIHw9IE5FVElGX0ZfSFdfVkxBTl9D
VEFHX1RYOwo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9IV19W
TEFOX0NUQUdfVFg7Cj4gPiA+ICAgICAgICAgaWYgKGRhdGEgJiBFVEhfRkxBR19OVFVQTEUpCj4g
PiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyB8PSBORVRJRl9GX05UVVBMRTsKPiA+ID4gKyAg
ICAgICAgICAgICAgIGZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfTlRVUExFOwo+ID4gPiAgICAgICAg
IGlmIChkYXRhICYgRVRIX0ZMQUdfUlhIQVNIKQo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVy
ZXMgfD0gTkVUSUZfRl9SWEhBU0g7Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1swXSB8
PSBORVRJRl9GX1JYSEFTSDsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBhbGxvdyBjaGFuZ2luZyBv
bmx5IGJpdHMgc2V0IGluIGh3X2ZlYXR1cmVzICovCj4gPiA+IC0gICAgICAgY2hhbmdlZCA9IChm
ZWF0dXJlcyBeIGRldi0+ZmVhdHVyZXMpICYgRVRIX0FMTF9GRUFUVVJFUzsKPiA+ID4gLSAgICAg
ICBpZiAoY2hhbmdlZCAmIH5kZXYtPmh3X2ZlYXR1cmVzKQo+ID4gPiAtICAgICAgICAgICAgICAg
cmV0dXJuIChjaGFuZ2VkICYgZGV2LT5od19mZWF0dXJlcykgPyAtRUlOVkFMIDogLUVPUE5PVFNV
UFA7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3hvcihjaGFuZ2VkLCBmZWF0dXJlcywg
ZGV2LT5mZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgY2hhbmdlZFswXSAmPSBFVEhfQUxMX0ZFQVRV
UkVTOwo+ID4gPiArCj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2FuZG5vdCh0bXAsIGNo
YW5nZWQsIGRldi0+aHdfZmVhdHVyZXMpOwo+ID4gPiArICAgICAgIGlmICghbmV0ZGV2X2ZlYXR1
cmVzX2VtcHR5KHRtcCkpIHsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc19h
bmQodG1wLCBjaGFuZ2VkLCBkZXYtPmh3X2ZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICAgICAgICAg
IHJldHVybiAoIW5ldGRldl9mZWF0dXJlc19lbXB0eSh0bXApKSA/IC1FSU5WQUwgOiAtRU9QTk9U
U1VQUDsKPiA+ID4gKyAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgZGV2LT53YW50ZWRfZmVh
dHVyZXMgPQo+ID4gPiAtICAgICAgICAgICAgICAgKGRldi0+d2FudGVkX2ZlYXR1cmVzICYgfmNo
YW5nZWQpIHwgKGZlYXR1cmVzICYgY2hhbmdlZCk7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX2FuZG5vdCh0bXAsIGRldi0+d2FudGVkX2ZlYXR1cmVzLCBjaGFuZ2VkKTsKPiA+ID4gKyAg
ICAgICBuZXRkZXZfZmVhdHVyZXNfYW5kKGZlYXR1cmVzLCBmZWF0dXJlcywgY2hhbmdlZCk7Cj4g
PiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX29yKGRldi0+d2FudGVkX2ZlYXR1cmVzLCB0bXAs
IGZlYXR1cmVzKTsKPiA+ID4KPiA+ID4gICAgICAgICBfX25ldGRldl91cGRhdGVfZmVhdHVyZXMo
ZGV2KTsKPiA+ID4KPiA+ID4gQEAgLTI1ODcsNyArMjYxMiw3IEBAIGludCBkZXZfZXRodG9vbChz
dHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCBpZnJlcSAqaWZyKQo+ID4gPiAgICAgICAgIHZvaWQgX191
c2VyICp1c2VyYWRkciA9IGlmci0+aWZyX2RhdGE7Cj4gPiA+ICAgICAgICAgdTMyIGV0aGNtZCwg
c3ViX2NtZDsKPiA+ID4gICAgICAgICBpbnQgcmM7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX3Qgb2xkX2ZlYXR1cmVzOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190IG9sZF9m
ZWF0dXJlc1tORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+ID4gPgo+ID4gPiAgICAgICAgIGlmICgh
ZGV2IHx8ICFuZXRpZl9kZXZpY2VfcHJlc2VudChkZXYpKQo+ID4gPiAgICAgICAgICAgICAgICAg
cmV0dXJuIC1FTk9ERVY7Cj4gPiA+IEBAIC0yNjUwLDcgKzI2NzUsNyBAQCBpbnQgZGV2X2V0aHRv
b2woc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3QgaWZyZXEgKmlmcikKPiA+ID4gICAgICAgICAgICAg
ICAgIGlmIChyYyAgPCAwKQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmM7
Cj4gPiA+ICAgICAgICAgfQo+ID4gPiAtICAgICAgIG9sZF9mZWF0dXJlcyA9IGRldi0+ZmVhdHVy
ZXM7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2NvcHkob2xkX2ZlYXR1cmVzLCBkZXYt
PmZlYXR1cmVzKTsKPiA+ID4KPiA+ID4gICAgICAgICBzd2l0Y2ggKGV0aGNtZCkgewo+ID4gPiAg
ICAgICAgIGNhc2UgRVRIVE9PTF9HU0VUOgo+ID4gPiBAQCAtMjg2NSw3ICsyODkwLDcgQEAgaW50
IGRldl9ldGh0b29sKHN0cnVjdCBuZXQgKm5ldCwgc3RydWN0IGlmcmVxICppZnIpCj4gPiA+ICAg
ICAgICAgaWYgKGRldi0+ZXRodG9vbF9vcHMtPmNvbXBsZXRlKQo+ID4gPiAgICAgICAgICAgICAg
ICAgZGV2LT5ldGh0b29sX29wcy0+Y29tcGxldGUoZGV2KTsKPiA+ID4KPiA+ID4gLSAgICAgICBp
ZiAob2xkX2ZlYXR1cmVzICE9IGRldi0+ZmVhdHVyZXMpCj4gPiA+ICsgICAgICAgaWYgKCFuZXRk
ZXZfZmVhdHVyZXNfZXF1YWwob2xkX2ZlYXR1cmVzLCBkZXYtPmZlYXR1cmVzKSkKPiA+ID4gICAg
ICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc19jaGFuZ2UoZGV2KTsKPiA+ID4KPiA+ID4gICAg
ICAgICByZXR1cm4gcmM7Cj4gPiA+IC0tCj4gPiA+IDIuOC4xCj4gPiA+Cj4gPiA+Cj4gPiA+Cj4g
PiA+IC0tCj4gPiA+IExhdGVzdCBQb2RjYXN0Ogo+ID4gPiBodHRwczovL3d3dy5saW5rZWRpbi5j
b20vZmVlZC91cGRhdGUvdXJuOmxpOmFjdGl2aXR5OjY3OTEwMTQyODQ5MzY3ODU5MjAvCj4gPiA+
Cj4gPiA+IERhdmUgVMOkaHQgQ1RPLCBUZWtMaWJyZSwgTExDCj4gPiA+IF9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gPiA+IENha2UgbWFpbGluZyBsaXN0
Cj4gPiA+IENha2VAbGlzdHMuYnVmZmVyYmxvYXQubmV0Cj4gPiA+IGh0dHBzOi8vbGlzdHMuYnVm
ZmVyYmxvYXQubmV0L2xpc3RpbmZvL2Nha2UKPiA+Cj4gPgo+ID4KPiA+IC0tCj4gPiBSb2JlcnQg
Q2hhY8Ozbgo+ID4gcm9iZXJ0LmNoYWNvbkBqYWNrcmFiYml0d2lyZWxlc3MuY29tCj4KPgo+Cj4g
LS0KPiBMYXRlc3QgUG9kY2FzdDoKPiBodHRwczovL3d3dy5saW5rZWRpbi5jb20vZmVlZC91cGRh
dGUvdXJuOmxpOmFjdGl2aXR5OjY3OTEwMTQyODQ5MzY3ODU5MjAvCj4KPiBEYXZlIFTDpGh0IENU
TywgVGVrTGlicmUsIExMQwoKCk9uIFNhdCwgSnVsIDEwLCAyMDIxIGF0IDE6NDMgUE0gRGF2ZSBU
YWh0IDxkYXZlLnRhaHRAZ21haWwuY29tPiB3cm90ZToKPgo+IGNhbiBJIGVuY291cmFnZSB5b3Ug
dG8gdHJ5IGNha2Ugd2l0aCBpdCdzIGludGVncmFsIHNoYXBlciBpbnN0ZWFkIG9mIGh0Yj8KPgo+
IG9yIGh0YiArIGNha2UgZGlmZnNlcnY0IGFjay1maWx0ZXI/IChJJ3ZlIHNldHRsZWQgb24gdGhh
dCB0byBvcHRpbWl6ZQo+IGV2ZW4gYmV0dGVyIGZvciBtYXJrZWQgdmlkZW9jb25mZXJlbmNpbmcg
dHJhZmZpYy4KPiBmYWNldGltZSwgaW4gcGFydGljdWxhciwgZG9lcyBub3QgaGFuZGxlIGxvc3Mg
d2VsbCkKPgo+Cj4gT24gU2F0LCBKdWwgMTAsIDIwMjEgYXQgMTA6MDAgQU0gUm9iZXJ0IENoYWPD
s24KPiA8cm9iZXJ0LmNoYWNvbkBqYWNrcmFiYml0d2lyZWxlc3MuY29tPiB3cm90ZToKPiA+Cj4g
PiBJIGhhdmUgYSBxdWVzdGlvbiByZWdhcmRpbmcgdGhpcywgYW5kIHRoZSBjdXJyZW50IG1heGlt
dW0gbnVtYmVyIG9mIGh0YiBsZWFmIGNsYXNzZXMgYW5kL29yIHFkaXNjcyBwZXIgaW50ZXJmYWNl
Lgo+ID4gSSByZWNlbnRseSBpbnRlZ3JhdGVkIEplc3BlcidzIHhkcC1jcHVtYXAtdGMgY29kZSBp
bnRvIExpYnJlUW9TLCB3aGljaCBpbmNyZWFzZWQgdGhyb3VnaHB1dCB0byAxMEdicHMgb24gdGVz
dHMuCj4gPiBJIHN1c3BlY3Qgc29tZXdoZXJlIGJldHdlZW4gMTBHYnBzIGFuZCA0MEdicHMgdGhy
b3VnaHB1dCBpcyBub3cgcG9zc2libGUgaWYgeW91IHRocm93IGVub3VnaCBjb3JlcyBhdCBpdC4g
QXNraW5nIG91ciBsb2NhbCB1bml2ZXJzaXR5IHRvIGhlbHAgdXMgdGVzdCB0aGlzLgo+ID4gWGRw
LWNwdW1hcC10YyB1c2VzIHhkcCdzIGNwdW1hcC1yZWRpcmVjdCBmZWF0dXJlIHRvIGZpbHRlciBw
YWNrZXRzIGludG8gdGhlIGFwcHJvcHJpYXRlIENQVSAvIHF1ZXVlIHVzaW5nIGVCUEYgaGFzaCBt
YXBzLCByYXRoZXIgdGhhbiBsaW51eCB0YyBmaWx0ZXJzIC8gdTMyLgo+ID4KPiA+IFF1ZXN0aW9u
KSBTaW5jZSBMaWJyZVFvUyB3b3VsZCBub3QgZGVwZW5kIG9uIHRjIGZpbHRlcnMsIHdvdWxkIHRo
ZSBjdXJyZW50IDMyLWJpdCBvciA2NC1iaXQgZmVhdHVyZSBsaW1pdCBpbXBvc2UgYSBwcmFjdGlj
YWwgY2xpZW50IGxpbWl0IG9uIExpYnJlUW9TPwo+ID4gVGhlIGF2ZXJhZ2UgdXNlcidzIHRocm91
Z2hwdXQgaXMgYXJvdW5kIDMuNU1icHMgYXQgcGVhayBob3Vycywgc28gSSdtIHRoaW5raW5nIH41
ODAwIHFkaXNjcyBhbmQgfjU4MDAgaHRiIGxlYWYgY2xhc3NlcyB3b3VsZCBiZSByZXF1aXJlZCBm
b3IgZWFjaCBpbnRlcmZhY2UgYXQgMjBHYnBzIHRocm91Z2hwdXQgZm9yIGV4YW1wbGUuCj4gPiBU
aGVyZSBtYXkgYmUgc29tZSBtb3JlIGltbWVkaWF0ZSBsaW1pdGF0aW9ucyBJJ20gbm90IHVuZGVy
c3RhbmRpbmcuIEp1c3QgY3VyaW91cyBhYm91dCB0aGUgcHJhY3RpY2FsIGxpbWl0YXRpb25zIHRo
ZXJlLgo+ID4KPiA+IFRoYW5rcyEKPiA+IFJvYmVydAo+ID4KPiA+IE9uIFNhdCwgSnVsIDEwLCAy
MDIxIGF0IDk6MzMgQU0gRGF2ZSBUYWh0IDxkYXZlLnRhaHRAZ21haWwuY29tPiB3cm90ZToKPiA+
ID4KPiA+ID4gT25lIHRoaW5nIHNvbWV3aGF0IHJlbGF0ZWQgdG8gdGhpcyB3YXMgZmluYWxseSBl
eHBhbmRpbmcgdGhlIHNwYWNlCj4gPiA+IGF2YWlsYWJsZSBmb3IgdGhlIHRjIGFuZCBpcHRhYmxl
cyBmdW5jdGlvbmFsaXR5IGZvcgo+ID4gPiB0aGluZ3MgbGlrZSBoYXNoaW5nIGFuZCBhY3Rpb25z
IGV0YyBmcm9tIDE2IGJpdHMgdG8gMzIuIFRoYXQgaXMKPiA+ID4gc29tZXRoaW5nIG9mIGEgZm9y
ayBsaWZ0IHVwZ3JhZGUsIGJ1dC4uLiA2NGsgcXVldWVzIGlzIG5vdAo+ID4gPiBlbm91Z2ggaW4g
c29tZSBjYXNlcywgbm9yIGlzIDY0ayBwb3NzaWJsZSB1c2VycyBpbiBsaWJyZXFvcy4gdGhvdWdo
dHMKPiA+ID4KPiA+ID4gLS0tLS0tLS0tLSBGb3J3YXJkZWQgbWVzc2FnZSAtLS0tLS0tLS0KPiA+
ID4gRnJvbTogSmlhbiBTaGVuIDxzaGVuamlhbjE1QGh1YXdlaS5jb20+Cj4gPiA+IERhdGU6IFNh
dCwgSnVsIDEwLCAyMDIxIGF0IDI6NDcgQU0KPiA+ID4gU3ViamVjdDogW1JGQyBuZXQtbmV4dF0g
bmV0OiBleHRlbmQgbmV0ZGV2IGZlYXR1cmVzCj4gPiA+IFRvOiA8ZGF2ZW1AZGF2ZW1sb2Z0Lm5l
dD4sIDxrdWJhQGtlcm5lbC5vcmc+Cj4gPiA+IENjOiA8bmV0ZGV2QHZnZXIua2VybmVsLm9yZz4s
IDxsaW51eGFybUBvcGVuZXVsZXIub3JnPgo+ID4gPgo+ID4gPgo+ID4gPiBGb3IgdGhlIHByb3Rv
dHlwZSBvZiBuZXRkZXZfZmVhdHVyZXNfdCBpcyB1NjQsIGFuZCB0aGUgbnVtYmVyCj4gPiA+IG9m
IG5ldGRldmljZSBmZWF0dXJlIGJpdHMgaXMgNjQgbm93LiBTbyB0aGVyZSBpcyBubyBzcGFjZSB0
bwo+ID4gPiBpbnRyb2R1Y2UgbmV3IGZlYXR1cmUgYml0Lgo+ID4gPgo+ID4gPiBJIGRpZCBhIHNt
YWxsIGNoYW5nZSBmb3IgdGhpcy4gS2VlcCB0aGUgcHJvdG90eXBlIG9mCj4gPiA+IG5ldGRldl9m
ZWF0dXJlX3QsIGFuZCBleHRlbmQgdGhlIGZlYXR1cmUgbWVtYmVycyBpbiBzdHJ1Y3QKPiA+ID4g
bmV0X2RldmljZSB0byBhbiBhcnJheSBvZiBuZXRkZXZfZmVhdHVyZXNfdC4gU28gbW9yZSBmZWF0
dXJlcwo+ID4gPiBiaXRzIGNhbiBiZSB1c2VkLgo+ID4gPgo+ID4gPiBBcyB0aGlzIGNoYW5nZSwg
c29tZSBmdW5jdGlvbnMgd2hpY2ggdXNlIG5ldGRldl9mZWF0dXJlc190IGFzCj4gPiA+IHBhcmFt
ZXRlciBvciByZXR1cmVuIHZhbHVlIHdpbGwgYmUgYWZmZWN0ZWQuCj4gPiA+IEkgZGlkIGJlbG93
IGNoYW5nZXM6Cj4gPiA+IGEuIHBhcmFtZXRlcjogIm5ldGRldl9mZWF0dXJlc190IiB0byAibmV0
ZGV2X2ZlYXR1cmVzX3QgKiIKPiA+ID4gYi4gcmV0dXJuIHZhbHVlOiAibmV0ZGV2X2ZlYXR1cmVf
dCIgdG8gInZvaWQiLCBhbmQgYWRkCj4gPiA+ICJuZXRkZXZfZmVhdHVyZV90ICoiIGFzIG91dHB1
dCBwYXJhbWV0ZXIuCj4gPiA+Cj4gPiA+IEkga2VwdCBzb21lIGZ1bmN0aW9ucyBubyBjaGFuZ2Us
IHdoaWNoIGFyZSBzdXJlbHkgdXNlaW5nIHRoZQo+ID4gPiBmaXJzdCA2NCBiaXQgb2YgbmV0IGRl
dmljZSBmZWF0dXJlcyBub3csIHN1Y2ggYXMgZnVuY3Rpb24KPiA+ID4gbmVkZXZfYWRkX3Rzb19m
ZWF0dXJlcygpLiBJbiBvcmRlciB0byBtaW5pbWl6ZSB0byBjaGFuZ2VzLgo+ID4gPgo+ID4gPiBG
b3IgdGhlIGZlYXR1cmVzIGFyZSBhcnJheSBub3csIHNvIGl0J3MgdW5hYmxlIHRvIGRvIGxvZ2lj
YWwKPiA+ID4gb3BlcmF0aW9uIGRpcmVjdGx5LiBJIGludHJvZHVjZSBhIGlubGluZSBmdW5jdGlv
biBzZXQgZm9yCj4gPiA+IHRoZW0sIGluY2x1ZGluZyAibmV0ZGV2X2ZlYXR1cmVzX2FuZC9hbmRu
b3Qvb3IveG9yL2VxdWFsL2VtcHR5Ii4KPiA+ID4KPiA+ID4gRm9yIE5FVERFVl9GRUFUVVJFX0NP
VU5UIG1heSBiZSBtb3JlIHRoYW4gNjQsIHNvIHRoZSBzaGlmdAo+ID4gPiBvcGVyYXRpb24gZm9y
IE5FVERFVl9GRUFUVVJFX0NPVU5UIGlzIGlsbGVnYWwuIEkgY2hhbmdlZCBzb21lCj4gPiA+IG1h
Y3JvZXMgYW5kIGZ1bmN0aW9ucywgd2hpY2ggZG9lcyBzaGlmdCBvcGVydGlvbiB3aXRoIGl0Lgo+
ID4gPgo+ID4gPiBJIGhhdmVuJ3QgZmluaXNoZWQgYWxsIHRoZSBjaGFuZ2VzLCBmb3IgaXQgYWZm
ZWN0ZWQgYWxsIHRoZQo+ID4gPiBkcml2ZXJzIHdoaWNoIHVzZSB0aGUgZmVhdHVyZSwgbmVlZCBt
b3JlIHRpbWUgYW5kIHRlc3QuIEkKPiA+ID4gc2VudCB0aGlzIFJGQyBwYXRjaCwgd2FudCB0byBr
bm93IHdoZXRoZXIgdGhpcyBjaGFuZ2UgaXMKPiA+ID4gYWNjZXB0YWJsZSwgYW5kIGhvdyB0byBp
bXByb3ZlIGl0Lgo+ID4gPgo+ID4gPiBBbnkgY29tbWVudHMgd2lsbCBiZSBoZWxwZnVsLgo+ID4g
Pgo+ID4gPiBTaWduZWQtb2ZmLWJ5OiBKaWFuIFNoZW4gPHNoZW5qaWFuMTVAaHVhd2VpLmNvbT4K
PiA+ID4gLS0tCj4gPiA+ICBkcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zL2huc19l
bmV0LmMgICB8ICAzNCArLS0KPiA+ID4gIGRyaXZlcnMvbmV0L2V0aGVybmV0L2hpc2lsaWNvbi9o
bnMzL2huczNfZW5ldC5jIHwgIDk3ICsrKystLS0tLQo+ID4gPiAgZHJpdmVycy9uZXQvZXRoZXJu
ZXQvaHVhd2VpL2hpbmljL2hpbmljX21haW4uYyAgfCAgNzEgKysrLS0tCj4gPiA+ICBkcml2ZXJz
L25ldC9ldGhlcm5ldC9odWF3ZWkvaGluaWMvaGluaWNfcnguYyAgICB8ICAgNCArLQo+ID4gPiAg
aW5jbHVkZS9saW51eC9pZl92bGFuLmggICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0K
PiA+ID4gIGluY2x1ZGUvbGludXgvbmV0ZGV2X2ZlYXR1cmVzLmggICAgICAgICAgICAgICAgIHwg
MTA1ICsrKysrKysrLQo+ID4gPiAgaW5jbHVkZS9saW51eC9uZXRkZXZpY2UuaCAgICAgICAgICAg
ICAgICAgICAgICAgfCAgMzEgKy0tCj4gPiA+ICBuZXQvODAyMXEvdmxhbi5jICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8ICAgNCArLQo+ID4gPiAgbmV0LzgwMjFxL3ZsYW4uaCAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KPiA+ID4gIG5ldC84MDIxcS92bGFu
X2Rldi5jICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIDQ5ICsrKy0tCj4gPiA+ICBuZXQv
Y29yZS9kZXYuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IDI3NiArKysrKysr
KysrKystLS0tLS0tLS0tLS0KPiA+ID4gIG5ldC9jb3JlL25ldHBvbGwuYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICA2ICstCj4gPiA+ICBuZXQvZXRodG9vbC9mZWF0dXJlcy5jICAg
ICAgICAgICAgICAgICAgICAgICAgICB8ICA1NiArKystLQo+ID4gPiAgbmV0L2V0aHRvb2wvaW9j
dGwuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgOTMgKysrKystLS0KPiA+ID4gIDE0
IGZpbGVzIGNoYW5nZWQsIDQ5MyBpbnNlcnRpb25zKCspLCAzMzcgZGVsZXRpb25zKC0pCj4gPiA+
Cj4gPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zL2hu
c19lbmV0LmMKPiA+ID4gYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zL2huc19l
bmV0LmMKPiA+ID4gaW5kZXggYWQ1MzRmOS4uNGYyNDVjZiAxMDA2NDQKPiA+ID4gLS0tIGEvZHJp
dmVycy9uZXQvZXRoZXJuZXQvaGlzaWxpY29uL2hucy9obnNfZW5ldC5jCj4gPiA+ICsrKyBiL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L2hpc2lsaWNvbi9obnMvaG5zX2VuZXQuYwo+ID4gPiBAQCAtNDc5
LDcgKzQ3OSw3IEBAIHN0YXRpYyB2b2lkIGhuc19uaWNfcnhfY2hlY2tzdW0oc3RydWN0Cj4gPiA+
IGhuc19uaWNfcmluZ19kYXRhICpyaW5nX2RhdGEsCj4gPiA+ICAgICAgICAgdTMyIGw0aWQ7Cj4g
PiA+Cj4gPiA+ICAgICAgICAgLyogY2hlY2sgaWYgUlggY2hlY2tzdW0gb2ZmbG9hZCBpcyBlbmFi
bGVkICovCj4gPiA+IC0gICAgICAgaWYgKHVubGlrZWx5KCEobmV0ZGV2LT5mZWF0dXJlcyAmIE5F
VElGX0ZfUlhDU1VNKSkpCj4gPiA+ICsgICAgICAgaWYgKHVubGlrZWx5KCEobmV0ZGV2LT5mZWF0
dXJlc1swXSAmIE5FVElGX0ZfUlhDU1VNKSkpCj4gPiA+ICAgICAgICAgICAgICAgICByZXR1cm47
Cj4gPiA+Cj4gPiA+ICAgICAgICAgLyogSW4gaGFyZHdhcmUsIHdlIG9ubHkgc3VwcG9ydCBjaGVj
a3N1bSBmb3IgdGhlIGZvbGxvd2luZyBwcm90b2NvbHM6Cj4gPiA+IEBAIC0xNzY4LDE3ICsxNzY4
LDE3IEBAIHN0YXRpYyBpbnQgaG5zX25pY19jaGFuZ2VfbXR1KHN0cnVjdAo+ID4gPiBuZXRfZGV2
aWNlICpuZGV2LCBpbnQgbmV3X210dSkKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIHN0YXRpYyBpbnQg
aG5zX25pY19zZXRfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwKPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcykK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAq
ZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgc3RydWN0IGhuc19uaWNfcHJpdiAqcHJp
diA9IG5ldGRldl9wcml2KG5ldGRldik7Cj4gPiA+Cj4gPiA+ICAgICAgICAgc3dpdGNoIChwcml2
LT5lbmV0X3Zlcikgewo+ID4gPiAgICAgICAgIGNhc2UgQUVfVkVSU0lPTl8xOgo+ID4gPiAtICAg
ICAgICAgICAgICAgaWYgKGZlYXR1cmVzICYgKE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082KSkK
PiA+ID4gKyAgICAgICAgICAgICAgIGlmIChmZWF0dXJlc1swXSAmIChORVRJRl9GX1RTTyB8IE5F
VElGX0ZfVFNPNikpCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9pbmZvKG5l
dGRldiwgImVuZXQgdjEgZG8gbm90IHN1cHBvcnQgdHNvIVxuIik7Cj4gPiA+ICAgICAgICAgICAg
ICAgICBicmVhazsKPiA+ID4gICAgICAgICBkZWZhdWx0Ogo+ID4gPiAtICAgICAgICAgICAgICAg
aWYgKGZlYXR1cmVzICYgKE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082KSkgewo+ID4gPiArICAg
ICAgICAgICAgICAgaWYgKGZlYXR1cmVzWzBdICYgKE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082
KSkgewo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBwcml2LT5vcHMuZmlsbF9kZXNjID0g
ZmlsbF90c29fZGVzYzsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+b3BzLm1h
eWJlX3N0b3BfdHggPSBobnNfbmljX21heWJlX3N0b3BfdHNvOwo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAvKiBUaGUgY2hpcCBvbmx5IHN1cHBvcnQgNyo0MDk2ICovCj4gPiA+IEBAIC0x
Nzg5LDI0ICsxNzg5LDIzIEBAIHN0YXRpYyBpbnQgaG5zX25pY19zZXRfZmVhdHVyZXMoc3RydWN0
Cj4gPiA+IG5ldF9kZXZpY2UgKm5ldGRldiwKPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4g
ICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPiAgICAgICAgIH0KPiA+ID4gLSAgICAgICBuZXRk
ZXYtPmZlYXR1cmVzID0gZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgbmV0ZGV2LT5mZWF0dXJlc1sw
XSA9IGZlYXR1cmVzWzBdOwo+ID4gPiAgICAgICAgIHJldHVybiAwOwo+ID4gPiAgfQo+ID4gPgo+
ID4gPiAtc3RhdGljIG5ldGRldl9mZWF0dXJlc190IGhuc19uaWNfZml4X2ZlYXR1cmVzKAo+ID4g
PiAtICAgICAgICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgbmV0ZGV2X2ZlYXR1
cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICtzdGF0aWMgdm9pZCBobnNfbmljX2ZpeF9mZWF0dXJlcyhz
dHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAg
ICAgc3RydWN0IGhuc19uaWNfcHJpdiAqcHJpdiA9IG5ldGRldl9wcml2KG5ldGRldik7Cj4gPiA+
Cj4gPiA+ICAgICAgICAgc3dpdGNoIChwcml2LT5lbmV0X3Zlcikgewo+ID4gPiAgICAgICAgIGNh
c2UgQUVfVkVSU0lPTl8xOgo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gfihORVRJ
Rl9GX1RTTyB8IE5FVElGX0ZfVFNPNiB8Cj4gPiA+ICsgICAgICAgICAgICAgICBmZWF0dXJlc1sw
XSAmPSB+KE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082IHwKPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIpOwo+ID4gPiAgICAg
ICAgICAgICAgICAgYnJlYWs7Cj4gPiA+ICAgICAgICAgZGVmYXVsdDoKPiA+ID4gICAgICAgICAg
ICAgICAgIGJyZWFrOwo+ID4gPiAgICAgICAgIH0KPiA+ID4gLSAgICAgICByZXR1cm4gZmVhdHVy
ZXM7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgaW50IGhuc19uaWNfdWNfc3luYyhzdHJ1
Y3QgbmV0X2RldmljZSAqbmV0ZGV2LCBjb25zdCB1bnNpZ25lZAo+ID4gPiBjaGFyICphZGRyKQo+
ID4gPiBAQCAtMjE2Myw4ICsyMTYyLDggQEAgc3RhdGljIHZvaWQgaG5zX25pY19zZXRfcHJpdl9v
cHMoc3RydWN0Cj4gPiA+IG5ldF9kZXZpY2UgKm5ldGRldikKPiA+ID4gICAgICAgICAgICAgICAg
IHByaXYtPm9wcy5tYXliZV9zdG9wX3R4ID0gaG5zX25pY19tYXliZV9zdG9wX3R4Owo+ID4gPiAg
ICAgICAgIH0gZWxzZSB7Cj4gPiA+ICAgICAgICAgICAgICAgICBwcml2LT5vcHMuZ2V0X3J4ZF9i
bnVtID0gZ2V0X3YycnhfZGVzY19ibnVtOwo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKChuZXRk
ZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9UU08pIHx8Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAg
KG5ldGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX1RTTzYpKSB7Cj4gPiA+ICsgICAgICAgICAgICAg
ICBpZiAoKG5ldGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RTTykgfHwKPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAobmV0ZGV2LT5mZWF0dXJlc1swXSAmIE5FVElGX0ZfVFNPNikpIHsKPiA+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgcHJpdi0+b3BzLmZpbGxfZGVzYyA9IGZpbGxfdHNv
X2Rlc2M7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHByaXYtPm9wcy5tYXliZV9zdG9w
X3R4ID0gaG5zX25pY19tYXliZV9zdG9wX3RzbzsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgLyogVGhpcyBjaGlwIG9ubHkgc3VwcG9ydCA3KjQwOTYgKi8KPiA+ID4gQEAgLTIzMjUsMjIg
KzIzMjQsMjMgQEAgc3RhdGljIGludCBobnNfbmljX2Rldl9wcm9iZShzdHJ1Y3QKPiA+ID4gcGxh
dGZvcm1fZGV2aWNlICpwZGV2KQo+ID4gPiAgICAgICAgIG5kZXYtPm5ldGRldl9vcHMgPSAmaG5z
X25pY19uZXRkZXZfb3BzOwo+ID4gPiAgICAgICAgIGhuc19ldGh0b29sX3NldF9vcHMobmRldik7
Cj4gPiA+Cj4gPiA+IC0gICAgICAgbmRldi0+ZmVhdHVyZXMgfD0gTkVUSUZfRl9JUF9DU1VNIHwg
TkVUSUZfRl9JUFY2X0NTVU0gfAo+ID4gPiArICAgICAgIG5kZXYtPmZlYXR1cmVzWzBdIHw9IE5F
VElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNIHwKPiA+ID4gICAgICAgICAgICAgICAg
IE5FVElGX0ZfUlhDU1VNIHwgTkVUSUZfRl9TRyB8IE5FVElGX0ZfR1NPIHwKPiA+ID4gICAgICAg
ICAgICAgICAgIE5FVElGX0ZfR1JPOwo+ID4gPiAtICAgICAgIG5kZXYtPnZsYW5fZmVhdHVyZXMg
fD0KPiA+ID4gKyAgICAgICBuZGV2LT52bGFuX2ZlYXR1cmVzWzBdIHw9Cj4gPiA+ICAgICAgICAg
ICAgICAgICBORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTSB8IE5FVElGX0ZfUlhD
U1VNOwo+ID4gPiAtICAgICAgIG5kZXYtPnZsYW5fZmVhdHVyZXMgfD0gTkVUSUZfRl9TRyB8IE5F
VElGX0ZfR1NPIHwgTkVUSUZfRl9HUk87Cj4gPiA+ICsgICAgICAgbmRldi0+dmxhbl9mZWF0dXJl
c1swXSB8PSBORVRJRl9GX1NHIHwgTkVUSUZfRl9HU08gfCBORVRJRl9GX0dSTzsKPiA+ID4KPiA+
ID4gICAgICAgICAvKiBNVFUgcmFuZ2U6IDY4IC0gOTU3OCAodjEpIG9yIDk3MDYgKHYyKSAqLwo+
ID4gPiAgICAgICAgIG5kZXYtPm1pbl9tdHUgPSBNQUNfTUlOX01UVTsKPiA+ID4gICAgICAgICBz
d2l0Y2ggKHByaXYtPmVuZXRfdmVyKSB7Cj4gPiA+ICAgICAgICAgY2FzZSBBRV9WRVJTSU9OXzI6
Cj4gPiA+IC0gICAgICAgICAgICAgICBuZGV2LT5mZWF0dXJlcyB8PSBORVRJRl9GX1RTTyB8IE5F
VElGX0ZfVFNPNiB8IE5FVElGX0ZfTlRVUExFOwo+ID4gPiAtICAgICAgICAgICAgICAgbmRldi0+
aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9JUF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NTVU0gfAo+ID4g
PiArICAgICAgICAgICAgICAgbmRldi0+ZmVhdHVyZXNbMF0gfD0KPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNiB8IE5FVElGX0Zf
TlRVUExFOwo+ID4gPiArICAgICAgICAgICAgICAgbmRldi0+aHdfZmVhdHVyZXNbMF0gfD0gTkVU
SUZfRl9JUF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NTVU0gfAo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICBORVRJRl9GX1JYQ1NVTSB8IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dTTyB8Cj4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfR1JPIHwgTkVUSUZfRl9UU08gfCBORVRJ
Rl9GX1RTTzY7Cj4gPiA+IC0gICAgICAgICAgICAgICBuZGV2LT52bGFuX2ZlYXR1cmVzIHw9IE5F
VElGX0ZfVFNPIHwgTkVUSUZfRl9UU082Owo+ID4gPiArICAgICAgICAgICAgICAgbmRldi0+dmxh
bl9mZWF0dXJlc1swXSB8PSBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNjsKPiA+ID4gICAgICAg
ICAgICAgICAgIG5kZXYtPm1heF9tdHUgPSBNQUNfTUFYX01UVV9WMiAtCj4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKEVUSF9ITEVOICsgRVRIX0ZDU19MRU4gKyBWTEFOX0hM
RU4pOwo+ID4gPiAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiA+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL25ldC9ldGhlcm5ldC9oaXNpbGljb24vaG5zMy9obnMzX2VuZXQuYwo+ID4gPiBiL2RyaXZl
cnMvbmV0L2V0aGVybmV0L2hpc2lsaWNvbi9obnMzL2huczNfZW5ldC5jCj4gPiA+IGluZGV4IGNk
YjVmMTQuLmJhNTY5MDcgMTAwNjQ0Cj4gPiA+IC0tLSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2hp
c2lsaWNvbi9obnMzL2huczNfZW5ldC5jCj4gPiA+ICsrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0
L2hpc2lsaWNvbi9obnMzL2huczNfZW5ldC5jCj4gPiA+IEBAIC0xNDgxLDcgKzE0ODEsNyBAQCBz
dGF0aWMgaW50IGhuczNfaGFuZGxlX3Z0YWdzKHN0cnVjdAo+ID4gPiBobnMzX2VuZXRfcmluZyAq
dHhfcmluZywKPiA+ID4gICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ID4gPgo+ID4g
PiAgICAgICAgIGlmIChza2ItPnByb3RvY29sID09IGh0b25zKEVUSF9QXzgwMjFRKSAmJgo+ID4g
PiAtICAgICAgICAgICAhKGhhbmRsZS0+a2luZm8ubmV0ZGV2LT5mZWF0dXJlcyAmIE5FVElGX0Zf
SFdfVkxBTl9DVEFHX1RYKSkgewo+ID4gPiArICAgICAgICAgICAhKGhhbmRsZS0+a2luZm8ubmV0
ZGV2LT5mZWF0dXJlc1swXSAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RYKSkgewo+ID4gPiAgICAg
ICAgICAgICAgICAgLyogV2hlbiBIVyBWTEFOIGFjY2VsZXJhdGlvbiBpcyB0dXJuZWQgb2ZmLCBh
bmQgdGhlIHN0YWNrCj4gPiA+ICAgICAgICAgICAgICAgICAgKiBzZXRzIHRoZSBwcm90b2NvbCB0
byA4MDIuMXEsIHRoZSBkcml2ZXIganVzdCBuZWVkIHRvCj4gPiA+ICAgICAgICAgICAgICAgICAg
KiBzZXQgdGhlIHByb3RvY29sIHRvIHRoZSBlbmNhcHN1bGF0ZWQgZXRoZXJ0eXBlLgo+ID4gPiBA
QCAtMjMwMCw1NiArMjMwMCw1NyBAQCBzdGF0aWMgaW50IGhuczNfbmljX2RvX2lvY3RsKHN0cnVj
dCBuZXRfZGV2aWNlICpuZXRkZXYsCj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgaW50IGhu
czNfbmljX3NldF9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LAo+ID4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcykK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3Qg
KmZlYXR1cmVzKQo+ID4gPiAgewo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IGNoYW5n
ZWQgPSBuZXRkZXYtPmZlYXR1cmVzIF4gZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2Zl
YXR1cmVzX3QgY2hhbmdlZFtORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+ID4gPiAgICAgICAgIHN0
cnVjdCBobnMzX25pY19wcml2ICpwcml2ID0gbmV0ZGV2X3ByaXYobmV0ZGV2KTsKPiA+ID4gICAg
ICAgICBzdHJ1Y3QgaG5hZTNfaGFuZGxlICpoID0gcHJpdi0+YWVfaGFuZGxlOwo+ID4gPiAgICAg
ICAgIGJvb2wgZW5hYmxlOwo+ID4gPiAgICAgICAgIGludCByZXQ7Cj4gPiA+Cj4gPiA+IC0gICAg
ICAgaWYgKGNoYW5nZWQgJiAoTkVUSUZfRl9HUk9fSFcpICYmIGgtPmFlX2FsZ28tPm9wcy0+c2V0
X2dyb19lbikgewo+ID4gPiAtICAgICAgICAgICAgICAgZW5hYmxlID0gISEoZmVhdHVyZXMgJiBO
RVRJRl9GX0dST19IVyk7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3hvcihjaGFuZ2Vk
LCBuZXRkZXYtPmZlYXR1cmVzLCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgaWYgKGNoYW5nZWRb
MF0gJiAoTkVUSUZfRl9HUk9fSFcpICYmIGgtPmFlX2FsZ28tPm9wcy0+c2V0X2dyb19lbikgewo+
ID4gPiArICAgICAgICAgICAgICAgZW5hYmxlID0gISEoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0dS
T19IVyk7Cj4gPiA+ICAgICAgICAgICAgICAgICByZXQgPSBoLT5hZV9hbGdvLT5vcHMtPnNldF9n
cm9fZW4oaCwgZW5hYmxlKTsKPiA+ID4gICAgICAgICAgICAgICAgIGlmIChyZXQpCj4gPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+
ID4gPiAtICAgICAgIGlmICgoY2hhbmdlZCAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYKSAmJgo+
ID4gPiArICAgICAgIGlmICgoY2hhbmdlZFswXSAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYKSAm
Jgo+ID4gPiAgICAgICAgICAgICBoLT5hZV9hbGdvLT5vcHMtPmVuYWJsZV9od19zdHJpcF9yeHZ0
YWcpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIGVuYWJsZSA9ICEhKGZlYXR1cmVzICYgTkVUSUZf
Rl9IV19WTEFOX0NUQUdfUlgpOwo+ID4gPiArICAgICAgICAgICAgICAgZW5hYmxlID0gISEoZmVh
dHVyZXNbMF0gJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCk7Cj4gPiA+ICAgICAgICAgICAgICAg
ICByZXQgPSBoLT5hZV9hbGdvLT5vcHMtPmVuYWJsZV9od19zdHJpcF9yeHZ0YWcoaCwgZW5hYmxl
KTsKPiA+ID4gICAgICAgICAgICAgICAgIGlmIChyZXQpCj4gPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiByZXQ7Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAtICAgICAgIGlm
ICgoY2hhbmdlZCAmIE5FVElGX0ZfTlRVUExFKSAmJiBoLT5hZV9hbGdvLT5vcHMtPmVuYWJsZV9m
ZCkgewo+ID4gPiAtICAgICAgICAgICAgICAgZW5hYmxlID0gISEoZmVhdHVyZXMgJiBORVRJRl9G
X05UVVBMRSk7Cj4gPiA+ICsgICAgICAgaWYgKChjaGFuZ2VkWzBdICYgTkVUSUZfRl9OVFVQTEUp
ICYmIGgtPmFlX2FsZ28tPm9wcy0+ZW5hYmxlX2ZkKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICBl
bmFibGUgPSAhIShmZWF0dXJlc1swXSAmIE5FVElGX0ZfTlRVUExFKTsKPiA+ID4gICAgICAgICAg
ICAgICAgIGgtPmFlX2FsZ28tPm9wcy0+ZW5hYmxlX2ZkKGgsIGVuYWJsZSk7Cj4gPiA+ICAgICAg
ICAgfQo+ID4gPgo+ID4gPiAtICAgICAgIGlmICgobmV0ZGV2LT5mZWF0dXJlcyAmIE5FVElGX0Zf
SFdfVEMpID4gKGZlYXR1cmVzICYgTkVUSUZfRl9IV19UQykgJiYKPiA+ID4gKyAgICAgICBpZiAo
KG5ldGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX1RDKSA+Cj4gPiA+ICsgICAgICAgICAg
ICAoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX1RDKSAmJgo+ID4gPiAgICAgICAgICAgICBoLT5h
ZV9hbGdvLT5vcHMtPmNsc19mbG93ZXJfYWN0aXZlKGgpKSB7Cj4gPiA+ICAgICAgICAgICAgICAg
ICBuZXRkZXZfZXJyKG5ldGRldiwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgInRo
ZXJlIGFyZSBvZmZsb2FkZWQgVEMgZmlsdGVycyBhY3RpdmUsCj4gPiA+IGNhbm5vdCBkaXNhYmxl
IEhXIFRDIG9mZmxvYWQiKTsKPiA+ID4gICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+
ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoKGNoYW5nZWQgJiBORVRJRl9G
X0hXX1ZMQU5fQ1RBR19GSUxURVIpICYmCj4gPiA+ICsgICAgICAgaWYgKChjaGFuZ2VkWzBdICYg
TkVUSUZfRl9IV19WTEFOX0NUQUdfRklMVEVSKSAmJgo+ID4gPiAgICAgICAgICAgICBoLT5hZV9h
bGdvLT5vcHMtPmVuYWJsZV92bGFuX2ZpbHRlcikgewo+ID4gPiAtICAgICAgICAgICAgICAgZW5h
YmxlID0gISEoZmVhdHVyZXMgJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIpOwo+ID4gPiAr
ICAgICAgICAgICAgICAgZW5hYmxlID0gISEoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX1ZMQU5f
Q1RBR19GSUxURVIpOwo+ID4gPiAgICAgICAgICAgICAgICAgcmV0ID0gaC0+YWVfYWxnby0+b3Bz
LT5lbmFibGVfdmxhbl9maWx0ZXIoaCwgZW5hYmxlKTsKPiA+ID4gICAgICAgICAgICAgICAgIGlm
IChyZXQpCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4gPiA+ICAg
ICAgICAgfQo+ID4gPgo+ID4gPiAtICAgICAgIG5ldGRldi0+ZmVhdHVyZXMgPSBmZWF0dXJlczsK
PiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfY29weShuZXRkZXYtPmZlYXR1cmVzLCBmZWF0
dXJlcyk7Cj4gPiA+ICAgICAgICAgcmV0dXJuIDA7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+IC1zdGF0
aWMgbmV0ZGV2X2ZlYXR1cmVzX3QgaG5zM19mZWF0dXJlc19jaGVjayhzdHJ1Y3Qgc2tfYnVmZiAq
c2tiLAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcykKPiA+ID4gK3N0YXRp
YyB2b2lkIGhuczNfZmVhdHVyZXNfY2hlY2soc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAjZGVmaW5lIEhOUzNfTUFY
X0hEUl9MRU4gICAgICAgNDgwVQo+ID4gPiAgI2RlZmluZSBITlMzX01BWF9MNF9IRFJfTEVOICAg
IDYwVQo+ID4gPiBAQCAtMjM3Myw5ICsyMzc0LDcgQEAgc3RhdGljIG5ldGRldl9mZWF0dXJlc190
Cj4gPiA+IGhuczNfZmVhdHVyZXNfY2hlY2soc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4gICAg
ICAgICAgKiBsZW4gb2YgNDgwIGJ5dGVzLgo+ID4gPiAgICAgICAgICAqLwo+ID4gPiAgICAgICAg
IGlmIChsZW4gPiBITlMzX01BWF9IRFJfTEVOKQo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVy
ZXMgJj0gfihORVRJRl9GX0NTVU1fTUFTSyB8IE5FVElGX0ZfR1NPX01BU0spOwo+ID4gPiAtCj4g
PiA+IC0gICAgICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVy
ZXNbMF0gJj0gfihORVRJRl9GX0NTVU1fTUFTSyB8IE5FVElGX0ZfR1NPX01BU0spOwo+ID4gPiAg
fQo+ID4gPgo+ID4gPiAgc3RhdGljIHZvaWQgaG5zM19uaWNfZ2V0X3N0YXRzNjQoc3RydWN0IG5l
dF9kZXZpY2UgKm5ldGRldiwKPiA+ID4gQEAgLTMxMjcsMjcgKzMxMjYsMjggQEAgc3RhdGljIHZv
aWQgaG5zM19zZXRfZGVmYXVsdF9mZWF0dXJlKHN0cnVjdAo+ID4gPiBuZXRfZGV2aWNlICpuZXRk
ZXYpCj4gPiA+Cj4gPiA+ICAgICAgICAgbmV0ZGV2LT5wcml2X2ZsYWdzIHw9IElGRl9VTklDQVNU
X0ZMVDsKPiA+ID4KPiA+ID4gLSAgICAgICBuZXRkZXYtPmh3X2VuY19mZWF0dXJlcyB8PSBORVRJ
Rl9GX1JYQ1NVTSB8IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dTTyB8Cj4gPiA+ICsgICAgICAgbmV0
ZGV2LT5od19lbmNfZmVhdHVyZXNbMF0gfD0KPiA+ID4gKyAgICAgICAgICAgICAgIE5FVElGX0Zf
UlhDU1VNIHwgTkVUSUZfRl9TRyB8IE5FVElGX0ZfR1NPIHwKPiA+ID4gICAgICAgICAgICAgICAg
IE5FVElGX0ZfR1JPIHwgTkVUSUZfRl9UU08gfCBORVRJRl9GX1RTTzYgfCBORVRJRl9GX0dTT19H
UkUgfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9HU09fR1JFX0NTVU0gfCBORVRJRl9G
X0dTT19VRFBfVFVOTkVMIHwKPiA+ID4gICAgICAgICAgICAgICAgIE5FVElGX0ZfU0NUUF9DUkMg
fCBORVRJRl9GX1RTT19NQU5HTEVJRCB8IE5FVElGX0ZfRlJBR0xJU1Q7Cj4gPiA+Cj4gPiA+ICAg
ICAgICAgbmV0ZGV2LT5nc29fcGFydGlhbF9mZWF0dXJlcyB8PSBORVRJRl9GX0dTT19HUkVfQ1NV
TTsKPiA+ID4KPiA+ID4gLSAgICAgICBuZXRkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfSFdfVkxB
Tl9DVEFHX0ZJTFRFUiB8Cj4gPiA+ICsgICAgICAgbmV0ZGV2LT5mZWF0dXJlc1swXSB8PSBORVRJ
Rl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIgfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9I
V19WTEFOX0NUQUdfVFggfCBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCB8Cj4gPiA+ICAgICAgICAg
ICAgICAgICBORVRJRl9GX1JYQ1NVTSB8IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dTTyB8Cj4gPiA+
ICAgICAgICAgICAgICAgICBORVRJRl9GX0dSTyB8IE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082
IHwgTkVUSUZfRl9HU09fR1JFIHwKPiA+ID4gICAgICAgICAgICAgICAgIE5FVElGX0ZfR1NPX0dS
RV9DU1VNIHwgTkVUSUZfRl9HU09fVURQX1RVTk5FTCB8Cj4gPiA+ICAgICAgICAgICAgICAgICBO
RVRJRl9GX1NDVFBfQ1JDIHwgTkVUSUZfRl9GUkFHTElTVDsKPiA+ID4KPiA+ID4gLSAgICAgICBu
ZXRkZXYtPnZsYW5fZmVhdHVyZXMgfD0gTkVUSUZfRl9SWENTVU0gfAo+ID4gPiArICAgICAgIG5l
dGRldi0+dmxhbl9mZWF0dXJlc1swXSB8PSBORVRJRl9GX1JYQ1NVTSB8Cj4gPiA+ICAgICAgICAg
ICAgICAgICBORVRJRl9GX1NHIHwgTkVUSUZfRl9HU08gfCBORVRJRl9GX0dSTyB8Cj4gPiA+ICAg
ICAgICAgICAgICAgICBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNiB8IE5FVElGX0ZfR1NPX0dS
RSB8Cj4gPiA+ICAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19HUkVfQ1NVTSB8IE5FVElGX0Zf
R1NPX1VEUF9UVU5ORUwgfAo+ID4gPiAgICAgICAgICAgICAgICAgTkVUSUZfRl9TQ1RQX0NSQyB8
IE5FVElGX0ZfRlJBR0xJU1Q7Cj4gPiA+Cj4gPiA+IC0gICAgICAgbmV0ZGV2LT5od19mZWF0dXJl
cyB8PSBORVRJRl9GX0hXX1ZMQU5fQ1RBR19UWCB8Cj4gPiA+ICsgICAgICAgbmV0ZGV2LT5od19m
ZWF0dXJlc1swXSB8PSBORVRJRl9GX0hXX1ZMQU5fQ1RBR19UWCB8Cj4gPiA+ICAgICAgICAgICAg
ICAgICBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCB8Cj4gPiA+ICAgICAgICAgICAgICAgICBORVRJ
Rl9GX1JYQ1NVTSB8IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dTTyB8Cj4gPiA+ICAgICAgICAgICAg
ICAgICBORVRJRl9GX0dSTyB8IE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082IHwgTkVUSUZfRl9H
U09fR1JFIHwKPiA+ID4gQEAgLTMxNTUsNDggKzMxNTUsNDkgQEAgc3RhdGljIHZvaWQgaG5zM19z
ZXRfZGVmYXVsdF9mZWF0dXJlKHN0cnVjdAo+ID4gPiBuZXRfZGV2aWNlICpuZXRkZXYpCj4gPiA+
ICAgICAgICAgICAgICAgICBORVRJRl9GX1NDVFBfQ1JDIHwgTkVUSUZfRl9GUkFHTElTVDsKPiA+
ID4KPiA+ID4gICAgICAgICBpZiAoYWVfZGV2LT5kZXZfdmVyc2lvbiA+PSBITkFFM19ERVZJQ0Vf
VkVSU0lPTl9WMikgewo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlcyB8
PSBORVRJRl9GX0dST19IVzsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVyZXMg
fD0gTkVUSUZfRl9HUk9fSFc7Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2ZlYXR1
cmVzWzBdIHw9IE5FVElGX0ZfR1JPX0hXOwo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2LT5m
ZWF0dXJlc1swXSB8PSBORVRJRl9GX0dST19IVzsKPiA+ID4KPiA+ID4gICAgICAgICAgICAgICAg
IGlmICghKGgtPmZsYWdzICYgSE5BRTNfU1VQUE9SVF9WRikpIHsKPiA+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlcyB8PSBORVRJRl9GX05UVVBMRTsKPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2LT5mZWF0dXJlcyB8PSBORVRJRl9GX05UVVBM
RTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlc1swXSB8
PSBORVRJRl9GX05UVVBMRTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2LT5m
ZWF0dXJlc1swXSB8PSBORVRJRl9GX05UVVBMRTsKPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+
ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKHRlc3RfYml0KEhOQUUzX0RFVl9T
VVBQT1JUX1VEUF9HU09fQiwgYWVfZGV2LT5jYXBzKSkgewo+ID4gPiAtICAgICAgICAgICAgICAg
bmV0ZGV2LT5od19mZWF0dXJlcyB8PSBORVRJRl9GX0dTT19VRFBfTDQ7Cj4gPiA+IC0gICAgICAg
ICAgICAgICBuZXRkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfR1NPX1VEUF9MNDsKPiA+ID4gLSAg
ICAgICAgICAgICAgIG5ldGRldi0+dmxhbl9mZWF0dXJlcyB8PSBORVRJRl9GX0dTT19VRFBfTDQ7
Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPmh3X2VuY19mZWF0dXJlcyB8PSBORVRJRl9G
X0dTT19VRFBfTDQ7Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2ZlYXR1cmVzWzBd
IHw9IE5FVElGX0ZfR1NPX1VEUF9MNDsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+ZmVh
dHVyZXNbMF0gfD0gTkVUSUZfRl9HU09fVURQX0w0Owo+ID4gPiArICAgICAgICAgICAgICAgbmV0
ZGV2LT52bGFuX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfR1NPX1VEUF9MNDsKPiA+ID4gKyAgICAg
ICAgICAgICAgIG5ldGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfR1NPX1VEUF9M
NDsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKHRlc3RfYml0KEhOQUUz
X0RFVl9TVVBQT1JUX0hXX1RYX0NTVU1fQiwgYWVfZGV2LT5jYXBzKSkgewo+ID4gPiAtICAgICAg
ICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlcyB8PSBORVRJRl9GX0hXX0NTVU07Cj4gPiA+IC0g
ICAgICAgICAgICAgICBuZXRkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfSFdfQ1NVTTsKPiA+ID4g
LSAgICAgICAgICAgICAgIG5ldGRldi0+dmxhbl9mZWF0dXJlcyB8PSBORVRJRl9GX0hXX0NTVU07
Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPmh3X2VuY19mZWF0dXJlcyB8PSBORVRJRl9G
X0hXX0NTVU07Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2ZlYXR1cmVzWzBdIHw9
IE5FVElGX0ZfSFdfQ1NVTTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVyZXNb
MF0gfD0gTkVUSUZfRl9IV19DU1VNOwo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2LT52bGFu
X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSFdfQ1NVTTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5l
dGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSFdfQ1NVTTsKPiA+ID4gICAgICAg
ICB9IGVsc2Ugewo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlcyB8PSBO
RVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTTsKPiA+ID4gLSAgICAgICAgICAgICAg
IG5ldGRldi0+ZmVhdHVyZXMgfD0gTkVUSUZfRl9JUF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NTVU07
Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPnZsYW5fZmVhdHVyZXMgfD0gTkVUSUZfRl9J
UF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NTVU07Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYt
Pmh3X2VuY19mZWF0dXJlcyB8PSBORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTTsK
PiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9J
UF9DU1VNIHwgTkVUSUZfRl9JUFY2X0NTVU07Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYt
PmZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNOwo+ID4g
PiArICAgICAgICAgICAgICAgbmV0ZGV2LT52bGFuX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfSVBf
Q1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNOwo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2LT5o
d19lbmNfZmVhdHVyZXNbMF0gfD0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNOwo+ID4gPiAgICAg
ICAgIH0KPiA+ID4KPiA+ID4gICAgICAgICBpZiAodGVzdF9iaXQoSE5BRTNfREVWX1NVUFBPUlRf
VURQX1RVTk5FTF9DU1VNX0IsIGFlX2Rldi0+Y2FwcykpIHsKPiA+ID4gLSAgICAgICAgICAgICAg
IG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4g
PiAtICAgICAgICAgICAgICAgbmV0ZGV2LT5mZWF0dXJlcyB8PSBORVRJRl9GX0dTT19VRFBfVFVO
TkVMX0NTVU07Cj4gPiA+IC0gICAgICAgICAgICAgICBuZXRkZXYtPnZsYW5fZmVhdHVyZXMgfD0g
TkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiAtICAgICAgICAgICAgICAgbmV0ZGV2
LT5od19lbmNfZmVhdHVyZXMgfD0gTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiAr
ICAgICAgICAgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlc1swXSB8PSBORVRJRl9GX0dTT19VRFBf
VFVOTkVMX0NTVU07Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXYtPmZlYXR1cmVzWzBdIHw9
IE5FVElGX0ZfR1NPX1VEUF9UVU5ORUxfQ1NVTTsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRl
di0+dmxhbl9mZWF0dXJlc1swXSB8PSBORVRJRl9GX0dTT19VRFBfVFVOTkVMX0NTVU07Cj4gPiA+
ICsgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2VuY19mZWF0dXJlc1swXSB8PSBORVRJRl9GX0dT
T19VRFBfVFVOTkVMX0NTVU07Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAgICAgICAgIGlm
ICh0ZXN0X2JpdChITkFFM19ERVZfU1VQUE9SVF9GRF9GT1JXQVJEX1RDX0IsIGFlX2Rldi0+Y2Fw
cykpIHsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZf
Rl9IV19UQzsKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVyZXMgfD0gTkVUSUZf
Rl9IV19UQzsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXNbMF0gfD0g
TkVUSUZfRl9IV19UQzsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldi0+ZmVhdHVyZXNbMF0g
fD0gTkVUSUZfRl9IV19UQzsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYg
KHRlc3RfYml0KEhOQUUzX0RFVl9TVVBQT1JUX1ZMQU5fRkxUUl9NREZfQiwgYWVfZGV2LT5jYXBz
KSkKPiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9I
V19WTEFOX0NUQUdfRklMVEVSOwo+ID4gPiArICAgICAgICAgICAgICAgbmV0ZGV2LT5od19mZWF0
dXJlc1swXSB8PSBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVI7Cj4gPiA+ICB9Cj4gPiA+Cj4g
PiA+ICBzdGF0aWMgaW50IGhuczNfYWxsb2NfYnVmZmVyKHN0cnVjdCBobnMzX2VuZXRfcmluZyAq
cmluZywKPiA+ID4gQEAgLTM3MjcsNyArMzcyOCw3IEBAIHN0YXRpYyB2b2lkIGhuczNfcnhfY2hl
Y2tzdW0oc3RydWN0Cj4gPiA+IGhuczNfZW5ldF9yaW5nICpyaW5nLCBzdHJ1Y3Qgc2tfYnVmZiAq
c2tiLAo+ID4gPgo+ID4gPiAgICAgICAgIHNrYl9jaGVja3N1bV9ub25lX2Fzc2VydChza2IpOwo+
ID4gPgo+ID4gPiAtICAgICAgIGlmICghKG5ldGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX1JYQ1NV
TSkpCj4gPiA+ICsgICAgICAgaWYgKCEobmV0ZGV2LT5mZWF0dXJlc1swXSAmIE5FVElGX0ZfUlhD
U1VNKSkKPiA+ID4gICAgICAgICAgICAgICAgIHJldHVybjsKPiA+ID4KPiA+ID4gICAgICAgICBp
ZiAodGVzdF9iaXQoSE5TM19OSUNfU1RBVEVfUlhEX0FEVl9MQVlPVVRfRU5BQkxFLCAmcHJpdi0+
c3RhdGUpKQo+ID4gPiBAQCAtNDAyNCw3ICs0MDI1LDcgQEAgc3RhdGljIGludCBobnMzX2hhbmRs
ZV9iZGluZm8oc3RydWN0Cj4gPiA+IGhuczNfZW5ldF9yaW5nICpyaW5nLCBzdHJ1Y3Qgc2tfYnVm
ZiAqc2tiKQo+ID4gPiAgICAgICAgICAqIG90X3ZsYW5fdGFnIGluIHR3byBsYXllciB0YWcgY2Fz
ZSwgYW5kIHN0b3JlZCBhdCB2bGFuX3RhZwo+ID4gPiAgICAgICAgICAqIGluIG9uZSBsYXllciB0
YWcgY2FzZS4KPiA+ID4gICAgICAgICAgKi8KPiA+ID4gLSAgICAgICBpZiAobmV0ZGV2LT5mZWF0
dXJlcyAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYKSB7Cj4gPiA+ICsgICAgICAgaWYgKG5ldGRl
di0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19SWCkgewo+ID4gPiAgICAgICAg
ICAgICAgICAgdTE2IHZsYW5fdGFnOwo+ID4gPgo+ID4gPiAgICAgICAgICAgICAgICAgaWYgKGhu
czNfcGFyc2Vfdmxhbl90YWcocmluZywgZGVzYywgbDIzNGluZm8sICZ2bGFuX3RhZykpCj4gPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9odWF3ZWkvaGluaWMvaGluaWNfbWFp
bi5jCj4gPiA+IGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvaHVhd2VpL2hpbmljL2hpbmljX21haW4u
Ywo+ID4gPiBpbmRleCA0MDVlZTRkLi5iMTkzZWU0IDEwMDY0NAo+ID4gPiAtLS0gYS9kcml2ZXJz
L25ldC9ldGhlcm5ldC9odWF3ZWkvaGluaWMvaGluaWNfbWFpbi5jCj4gPiA+ICsrKyBiL2RyaXZl
cnMvbmV0L2V0aGVybmV0L2h1YXdlaS9oaW5pYy9oaW5pY19tYWluLmMKPiA+ID4gQEAgLTc5LDgg
Kzc5LDggQEAgTU9EVUxFX1BBUk1fREVTQyhyeF93ZWlnaHQsICJOdW1iZXIgUnggcGFja2V0cyBm
b3IKPiA+ID4gTkFQSSBidWRnZXQgKGRlZmF1bHQ9NjQpIik7Cj4gPiA+ICBzdGF0aWMgaW50IGNo
YW5nZV9tYWNfYWRkcihzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2LCBjb25zdCB1OCAqYWRkcik7
Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgaW50IHNldF9mZWF0dXJlcyhzdHJ1Y3QgaGluaWNfZGV2ICpu
aWNfZGV2LAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBw
cmVfZmVhdHVyZXMsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJl
c190IGZlYXR1cmVzLCBib29sIGZvcmNlX2NoYW5nZSk7Cj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgIG5ldGRldl9mZWF0dXJlc190ICpwcmVfZmVhdHVyZXMsCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190ICpmZWF0dXJlcywgYm9vbCBmb3JjZV9jaGFu
Z2UpOwo+ID4gPgo+ID4gPiAgc3RhdGljIHZvaWQgdXBkYXRlX3J4X3N0YXRzKHN0cnVjdCBoaW5p
Y19kZXYgKm5pY19kZXYsIHN0cnVjdCBoaW5pY19yeHEgKnJ4cSkKPiA+ID4gIHsKPiA+ID4gQEAg
LTg4MCw3ICs4ODAsNyBAQCBzdGF0aWMgdm9pZCBoaW5pY19nZXRfc3RhdHM2NChzdHJ1Y3QgbmV0
X2RldmljZSAqbmV0ZGV2LAo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGljIGludCBoaW5pY19z
ZXRfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwKPiA+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190ICpmZWF0dXJlcykKPiA+
ID4gIHsKPiA+ID4gICAgICAgICBzdHJ1Y3QgaGluaWNfZGV2ICpuaWNfZGV2ID0gbmV0ZGV2X3By
aXYobmV0ZGV2KTsKPiA+ID4KPiA+ID4gQEAgLTg4OCwxOCArODg4LDE2IEBAIHN0YXRpYyBpbnQg
aGluaWNfc2V0X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsCj4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlcywgZmFsc2UpOwo+ID4gPiAgfQo+ID4gPgo+
ID4gPiAtc3RhdGljIG5ldGRldl9mZWF0dXJlc190IGhpbmljX2ZpeF9mZWF0dXJlcyhzdHJ1Y3Qg
bmV0X2RldmljZSAqbmV0ZGV2LAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzKQo+ID4gPiArc3RhdGljIHZv
aWQgaGluaWNfZml4X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcykK
PiA+ID4gIHsKPiA+ID4gICAgICAgICBzdHJ1Y3QgaGluaWNfZGV2ICpuaWNfZGV2ID0gbmV0ZGV2
X3ByaXYobmV0ZGV2KTsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBJZiBSeCBjaGVja3N1bSBpcyBk
aXNhYmxlZCwgdGhlbiBMUk8gc2hvdWxkIGFsc28gYmUgZGlzYWJsZWQgKi8KPiA+ID4gLSAgICAg
ICBpZiAoIShmZWF0dXJlcyAmIE5FVElGX0ZfUlhDU1VNKSkgewo+ID4gPiArICAgICAgIGlmICgh
KGZlYXR1cmVzWzBdICYgTkVUSUZfRl9SWENTVU0pKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICBu
ZXRpZl9pbmZvKG5pY19kZXYsIGRydiwgbmV0ZGV2LCAiZGlzYWJsaW5nIExSTyBhcwo+ID4gPiBS
WENTVU0gaXMgb2ZmXG4iKTsKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJ
Rl9GX0xSTzsKPiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH5ORVRJRl9GX0xS
TzsKPiA+ID4gICAgICAgICB9Cj4gPiA+IC0KPiA+ID4gLSAgICAgICByZXR1cm4gZmVhdHVyZXM7
Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IG5ldF9kZXZpY2Vfb3Bz
IGhpbmljX25ldGRldl9vcHMgPSB7Cj4gPiA+IEBAIC05NDMsMTkgKzk0MSwyMiBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IG5ldF9kZXZpY2Vfb3BzIGhpbmljdmZfbmV0ZGV2X29wcyA9IHsKPiA+ID4K
PiA+ID4gIHN0YXRpYyB2b2lkIG5ldGRldl9mZWF0dXJlc19pbml0KHN0cnVjdCBuZXRfZGV2aWNl
ICpuZXRkZXYpCj4gPiA+ICB7Cj4gPiA+IC0gICAgICAgbmV0ZGV2LT5od19mZWF0dXJlcyA9IE5F
VElGX0ZfU0cgfCBORVRJRl9GX0hJR0hETUEgfCBORVRJRl9GX0lQX0NTVU0gfAo+ID4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0lQVjZfQ1NVTSB8IE5FVElGX0ZfVFNP
IHwgTkVUSUZfRl9UU082IHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVU
SUZfRl9SWENTVU0gfCBORVRJRl9GX0xSTyB8Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RYIHwKPiA+ID4gTkVUSUZfRl9IV19WTEFOX0NU
QUdfUlggfAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19V
RFBfVFVOTkVMIHwKPiA+ID4gTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiAtCj4g
PiA+IC0gICAgICAgbmV0ZGV2LT52bGFuX2ZlYXR1cmVzID0gbmV0ZGV2LT5od19mZWF0dXJlczsK
PiA+ID4gLQo+ID4gPiAtICAgICAgIG5ldGRldi0+ZmVhdHVyZXMgPSBuZXRkZXYtPmh3X2ZlYXR1
cmVzIHwgTkVUSUZfRl9IV19WTEFOX0NUQUdfRklMVEVSOwo+ID4gPiAtCj4gPiA+IC0gICAgICAg
bmV0ZGV2LT5od19lbmNfZmVhdHVyZXMgPSBORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZf
Q1NVTQo+ID4gPiB8IE5FVElGX0ZfU0NUUF9DUkMgfAo+ID4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgTkVUSUZfRl9TRyB8IE5FVElGX0ZfVFNPIHwKPiA+ID4gTkVUSUZfRl9U
U082IHwgTkVUSUZfRl9UU09fRUNOIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIE5FVElGX0ZfR1NPX1VEUF9UVU5ORUxfQ1NVTSB8Cj4gPiA+IE5FVElGX0ZfR1NPX1VE
UF9UVU5ORUw7Cj4gPiA+ICsgICAgICAgbmV0ZGV2LT5od19mZWF0dXJlc1swXSA9Cj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfU0cgfCBORVRJRl9GX0hJR0hETUEgfCBORVRJ
Rl9GX0lQX0NTVU0gfAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0lQVjZf
Q1NVTSB8IE5FVElGX0ZfVFNPIHwgTkVUSUZfRl9UU082IHwKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgTkVUSUZfRl9SWENTVU0gfCBORVRJRl9GX0xSTyB8Cj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RYIHwgTkVUSUZfRl9IV19WTEFOX0NU
QUdfUlggfAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19VRFBfVFVO
TkVMIHwgTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNOwo+ID4gPiArCj4gPiA+ICsgICAgICAg
bmV0ZGV2X2ZlYXR1cmVzX2NvcHkobmV0ZGV2LT52bGFuX2ZlYXR1cmVzLCBuZXRkZXYtPmh3X2Zl
YXR1cmVzKTsKPiA+ID4gKwo+ID4gPiArICAgICAgIG5ldGRldi0+ZmVhdHVyZXNbMF0gPQo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXYtPmh3X2ZlYXR1cmVzWzBdIHwgTkVUSUZf
Rl9IV19WTEFOX0NUQUdfRklMVEVSOwo+ID4gPiArCj4gPiA+ICsgICAgICAgbmV0ZGV2LT5od19l
bmNfZmVhdHVyZXNbMF0gPQo+ID4gPiArICAgICAgICAgICAgICAgTkVUSUZfRl9JUF9DU1VNIHwg
TkVUSUZfRl9JUFY2X0NTVU0gfCBORVRJRl9GX1NDVFBfQ1JDIHwKPiA+ID4gKyAgICAgICAgICAg
ICAgIE5FVElGX0ZfU0cgfCBORVRJRl9GX1RTTyB8IE5FVElGX0ZfVFNPNiB8IE5FVElGX0ZfVFNP
X0VDTiB8Cj4gPiA+ICsgICAgICAgICAgICAgICBORVRJRl9GX0dTT19VRFBfVFVOTkVMX0NTVU0g
fCBORVRJRl9GX0dTT19VRFBfVFVOTkVMOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGljIHZv
aWQgaGluaWNfcmVmcmVzaF9uaWNfY2ZnKHN0cnVjdCBoaW5pY19kZXYgKm5pY19kZXYpCj4gPiA+
IEBAIC0xMDcyLDIxICsxMDczLDIyIEBAIHN0YXRpYyB2b2lkIGxpbmtfZXJyX2V2ZW50KHZvaWQg
KmhhbmRsZSwKPiA+ID4gIH0KPiA+ID4KPiA+ID4gIHN0YXRpYyBpbnQgc2V0X2ZlYXR1cmVzKHN0
cnVjdCBoaW5pY19kZXYgKm5pY19kZXYsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG5l
dGRldl9mZWF0dXJlc190IHByZV9mZWF0dXJlcywKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMsIGJvb2wgZm9yY2VfY2hhbmdlKQo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAqcHJlX2ZlYXR1cmVzLAo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMs
IGJvb2wgZm9yY2VfY2hhbmdlKQo+ID4gPiAgewo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJl
c190IGNoYW5nZWQgPSBmb3JjZV9jaGFuZ2UgPyB+MCA6IHByZV9mZWF0dXJlcyBeIGZlYXR1cmVz
Owo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZhaWxlZF9mZWF0dXJlc1tORVRERVZf
RkVBVFVSRV9EV09SRFNdID0gezB9Owo+ID4gPiAgICAgICAgIHUzMiBjc3VtX2VuID0gSElOSUNf
UlhfQ1NVTV9PRkZMT0FEX0VOOwo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZhaWxl
ZF9mZWF0dXJlcyA9IDA7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgY2hhbmdlZDsK
PiA+ID4gICAgICAgICBpbnQgcmV0ID0gMDsKPiA+ID4gICAgICAgICBpbnQgZXJyID0gMDsKPiA+
ID4KPiA+ID4gKyAgICAgICBjaGFuZ2VkID0gZm9yY2VfY2hhbmdlID8gfjAgOiBwcmVfZmVhdHVy
ZXNbMF0gXiBmZWF0dXJlc1swXTsKPiA+ID4gICAgICAgICBpZiAoY2hhbmdlZCAmIE5FVElGX0Zf
VFNPKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICByZXQgPSBoaW5pY19wb3J0X3NldF90c28obmlj
X2RldiwgKGZlYXR1cmVzICYgTkVUSUZfRl9UU08pID8KPiA+ID4gKyAgICAgICAgICAgICAgIHJl
dCA9IGhpbmljX3BvcnRfc2V0X3RzbyhuaWNfZGV2LCAoZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RT
TykgPwo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhJTklD
X1RTT19FTkFCTEUgOiBISU5JQ19UU09fRElTQUJMRSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBp
ZiAocmV0KSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IHJldDsKPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkX2ZlYXR1cmVzIHw9IE5FVElGX0ZfVFNPOwo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWRfZmVhdHVyZXNbMF0gfD0gTkVUSUZf
Rl9UU087Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4g
PiBAQCAtMTA5NCwzMyArMTA5NiwzNCBAQCBzdGF0aWMgaW50IHNldF9mZWF0dXJlcyhzdHJ1Y3Qg
aGluaWNfZGV2ICpuaWNfZGV2LAo+ID4gPiAgICAgICAgICAgICAgICAgcmV0ID0gaGluaWNfc2V0
X3J4X2NzdW1fb2ZmbG9hZChuaWNfZGV2LCBjc3VtX2VuKTsKPiA+ID4gICAgICAgICAgICAgICAg
IGlmIChyZXQpIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gcmV0Owo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWRfZmVhdHVyZXMgfD0gTkVUSUZfRl9SWENT
VU07Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZF9mZWF0dXJlc1swXSB8PSBO
RVRJRl9GX1JYQ1NVTTsKPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4gICAgICAgICB9Cj4g
PiA+Cj4gPiA+ICAgICAgICAgaWYgKGNoYW5nZWQgJiBORVRJRl9GX0xSTykgewo+ID4gPiAgICAg
ICAgICAgICAgICAgcmV0ID0gaGluaWNfc2V0X3J4X2xyb19zdGF0ZShuaWNfZGV2LAo+ID4gPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIShmZWF0dXJlcyAm
IE5FVElGX0ZfTFJPKSwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgISEoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0xSTyksCj4gPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhJTklDX0xST19SWF9USU1FUl9ERUZB
VUxULAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBI
SU5JQ19MUk9fTUFYX1dRRV9OVU1fREVGQVVMVCk7Cj4gPiA+ICAgICAgICAgICAgICAgICBpZiAo
cmV0KSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IHJldDsKPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgZmFpbGVkX2ZlYXR1cmVzIHw9IE5FVElGX0ZfTFJPOwo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWRfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9M
Uk87Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAg
ICAgICAgIGlmIChjaGFuZ2VkICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfUlgpIHsKPiA+ID4gICAg
ICAgICAgICAgICAgIHJldCA9IGhpbmljX3NldF9yeF92bGFuX29mZmxvYWQobmljX2RldiwKPiA+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgISEoZmVh
dHVyZXMgJgo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAhIShmZWF0dXJlc1swXSAmCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYKSk7Cj4gPiA+ICAg
ICAgICAgICAgICAgICBpZiAocmV0KSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGVy
ciA9IHJldDsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkX2ZlYXR1cmVzIHw9
IE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBm
YWlsZWRfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9IV19WTEFOX0NUQUdfUlg7Cj4gPiA+ICAgICAg
ICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAgICAgICAgIGlmIChlcnIp
IHsKPiA+ID4gLSAgICAgICAgICAgICAgIG5pY19kZXYtPm5ldGRldi0+ZmVhdHVyZXMgPSBmZWF0
dXJlcyBeIGZhaWxlZF9mZWF0dXJlczsKPiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9mZWF0
dXJlc194b3IobmljX2Rldi0+bmV0ZGV2LT5mZWF0dXJlcywgZmVhdHVyZXMsCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZF9mZWF0dXJlcykKPiA+ID4gICAg
ICAgICAgICAgICAgIHJldHVybiAtRUlPOwo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L2h1YXdlaS9oaW5pYy9oaW5pY19yeC5jCj4g
PiA+IGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvaHVhd2VpL2hpbmljL2hpbmljX3J4LmMKPiA+ID4g
aW5kZXggZmVkM2I2Yi4uNDUyYTkxYiAxMDA2NDQKPiA+ID4gLS0tIGEvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvaHVhd2VpL2hpbmljL2hpbmljX3J4LmMKPiA+ID4gKysrIGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvaHVhd2VpL2hpbmljL2hpbmljX3J4LmMKPiA+ID4gQEAgLTEwNiw3ICsxMDYsNyBAQCBz
dGF0aWMgdm9pZCByeF9jc3VtKHN0cnVjdCBoaW5pY19yeHEgKnJ4cSwgdTMyIHN0YXR1cywKPiA+
ID4KPiA+ID4gICAgICAgICBjc3VtX2VyciA9IEhJTklDX1JRX0NRRV9TVEFUVVNfR0VUKHN0YXR1
cywgQ1NVTV9FUlIpOwo+ID4gPgo+ID4gPiAtICAgICAgIGlmICghKG5ldGRldi0+ZmVhdHVyZXMg
JiBORVRJRl9GX1JYQ1NVTSkpCj4gPiA+ICsgICAgICAgaWYgKCEobmV0ZGV2LT5mZWF0dXJlc1sw
XSAmIE5FVElGX0ZfUlhDU1VNKSkKPiA+ID4gICAgICAgICAgICAgICAgIHJldHVybjsKPiA+ID4K
PiA+ID4gICAgICAgICBpZiAoIWNzdW1fZXJyKSB7Cj4gPiA+IEBAIC00MTEsNyArNDExLDcgQEAg
c3RhdGljIGludCByeHFfcmVjdihzdHJ1Y3QgaGluaWNfcnhxICpyeHEsIGludCBidWRnZXQpCj4g
PiA+Cj4gPiA+ICAgICAgICAgICAgICAgICBvZmZsb2FkX3R5cGUgPSBiZTMyX3RvX2NwdShjcWUt
Pm9mZmxvYWRfdHlwZSk7Cj4gPiA+ICAgICAgICAgICAgICAgICB2bGFuX2xlbiA9IGJlMzJfdG9f
Y3B1KGNxZS0+bGVuKTsKPiA+ID4gLSAgICAgICAgICAgICAgIGlmICgobmV0ZGV2LT5mZWF0dXJl
cyAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYKSAmJgo+ID4gPiArICAgICAgICAgICAgICAgaWYg
KChuZXRkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfUlgpICYmCj4gPiA+
ICAgICAgICAgICAgICAgICAgICAgSElOSUNfR0VUX1JYX1ZMQU5fT0ZGTE9BRF9FTihvZmZsb2Fk
X3R5cGUpKSB7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHZpZCA9IEhJTklDX0dFVF9S
WF9WTEFOX1RBRyh2bGFuX2xlbik7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIF9fdmxh
bl9od2FjY2VsX3B1dF90YWcoc2tiLCBodG9ucyhFVEhfUF84MDIxUSksIHZpZCk7Cj4gPiA+IGRp
ZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2lmX3ZsYW4uaCBiL2luY2x1ZGUvbGludXgvaWZfdmxh
bi5oCj4gPiA+IGluZGV4IDQxYTUxODMuLjQxNzM0NjQgMTAwNjQ0Cj4gPiA+IC0tLSBhL2luY2x1
ZGUvbGludXgvaWZfdmxhbi5oCj4gPiA+ICsrKyBiL2luY2x1ZGUvbGludXgvaWZfdmxhbi5oCj4g
PiA+IEBAIC01NjMsNyArNTYzLDcgQEAgc3RhdGljIGlubGluZSBpbnQgX192bGFuX2h3YWNjZWxf
Z2V0X3RhZyhjb25zdAo+ID4gPiBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPiAgICovCj4gPiA+
ICBzdGF0aWMgaW5saW5lIGludCB2bGFuX2dldF90YWcoY29uc3Qgc3RydWN0IHNrX2J1ZmYgKnNr
YiwgdTE2ICp2bGFuX3RjaSkKPiA+ID4gIHsKPiA+ID4gLSAgICAgICBpZiAoc2tiLT5kZXYtPmZl
YXR1cmVzICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfVFgpIHsKPiA+ID4gKyAgICAgICBpZiAoc2ti
LT5kZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9IV19WTEFOX0NUQUdfVFgpIHsKPiA+ID4gICAg
ICAgICAgICAgICAgIHJldHVybiBfX3ZsYW5faHdhY2NlbF9nZXRfdGFnKHNrYiwgdmxhbl90Y2kp
Owo+ID4gPiAgICAgICAgIH0gZWxzZSB7Cj4gPiA+ICAgICAgICAgICAgICAgICByZXR1cm4gX192
bGFuX2dldF90YWcoc2tiLCB2bGFuX3RjaSk7Cj4gPiA+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xp
bnV4L25ldGRldl9mZWF0dXJlcy5oIGIvaW5jbHVkZS9saW51eC9uZXRkZXZfZmVhdHVyZXMuaAo+
ID4gPiBpbmRleCAyYzZiOWU0Li45MTg0OTYzIDEwMDY0NAo+ID4gPiAtLS0gYS9pbmNsdWRlL2xp
bnV4L25ldGRldl9mZWF0dXJlcy5oCj4gPiA+ICsrKyBiL2luY2x1ZGUvbGludXgvbmV0ZGV2X2Zl
YXR1cmVzLmgKPiA+ID4gQEAgLTEwMiw3ICsxMDIsOCBAQCBlbnVtIHsKPiA+ID4gIH07Cj4gPiA+
Cj4gPiA+ICAvKiBjb3B5J24ncGFzdGUgY29tcHJlc3Npb24gOykgKi8KPiA+ID4gLSNkZWZpbmUg
X19ORVRJRl9GX0JJVChiaXQpICAgICAoKG5ldGRldl9mZWF0dXJlc190KTEgPDwgKGJpdCkpCj4g
PiA+ICsjZGVmaW5lIF9fTkVUSUZfRl9CSVQoYml0KSAgICAgKChuZXRkZXZfZmVhdHVyZXNfdCkx
IDw8IChiaXQgJiAweDNGKSkKPiA+ID4gKwo+ID4gPiAgI2RlZmluZSBfX05FVElGX0YobmFtZSkg
ICAgICAgICAgICAgICAgX19ORVRJRl9GX0JJVChORVRJRl9GXyMjbmFtZSMjX0JJVCkKPiA+ID4K
PiA+ID4gICNkZWZpbmUgTkVUSUZfRl9GQ09FX0NSQyAgICAgICBfX05FVElGX0YoRkNPRV9DUkMp
Cj4gPiA+IEBAIC0xNjksNiArMTcwLDggQEAgZW51bSB7Cj4gPiA+ICAjZGVmaW5lIE5FVElGX0Zf
SFdfSFNSX0ZXRCAgICAgX19ORVRJRl9GKEhXX0hTUl9GV0QpCj4gPiA+ICAjZGVmaW5lIE5FVElG
X0ZfSFdfSFNSX0RVUCAgICAgX19ORVRJRl9GKEhXX0hTUl9EVVApCj4gPiA+Cj4gPiA+ICsjZGVm
aW5lIE5FVERFVl9GRUFUVVJFX0RXT1JEUyAgRElWX1JPVU5EX1VQKE5FVERFVl9GRUFUVVJFX0NP
VU5ULCA2NCkKPiA+ID4gKwo+ID4gPiAgLyogRmluZHMgdGhlIG5leHQgZmVhdHVyZSB3aXRoIHRo
ZSBoaWdoZXN0IG51bWJlciBvZiB0aGUgcmFuZ2Ugb2Ygc3RhcnQgdGlsbCAwLgo+ID4gPiAgICov
Cj4gPiA+ICBzdGF0aWMgaW5saW5lIGludCBmaW5kX25leHRfbmV0ZGV2X2ZlYXR1cmUodTY0IGZl
YXR1cmUsIHVuc2lnbmVkIGxvbmcgc3RhcnQpCj4gPiA+IEBAIC0xODUsOCArMTg4LDcgQEAgc3Rh
dGljIGlubGluZSBpbnQgZmluZF9uZXh0X25ldGRldl9mZWF0dXJlKHU2NAo+ID4gPiBmZWF0dXJl
LCB1bnNpZ25lZCBsb25nIHN0YXJ0KQo+ID4gPiAgICogbWFza19hZGRyIHNob3VsZCBiZSBhIHU2
NCBhbmQgYml0IGFuIGludAo+ID4gPiAgICovCj4gPiA+ICAjZGVmaW5lIGZvcl9lYWNoX25ldGRl
dl9mZWF0dXJlKG1hc2tfYWRkciwgYml0KQo+ID4gPiAgICAgICAgICBcCj4gPiA+IC0gICAgICAg
Zm9yICgoYml0KSA9IGZpbmRfbmV4dF9uZXRkZXZfZmVhdHVyZSgobWFza19hZGRyKSwgICAgICAg
ICAgICAgIFwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIE5FVERFVl9GRUFUVVJFX0NPVU5UKTsgICAgXAo+ID4gPiArICAgICAgIGZvciAoKGJpdCkg
PSBmaW5kX25leHRfbmV0ZGV2X2ZlYXR1cmUoKG1hc2tfYWRkciksIDY0KTsgICAgICAgICBcCj4g
PiA+ICAgICAgICAgICAgICAoYml0KSA+PSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIFwKPiA+ID4gICAgICAgICAgICAgIChiaXQpID0gZmluZF9uZXh0
X25ldGRldl9mZWF0dXJlKChtYXNrX2FkZHIpLCAoYml0KSAtIDEpKQo+ID4gPgo+ID4gPiBAQCAt
MTk1LDExICsxOTcsNiBAQCBzdGF0aWMgaW5saW5lIGludCBmaW5kX25leHRfbmV0ZGV2X2ZlYXR1
cmUodTY0Cj4gPiA+IGZlYXR1cmUsIHVuc2lnbmVkIGxvbmcgc3RhcnQpCj4gPiA+ICAjZGVmaW5l
IE5FVElGX0ZfTkVWRVJfQ0hBTkdFICAgKE5FVElGX0ZfVkxBTl9DSEFMTEVOR0VEIHwgXAo+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0xMVFggfCBORVRJRl9G
X05FVE5TX0xPQ0FMKQo+ID4gPgo+ID4gPiAtLyogcmVtZW1iZXIgdGhhdCAoKHQpMSA8PCB0X0JJ
VFMpIGlzIHVuZGVmaW5lZCBpbiBDOTkgKi8KPiA+ID4gLSNkZWZpbmUgTkVUSUZfRl9FVEhUT09M
X0JJVFMgICAoKF9fTkVUSUZfRl9CSVQoTkVUREVWX0ZFQVRVUkVfQ09VTlQgLSAxKSB8IFwKPiA+
ID4gLSAgICAgICAgICAgICAgIChfX05FVElGX0ZfQklUKE5FVERFVl9GRUFUVVJFX0NPVU5UIC0g
MSkgLSAxKSkgJiBcCj4gPiA+IC0gICAgICAgICAgICAgICB+TkVUSUZfRl9ORVZFUl9DSEFOR0Up
Cj4gPiA+IC0KPiA+ID4gIC8qIFNlZ21lbnRhdGlvbiBvZmZsb2FkIGZlYXR1cmUgbWFzayAqLwo+
ID4gPiAgI2RlZmluZSBORVRJRl9GX0dTT19NQVNLICAgICAgIChfX05FVElGX0ZfQklUKE5FVElG
X0ZfR1NPX0xBU1QgKyAxKSAtIFwKPiA+ID4gICAgICAgICAgICAgICAgIF9fTkVUSUZfRl9CSVQo
TkVUSUZfRl9HU09fU0hJRlQpKQo+ID4gPiBAQCAtMjYxLDQgKzI1OCw5NiBAQCBzdGF0aWMgaW5s
aW5lIGludCBmaW5kX25leHRfbmV0ZGV2X2ZlYXR1cmUodTY0Cj4gPiA+IGZlYXR1cmUsIHVuc2ln
bmVkIGxvbmcgc3RhcnQpCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5F
VElGX0ZfR1NPX1VEUF9UVU5ORUwgfCAgICAgICAgICAgICAgIFwKPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9HU09fVURQX1RVTk5FTF9DU1VNKQo+ID4gPgo+
ID4gPiArc3RhdGljIGlubGluZSB2b2lkIG5ldGRldl9mZWF0dXJlc19jb3B5KG5ldGRldl9mZWF0
dXJlc190ICpkc3QsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBuZXRkZXZfZmVhdHVyZXNfdCAqc3JjKQo+ID4gPiArewo+ID4gPiArICAgICAgIHVu
c2lnbmVkIGludCBpOwo+ID4gPiArCj4gPiA+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERF
Vl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+ID4gPiArICAgICAgICAgICAgICAgZHN0W2ldID0gc3Jj
W2ldOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgbmV0ZGV2X2Zl
YXR1cmVzX2FuZChuZXRkZXZfZmVhdHVyZXNfdCAqZHN0LAo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXRkZXZfZmVhdHVyZXNfdCAqYSwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV0ZGV2X2ZlYXR1
cmVzX3QgKmIpCj4gPiA+ICt7Cj4gPiA+ICsgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+ICsK
PiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgTkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBpKysp
Cj4gPiA+ICsgICAgICAgICAgICAgICBkc3RbaV0gPSBhW2ldICYgYltpXTsKPiA+ID4gK30KPiA+
ID4gKwo+ID4gPiArc3RhdGljIGlubGluZSB2b2lkIG5ldGRldl9mZWF0dXJlc19hbmRub3QobmV0
ZGV2X2ZlYXR1cmVzX3QgKmRzdCwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgbmV0ZGV2X2ZlYXR1cmVzX3QgKmEsCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ldGRldl9mZWF0dXJlc190ICpi
KQo+ID4gPiArewo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPiArCj4gPiA+ICsg
ICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+ID4gPiAr
ICAgICAgICAgICAgICAgZHN0W2ldID0gYVtpXSAmIH5iW2ldOwo+ID4gPiArfQo+ID4gPiArCj4g
PiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgbmV0ZGV2X2ZlYXR1cmVzX29yKG5ldGRldl9mZWF0dXJl
c190ICpkc3QsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3QgbmV0ZGV2X2ZlYXR1cmVzX3QgKmEsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgbmV0ZGV2X2ZlYXR1cmVzX3QgKmIpCj4gPiA+ICt7Cj4gPiA+ICsg
ICAgICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBp
IDwgTkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBpKyspCj4gPiA+ICsgICAgICAgICAgICAgICBkc3Rb
aV0gPSBhW2ldIHwgYltpXTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGljIGlubGluZSB2
b2lkIG5ldGRldl9mZWF0dXJlc194b3IobmV0ZGV2X2ZlYXR1cmVzX3QgKmRzdCwKPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV0ZGV2X2ZlYXR1cmVz
X3QgKmEsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IG5ldGRldl9mZWF0dXJlc190ICpiKQo+ID4gPiArewo+ID4gPiArICAgICAgIHVuc2lnbmVkIGlu
dCBpOwo+ID4gPiArCj4gPiA+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJF
X0RXT1JEUzsgaSsrKQo+ID4gPiArICAgICAgICAgICAgICAgZHN0W2ldID0gYVtpXSBeIGJbaV07
Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBuZXRkZXZfZmVhdHVy
ZXNfc2V0KG5ldGRldl9mZWF0dXJlc190ICpkc3QsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBiaXQpCj4gPiA+ICt7Cj4gPiA+ICsgICAg
ICAgZHN0W2JpdCAvIDY0XSB8PSBfX05FVElGX0ZfQklUKGJpdCk7Cj4gPiA+ICt9Cj4gPiA+ICsK
PiA+ID4gK3N0YXRpYyBpbmxpbmUgYm9vbCBuZXRkZXZfZmVhdHVyZXNfZXF1YWwoY29uc3QgbmV0
ZGV2X2ZlYXR1cmVzX3QgKmEsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3QgbmV0ZGV2X2ZlYXR1cmVzX3QgKmIpCj4gPiA+ICt7Cj4gPiA+ICsgICAg
ICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwg
TkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBpKyspCj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoYVtp
XSAhPSBiW2ldKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7Cj4g
PiA+ICsKPiA+ID4gKyAgICAgICByZXR1cm4gdHJ1ZTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiAr
c3RhdGljIGlubGluZSB2b2lkIG5ldGRldl9mZWF0dXJlc19lbXB0eShuZXRkZXZfZmVhdHVyZXNf
dCAqc3JjKQo+ID4gPiArewo+ID4gPiArICAgICAgIHVuc2lnbmVkIGludCBpOwo+ID4gPiArCj4g
PiA+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKQo+
ID4gPiArICAgICAgICAgICAgICAgaWYgKHNyY1tpXSkKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwo+ID4gPiArCj4gPiA+ICsgICAgICAgcmV0dXJuIHRydWU7Cj4g
PiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBuZXRkZXZfZmVhdHVyZXNf
ZXRodG9vbF9iaXRzKG5ldGRldl9mZWF0dXJlc190ICpkc3QpCj4gPiA+ICt7Cj4gPiA+ICsgICAg
ICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwg
TkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBpKyspIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChO
RVRERVZfRkVBVFVSRV9DT1VOVCA+PSAoaSArIDEpICogNjQpCj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGRzdFtpXSA9IEdFTk1BU0tfVUxMKDYzLCAwKTsKPiA+ID4gKyAgICAgICAgICAg
ICAgIGVsc2UKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZHN0W2ldID0gR0VOTUFTS19V
TEwoTkVUREVWX0ZFQVRVUkVfQ09VTlQgLSBpICogNjQsCj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCk7Cj4gPiA+ICsgICAgICAgfQo+ID4g
PiArICAgICAgIGRzdFswXSAmPSB+TkVUSUZfRl9ORVZFUl9DSEFOR0U7Cj4gPiA+ICt9Cj4gPiA+
ICsKPiA+ID4gICNlbmRpZiAvKiBfTElOVVhfTkVUREVWX0ZFQVRVUkVTX0ggKi8KPiA+ID4gZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvbmV0ZGV2aWNlLmggYi9pbmNsdWRlL2xpbnV4L25ldGRl
dmljZS5oCj4gPiA+IGluZGV4IGVhZjViYjAuLjRhMjk0ODcgMTAwNjQ0Cj4gPiA+IC0tLSBhL2lu
Y2x1ZGUvbGludXgvbmV0ZGV2aWNlLmgKPiA+ID4gKysrIGIvaW5jbHVkZS9saW51eC9uZXRkZXZp
Y2UuaAo+ID4gPiBAQCAtMTM0Nyw5ICsxMzQ3LDkgQEAgc3RydWN0IG5ldF9kZXZpY2Vfb3BzIHsK
PiA+ID4gICAgICAgICBpbnQgICAgICAgICAgICAgICAgICAgICAoKm5kb19zdG9wKShzdHJ1Y3Qg
bmV0X2RldmljZSAqZGV2KTsKPiA+ID4gICAgICAgICBuZXRkZXZfdHhfdCAgICAgICAgICAgICAo
Km5kb19zdGFydF94bWl0KShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYpOwo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190ICAgICAgICgqbmRvX2ZlYXR1cmVz
X2NoZWNrKShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPiArICAgICAgIHZvaWQgICAgICAgICAg
ICAgICAgICAgICgqbmRvX2ZlYXR1cmVzX2NoZWNrKShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiAtCj4gPiA+IG5ldGRldl9mZWF0dXJlc190IGZl
YXR1cmVzKTsKPiA+ID4gKwo+ID4gPiBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpOwo+ID4g
PiAgICAgICAgIHUxNiAgICAgICAgICAgICAgICAgICAgICgqbmRvX3NlbGVjdF9xdWV1ZSkoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBza19idWZmICpza2IsCj4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmV0X2Rl
dmljZSAqc2JfZGV2KTsKPiA+ID4gQEAgLTE0NjcsMTAgKzE0NjcsMTAgQEAgc3RydWN0IG5ldF9k
ZXZpY2Vfb3BzIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYm9vbCBhbGxfc2xhdmVzKTsKPiA+ID4gICAgICAgICBzdHJ1Y3QgbmV0
X2RldmljZSogICAgICAoKm5kb19za19nZXRfbG93ZXJfZGV2KShzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2LAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBzb2NrICpzayk7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVz
X3QgICAgICAgKCpuZG9fZml4X2ZlYXR1cmVzKShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpOwo+ID4gPiArICAgICAgIHZvaWQgICAgICAgICAgICAg
ICAgICAgICgqbmRvX2ZpeF9mZWF0dXJlcykoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRl
dl9mZWF0dXJlc190Cj4gPiA+ICpmZWF0dXJlcyk7Cj4gPiA+ICAgICAgICAgaW50ICAgICAgICAg
ICAgICAgICAgICAgKCpuZG9fc2V0X2ZlYXR1cmVzKShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+
ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QKPiA+ID4gKmZl
YXR1cmVzKTsKPiA+ID4gICAgICAgICBpbnQgICAgICAgICAgICAgICAgICAgICAoKm5kb19uZWln
aF9jb25zdHJ1Y3QpKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmVpZ2hib3Vy
ICpuKTsKPiA+ID4gICAgICAgICB2b2lkICAgICAgICAgICAgICAgICAgICAoKm5kb19uZWlnaF9k
ZXN0cm95KShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiBAQCAtMTk3OCwxMiArMTk3OCwx
MiBAQCBzdHJ1Y3QgbmV0X2RldmljZSB7Cj4gPiA+ICAgICAgICAgdW5zaWduZWQgc2hvcnQgICAg
ICAgICAgbmVlZGVkX2hlYWRyb29tOwo+ID4gPiAgICAgICAgIHVuc2lnbmVkIHNob3J0ICAgICAg
ICAgIG5lZWRlZF90YWlscm9vbTsKPiA+ID4KPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNf
dCAgICAgICBmZWF0dXJlczsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAgICAgICBo
d19mZWF0dXJlczsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAgICAgICB3YW50ZWRf
ZmVhdHVyZXM7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgICAgICAgdmxhbl9mZWF0
dXJlczsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAgICAgICBod19lbmNfZmVhdHVy
ZXM7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgICAgICAgbXBsc19mZWF0dXJlczsK
PiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAgICAgICBmZWF0dXJlc1tORVRERVZfRkVB
VFVSRV9EV09SRFNdOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190ICAgICAgIGh3X2Zl
YXR1cmVzW05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1
cmVzX3QgICAgICAgd2FudGVkX2ZlYXR1cmVzW05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+
ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgICAgICAgdmxhbl9mZWF0dXJlc1tORVRERVZfRkVB
VFVSRV9EV09SRFNdOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190ICAgICAgIGh3X2Vu
Y19mZWF0dXJlc1tORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+ID4gPiArICAgICAgIG5ldGRldl9m
ZWF0dXJlc190ICAgICAgIG1wbHNfZmVhdHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+
ID4gICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCAgICAgICBnc29fcGFydGlhbF9mZWF0dXJlczsK
PiA+ID4KPiA+ID4gICAgICAgICB1bnNpZ25lZCBpbnQgICAgICAgICAgICBtaW5fbXR1Owo+ID4g
PiBAQCAtNDk4NiwxMCArNDk4NiwxMSBAQCBzdGF0aWMgaW5saW5lIG5ldGRldl9mZWF0dXJlc190
Cj4gPiA+IG5ldGRldl9pbnRlcnNlY3RfZmVhdHVyZXMobmV0ZGV2X2ZlYXR1cmVzX3QgZjEsCj4g
PiA+ICAgICAgICAgcmV0dXJuIGYxICYgZjI7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+IC1zdGF0aWMg
aW5saW5lIG5ldGRldl9mZWF0dXJlc190IG5ldGRldl9nZXRfd2FudGVkX2ZlYXR1cmVzKAo+ID4g
PiAtICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCj4gPiA+ICtzdGF0aWMgaW5saW5lIHZv
aWQgbmV0ZGV2X2dldF93YW50ZWRfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9m
ZWF0dXJlc190ICp3YW50ZWQpCj4gPiA+ICB7Cj4gPiA+IC0gICAgICAgcmV0dXJuIChkZXYtPmZl
YXR1cmVzICYgfmRldi0+aHdfZmVhdHVyZXMpIHwgZGV2LT53YW50ZWRfZmVhdHVyZXM7Cj4gPiA+
ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2FuZG5vdCh3YW50ZWQsIGRldi0+ZmVhdHVyZXMsIGRl
di0+aHdfZmVhdHVyZXMpOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc19vcih3YW50ZWQs
IHdhbnRlZCwgZGV2LT53YW50ZWRfZmVhdHVyZXMpOwo+ID4gPiAgfQo+ID4gPiAgbmV0ZGV2X2Zl
YXR1cmVzX3QgbmV0ZGV2X2luY3JlbWVudF9mZWF0dXJlcyhuZXRkZXZfZmVhdHVyZXNfdCBhbGws
Cj4gPiA+ICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3Qgb25lLCBuZXRkZXZfZmVhdHVyZXNfdCBt
YXNrKTsKPiA+ID4gQEAgLTUwMTQsNyArNTAxNSw3IEBAIHZvaWQgbmV0aWZfc3RhY2tlZF90cmFu
c2Zlcl9vcGVyc3RhdGUoY29uc3QKPiA+ID4gc3RydWN0IG5ldF9kZXZpY2UgKnJvb3RkZXYsCj4g
PiA+ICBuZXRkZXZfZmVhdHVyZXNfdCBwYXNzdGhydV9mZWF0dXJlc19jaGVjayhzdHJ1Y3Qgc2tf
YnVmZiAqc2tiLAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcyk7Cj4gPiA+IC1uZXRk
ZXZfZmVhdHVyZXNfdCBuZXRpZl9za2JfZmVhdHVyZXMoc3RydWN0IHNrX2J1ZmYgKnNrYik7Cj4g
PiA+ICt2b2lkIG5ldGlmX3NrYl9mZWF0dXJlcyhzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBuZXRkZXZf
ZmVhdHVyZXNfdCAqZmVhdHVyZXMpOwo+ID4gPgo+ID4gPiAgc3RhdGljIGlubGluZSBib29sIG5l
dF9nc29fb2sobmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMsIGludCBnc29fdHlwZSkKPiA+ID4g
IHsKPiA+ID4gZGlmZiAtLWdpdCBhL25ldC84MDIxcS92bGFuLmMgYi9uZXQvODAyMXEvdmxhbi5j
Cj4gPiA+IGluZGV4IDRjZGY4NDEuLjdkNzc2OTIgMTAwNjQ0Cj4gPiA+IC0tLSBhL25ldC84MDIx
cS92bGFuLmMKPiA+ID4gKysrIGIvbmV0LzgwMjFxL3ZsYW4uYwo+ID4gPiBAQCAtMzI4LDcgKzMy
OCw3IEBAIHN0YXRpYyB2b2lkIHZsYW5fdHJhbnNmZXJfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZp
Y2UgKmRldiwKPiA+ID4gICAgICAgICB2bGFuZGV2LT5nc29fbWF4X3NpemUgPSBkZXYtPmdzb19t
YXhfc2l6ZTsKPiA+ID4gICAgICAgICB2bGFuZGV2LT5nc29fbWF4X3NlZ3MgPSBkZXYtPmdzb19t
YXhfc2VnczsKPiA+ID4KPiA+ID4gLSAgICAgICBpZiAodmxhbl9od19vZmZsb2FkX2NhcGFibGUo
ZGV2LT5mZWF0dXJlcywgdmxhbi0+dmxhbl9wcm90bykpCj4gPiA+ICsgICAgICAgaWYgKHZsYW5f
aHdfb2ZmbG9hZF9jYXBhYmxlKGRldi0+ZmVhdHVyZXNbMF0sIHZsYW4tPnZsYW5fcHJvdG8pKQo+
ID4gPiAgICAgICAgICAgICAgICAgdmxhbmRldi0+aGFyZF9oZWFkZXJfbGVuID0gZGV2LT5oYXJk
X2hlYWRlcl9sZW47Cj4gPiA+ICAgICAgICAgZWxzZQo+ID4gPiAgICAgICAgICAgICAgICAgdmxh
bmRldi0+aGFyZF9oZWFkZXJfbGVuID0gZGV2LT5oYXJkX2hlYWRlcl9sZW4gKyBWTEFOX0hMRU47
Cj4gPiA+IEBAIC0zMzksNyArMzM5LDcgQEAgc3RhdGljIHZvaWQgdmxhbl90cmFuc2Zlcl9mZWF0
dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAo+ID4gPgo+ID4gPiAgICAgICAgIHZsYW5kZXYt
PnByaXZfZmxhZ3MgJj0gfklGRl9YTUlUX0RTVF9SRUxFQVNFOwo+ID4gPiAgICAgICAgIHZsYW5k
ZXYtPnByaXZfZmxhZ3MgfD0gKHZsYW4tPnJlYWxfZGV2LT5wcml2X2ZsYWdzICYKPiA+ID4gSUZG
X1hNSVRfRFNUX1JFTEVBU0UpOwo+ID4gPiAtICAgICAgIHZsYW5kZXYtPmh3X2VuY19mZWF0dXJl
cyA9IHZsYW5fdG5sX2ZlYXR1cmVzKHZsYW4tPnJlYWxfZGV2KTsKPiA+ID4gKyAgICAgICB2bGFu
ZGV2LT5od19lbmNfZmVhdHVyZXNbMF0gPSB2bGFuX3RubF9mZWF0dXJlcyh2bGFuLT5yZWFsX2Rl
dik7Cj4gPiA+Cj4gPiA+ICAgICAgICAgbmV0ZGV2X3VwZGF0ZV9mZWF0dXJlcyh2bGFuZGV2KTsK
PiA+ID4gIH0KPiA+ID4gZGlmZiAtLWdpdCBhL25ldC84MDIxcS92bGFuLmggYi9uZXQvODAyMXEv
dmxhbi5oCj4gPiA+IGluZGV4IDFhNzA1YTQuLjRlNzg0YTEgMTAwNjQ0Cj4gPiA+IC0tLSBhL25l
dC84MDIxcS92bGFuLmgKPiA+ID4gKysrIGIvbmV0LzgwMjFxL3ZsYW4uaAo+ID4gPiBAQCAtMTA3
LDcgKzEwNyw3IEBAIHN0YXRpYyBpbmxpbmUgbmV0ZGV2X2ZlYXR1cmVzX3QKPiA+ID4gdmxhbl90
bmxfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKnJlYWxfZGV2KQo+ID4gPiAgewo+ID4gPiAg
ICAgICAgIG5ldGRldl9mZWF0dXJlc190IHJldDsKPiA+ID4KPiA+ID4gLSAgICAgICByZXQgPSBy
ZWFsX2Rldi0+aHdfZW5jX2ZlYXR1cmVzICYKPiA+ID4gKyAgICAgICByZXQgPSByZWFsX2Rldi0+
aHdfZW5jX2ZlYXR1cmVzWzBdICYKPiA+ID4gICAgICAgICAgICAgICAoTkVUSUZfRl9DU1VNX01B
U0sgfCBORVRJRl9GX0dTT19TT0ZUV0FSRSB8Cj4gPiA+ICAgICAgICAgICAgICAgIE5FVElGX0Zf
R1NPX0VOQ0FQX0FMTCk7Cj4gPiA+Cj4gPiA+IGRpZmYgLS1naXQgYS9uZXQvODAyMXEvdmxhbl9k
ZXYuYyBiL25ldC84MDIxcS92bGFuX2Rldi5jCj4gPiA+IGluZGV4IGEwMzY3YjMuLjZkNDk3NjEg
MTAwNjQ0Cj4gPiA+IC0tLSBhL25ldC84MDIxcS92bGFuX2Rldi5jCj4gPiA+ICsrKyBiL25ldC84
MDIxcS92bGFuX2Rldi5jCj4gPiA+IEBAIC01NjYsMjEgKzU2NiwyMSBAQCBzdGF0aWMgaW50IHZs
YW5fZGV2X2luaXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKPiA+ID4gICAgICAgICBpZiAodmxh
bi0+ZmxhZ3MgJiBWTEFOX0ZMQUdfQlJJREdFX0JJTkRJTkcpCj4gPiA+ICAgICAgICAgICAgICAg
ICBkZXYtPnN0YXRlIHw9ICgxIDw8IF9fTElOS19TVEFURV9OT0NBUlJJRVIpOwo+ID4gPgo+ID4g
PiAtICAgICAgIGRldi0+aHdfZmVhdHVyZXMgPSBORVRJRl9GX0hXX0NTVU0gfCBORVRJRl9GX1NH
IHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9GUkFHTElTVCB8IE5F
VElGX0ZfR1NPX1NPRlRXQVJFIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgTkVU
SUZfRl9HU09fRU5DQVBfQUxMIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgTkVU
SUZfRl9ISUdIRE1BIHwgTkVUSUZfRl9TQ1RQX0NSQyB8Cj4gPiA+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgIE5FVElGX0ZfQUxMX0ZDT0U7Cj4gPiA+ICsgICAgICAgZGV2LT5od19mZWF0dXJl
c1swXSA9IE5FVElGX0ZfSFdfQ1NVTSB8IE5FVElGX0ZfU0cgfAo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBORVRJRl9GX0ZSQUdMSVNUIHwgTkVUSUZfRl9HU09fU09GVFdBUkUg
fAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0dTT19FTkNBUF9B
TEwgfAo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBORVRJRl9GX0hJR0hETUEg
fCBORVRJRl9GX1NDVFBfQ1JDIHwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
TkVUSUZfRl9BTExfRkNPRTsKPiA+ID4KPiA+ID4gLSAgICAgICBkZXYtPmZlYXR1cmVzIHw9IGRl
di0+aHdfZmVhdHVyZXMgfCBORVRJRl9GX0xMVFg7Cj4gPiA+ICsgICAgICAgZGV2LT5mZWF0dXJl
c1swXSB8PSBkZXYtPmh3X2ZlYXR1cmVzWzBdIHwgTkVUSUZfRl9MTFRYOwo+ID4gPiAgICAgICAg
IGRldi0+Z3NvX21heF9zaXplID0gcmVhbF9kZXYtPmdzb19tYXhfc2l6ZTsKPiA+ID4gICAgICAg
ICBkZXYtPmdzb19tYXhfc2VncyA9IHJlYWxfZGV2LT5nc29fbWF4X3NlZ3M7Cj4gPiA+IC0gICAg
ICAgaWYgKGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX1ZMQU5fRkVBVFVSRVMpCj4gPiA+ICsgICAg
ICAgaWYgKGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX1ZMQU5fRkVBVFVSRVMpCj4gPiA+ICAg
ICAgICAgICAgICAgICBuZXRkZXZfd2FybihyZWFsX2RldiwgIlZMQU4gZmVhdHVyZXMgYXJlIHNl
dAo+ID4gPiBpbmNvcnJlY3RseS4gIFEtaW4tUSBjb25maWd1cmF0aW9ucyBtYXkgbm90IHdvcmsg
Y29ycmVjdGx5LlxuIik7Cj4gPiA+Cj4gPiA+IC0gICAgICAgZGV2LT52bGFuX2ZlYXR1cmVzID0g
cmVhbF9kZXYtPnZsYW5fZmVhdHVyZXMgJiB+TkVUSUZfRl9BTExfRkNPRTsKPiA+ID4gLSAgICAg
ICBkZXYtPmh3X2VuY19mZWF0dXJlcyA9IHZsYW5fdG5sX2ZlYXR1cmVzKHJlYWxfZGV2KTsKPiA+
ID4gLSAgICAgICBkZXYtPm1wbHNfZmVhdHVyZXMgPSByZWFsX2Rldi0+bXBsc19mZWF0dXJlczsK
PiA+ID4gKyAgICAgICBkZXYtPnZsYW5fZmVhdHVyZXNbMF0gPSByZWFsX2Rldi0+dmxhbl9mZWF0
dXJlc1swXSAmIH5ORVRJRl9GX0FMTF9GQ09FOwo+ID4gPiArICAgICAgIGRldi0+aHdfZW5jX2Zl
YXR1cmVzWzBdID0gdmxhbl90bmxfZmVhdHVyZXMocmVhbF9kZXYpOwo+ID4gPiArICAgICAgIG5l
dGRldl9mZWF0dXJlc19jb3B5KGRldi0+bXBsc19mZWF0dXJlcywgcmVhbF9kZXYtPm1wbHNfZmVh
dHVyZXMpOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIGlwdjYgc2hhcmVkIGNhcmQgcmVsYXRlZCBz
dHVmZiAqLwo+ID4gPiAgICAgICAgIGRldi0+ZGV2X2lkID0gcmVhbF9kZXYtPmRldl9pZDsKPiA+
ID4gQEAgLTYzMywyNyArNjMzLDMwIEBAIHZvaWQgdmxhbl9kZXZfdW5pbml0KHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYpCj4gPiA+ICAgICAgICAgfQo+ID4gPiAgfQo+ID4gPgo+ID4gPiAtc3RhdGlj
IG5ldGRldl9mZWF0dXJlc190IHZsYW5fZGV2X2ZpeF9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2LAo+ID4gPiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzKQo+ID4gPiAr
c3RhdGljIHZvaWQgdmxhbl9kZXZfZml4X2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYs
Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNf
dCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKnJl
YWxfZGV2ID0gdmxhbl9kZXZfcHJpdihkZXYpLT5yZWFsX2RldjsKPiA+ID4gLSAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfdCBvbGRfZmVhdHVyZXMgPSBmZWF0dXJlczsKPiA+ID4gLSAgICAgICBuZXRk
ZXZfZmVhdHVyZXNfdCBsb3dlcl9mZWF0dXJlczsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVy
ZXNfdCBsb3dlcl9mZWF0dXJlc1tORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+ID4gPiArICAgICAg
IG5ldGRldl9mZWF0dXJlc190IG9sZF9mZWF0dXJlc1tORVRERVZfRkVBVFVSRV9EV09SRFNdOwo+
ID4gPgo+ID4gPiAtICAgICAgIGxvd2VyX2ZlYXR1cmVzID0gbmV0ZGV2X2ludGVyc2VjdF9mZWF0
dXJlcygocmVhbF9kZXYtPnZsYW5fZmVhdHVyZXMgfAo+ID4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkVUSUZfRl9SWENTVU0pLAo+ID4gPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFsX2Rl
di0+ZmVhdHVyZXMpOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc19jb3B5KGxvd2VyX2Zl
YXR1cmVzLCBmZWF0dXJlcyk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBsb3dlcl9mZWF0dXJlc1sw
XSA9Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXZfaW50ZXJzZWN0X2ZlYXR1cmVzKChyZWFs
X2Rldi0+dmxhbl9mZWF0dXJlc1swXSB8Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBORVRJRl9GX1JYQ1NVTSksCj4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxfZGV2LT5mZWF0dXJlc1swXSk7Cj4gPiA+Cj4g
PiA+ICAgICAgICAgLyogQWRkIEhXX0NTVU0gc2V0dGluZyB0byBwcmVzZXJ2ZSB1c2VyIGFiaWxp
dHkgdG8gY29udHJvbAo+ID4gPiAgICAgICAgICAqIGNoZWNrc3VtIG9mZmxvYWQgb24gdGhlIHZs
YW4gZGV2aWNlLgo+ID4gPiAgICAgICAgICAqLwo+ID4gPiAtICAgICAgIGlmIChsb3dlcl9mZWF0
dXJlcyAmIChORVRJRl9GX0lQX0NTVU18TkVUSUZfRl9JUFY2X0NTVU0pKQo+ID4gPiAtICAgICAg
ICAgICAgICAgbG93ZXJfZmVhdHVyZXMgfD0gTkVUSUZfRl9IV19DU1VNOwo+ID4gPiAtICAgICAg
IGZlYXR1cmVzID0gbmV0ZGV2X2ludGVyc2VjdF9mZWF0dXJlcyhmZWF0dXJlcywgbG93ZXJfZmVh
dHVyZXMpOwo+ID4gPiAtICAgICAgIGZlYXR1cmVzIHw9IG9sZF9mZWF0dXJlcyAmIChORVRJRl9G
X1NPRlRfRkVBVFVSRVMgfAo+ID4gPiBORVRJRl9GX0dTT19TT0ZUV0FSRSk7Cj4gPiA+IC0gICAg
ICAgZmVhdHVyZXMgfD0gTkVUSUZfRl9MTFRYOwo+ID4gPiArICAgICAgIGlmIChsb3dlcl9mZWF0
dXJlc1swXSAmIChORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTSkpCj4gPiA+ICsg
ICAgICAgICAgICAgICBsb3dlcl9mZWF0dXJlc1swXSB8PSBORVRJRl9GX0hXX0NTVU07Cj4gPiA+
Cj4gPiA+IC0gICAgICAgcmV0dXJuIGZlYXR1cmVzOwo+ID4gPiArICAgICAgIGZlYXR1cmVzWzBd
ID0gbmV0ZGV2X2ludGVyc2VjdF9mZWF0dXJlcyhmZWF0dXJlc1swXSwgbG93ZXJfZmVhdHVyZXNb
MF0pOwo+ID4gPiArICAgICAgIGZlYXR1cmVzWzBdIHw9IG9sZF9mZWF0dXJlc1swXSAmCj4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgIChORVRJRl9GX1NPRlRfRkVBVFVSRVMgfCBORVRJRl9G
X0dTT19TT0ZUV0FSRSk7Cj4gPiA+ICsgICAgICAgZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9MTFRY
Owo+ID4gPiAgfQo+ID4gPgo+ID4gPiAgc3RhdGljIGludCB2bGFuX2V0aHRvb2xfZ2V0X2xpbmtf
a3NldHRpbmdzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCj4gPiA+IGRpZmYgLS1naXQgYS9uZXQv
Y29yZS9kZXYuYyBiL25ldC9jb3JlL2Rldi5jCj4gPiA+IGluZGV4IGMyNTNjMmEuLjcwNjZiZjMg
MTAwNjQ0Cj4gPiA+IC0tLSBhL25ldC9jb3JlL2Rldi5jCj4gPiA+ICsrKyBiL25ldC9jb3JlL2Rl
di5jCj4gPiA+IEBAIC0xNzY1LDcgKzE3NjUsNyBAQCB2b2lkIGRldl9kaXNhYmxlX2xybyhzdHJ1
Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgICAgICAgIGRldi0+d2FudGVkX2ZlYXR1cmVzICY9
IH5ORVRJRl9GX0xSTzsKPiA+ID4gICAgICAgICBuZXRkZXZfdXBkYXRlX2ZlYXR1cmVzKGRldik7
Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKHVubGlrZWx5KGRldi0+ZmVhdHVyZXMgJiBORVRJRl9G
X0xSTykpCj4gPiA+ICsgICAgICAgaWYgKHVubGlrZWx5KGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJ
Rl9GX0xSTykpCj4gPiA+ICAgICAgICAgICAgICAgICBuZXRkZXZfV0FSTihkZXYsICJmYWlsZWQg
dG8gZGlzYWJsZSBMUk8hXG4iKTsKPiA+ID4KPiA+ID4gICAgICAgICBuZXRkZXZfZm9yX2VhY2hf
bG93ZXJfZGV2KGRldiwgbG93ZXJfZGV2LCBpdGVyKQo+ID4gPiBAQCAtMTc4Niw3ICsxNzg2LDcg
QEAgc3RhdGljIHZvaWQgZGV2X2Rpc2FibGVfZ3JvX2h3KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYp
Cj4gPiA+ICAgICAgICAgZGV2LT53YW50ZWRfZmVhdHVyZXMgJj0gfk5FVElGX0ZfR1JPX0hXOwo+
ID4gPiAgICAgICAgIG5ldGRldl91cGRhdGVfZmVhdHVyZXMoZGV2KTsKPiA+ID4KPiA+ID4gLSAg
ICAgICBpZiAodW5saWtlbHkoZGV2LT5mZWF0dXJlcyAmIE5FVElGX0ZfR1JPX0hXKSkKPiA+ID4g
KyAgICAgICBpZiAodW5saWtlbHkoZGV2LT5mZWF0dXJlc1swXSAmIE5FVElGX0ZfR1JPX0hXKSkK
PiA+ID4gICAgICAgICAgICAgICAgIG5ldGRldl9XQVJOKGRldiwgImZhaWxlZCB0byBkaXNhYmxl
IEdST19IVyFcbiIpOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiBAQCAtMzI3Niw3ICszMjc2LDcgQEAg
c3RhdGljIHZvaWQgc2tiX3dhcm5fYmFkX29mZmxvYWQoY29uc3Qgc3RydWN0Cj4gPiA+IHNrX2J1
ZmYgKnNrYikKPiA+ID4gICAgICAgICB9Cj4gPiA+ICAgICAgICAgc2tiX2R1bXAoS0VSTl9XQVJO
SU5HLCBza2IsIGZhbHNlKTsKPiA+ID4gICAgICAgICBXQVJOKDEsICIlczogY2Fwcz0oJXBORiwg
JXBORilcbiIsCj4gPiA+IC0gICAgICAgICAgICBuYW1lLCBkZXYgPyAmZGV2LT5mZWF0dXJlcyA6
ICZudWxsX2ZlYXR1cmVzLAo+ID4gPiArICAgICAgICAgICAgbmFtZSwgZGV2ID8gJmRldi0+ZmVh
dHVyZXNbMF0gOiAmbnVsbF9mZWF0dXJlcywKPiA+ID4gICAgICAgICAgICAgIHNrYi0+c2sgPyAm
c2tiLT5zay0+c2tfcm91dGVfY2FwcyA6ICZudWxsX2ZlYXR1cmVzKTsKPiA+ID4gIH0KPiA+ID4K
PiA+ID4gQEAgLTM0NjMsNyArMzQ2Myw4IEBAIHN0cnVjdCBza19idWZmICpfX3NrYl9nc29fc2Vn
bWVudChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPiAgICAgICAgICAgICAgICAgbmV0ZGV2X2Zl
YXR1cmVzX3QgcGFydGlhbF9mZWF0dXJlcyA9IE5FVElGX0ZfR1NPX1JPQlVTVDsKPiA+ID4gICAg
ICAgICAgICAgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSBza2ItPmRldjsKPiA+ID4KPiA+
ID4gLSAgICAgICAgICAgICAgIHBhcnRpYWxfZmVhdHVyZXMgfD0gZGV2LT5mZWF0dXJlcyAmIGRl
di0+Z3NvX3BhcnRpYWxfZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgICAgICAgICBwYXJ0aWFsX2Zl
YXR1cmVzIHw9Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2LT5mZWF0
dXJlc1swXSAmIGRldi0+Z3NvX3BhcnRpYWxfZmVhdHVyZXM7Cj4gPiA+ICAgICAgICAgICAgICAg
ICBpZiAoIXNrYl9nc29fb2soc2tiLCBmZWF0dXJlcyB8IHBhcnRpYWxfZmVhdHVyZXMpKQo+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlcyAmPSB+TkVUSUZfRl9HU09fUEFSVElB
TDsKPiA+ID4gICAgICAgICB9Cj4gPiA+IEBAIC0zNTA4LDcgKzM1MDksNyBAQCBzdGF0aWMgaW50
IGlsbGVnYWxfaGlnaGRtYShzdHJ1Y3QgbmV0X2RldmljZQo+ID4gPiAqZGV2LCBzdHJ1Y3Qgc2tf
YnVmZiAqc2tiKQo+ID4gPiAgI2lmZGVmIENPTkZJR19ISUdITUVNCj4gPiA+ICAgICAgICAgaW50
IGk7Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKCEoZGV2LT5mZWF0dXJlcyAmIE5FVElGX0ZfSElH
SERNQSkpIHsKPiA+ID4gKyAgICAgICBpZiAoIShkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9I
SUdIRE1BKSkgewo+ID4gPiAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNrYl9zaGlu
Zm8oc2tiKS0+bnJfZnJhZ3M7IGkrKykgewo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBz
a2JfZnJhZ190ICpmcmFnID0gJnNrYl9zaGluZm8oc2tiKS0+ZnJhZ3NbaV07Cj4gPiA+Cj4gPiA+
IEBAIC0zNjEyLDM0ICszNjEzLDMzIEBAIHN0YXRpYyBuZXRkZXZfZmVhdHVyZXNfdAo+ID4gPiBn
c29fZmVhdHVyZXNfY2hlY2soY29uc3Qgc3RydWN0IHNrX2J1ZmYgKnNrYiwKPiA+ID4gICAgICAg
ICByZXR1cm4gZmVhdHVyZXM7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+IC1uZXRkZXZfZmVhdHVyZXNf
dCBuZXRpZl9za2JfZmVhdHVyZXMoc3RydWN0IHNrX2J1ZmYgKnNrYikKPiA+ID4gK3ZvaWQgbmV0
aWZfc2tiX2ZlYXR1cmVzKHN0cnVjdCBza19idWZmICpza2IsIG5ldGRldl9mZWF0dXJlc190ICpm
ZWF0dXJlcykKPiA+ID4gIHsKPiA+ID4gICAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2ID0g
c2tiLT5kZXY7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMgPSBkZXYt
PmZlYXR1cmVzOwo+ID4gPgo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc19jb3B5KGZlYXR1
cmVzLCBkZXYtPmZlYXR1cmVzKTsKPiA+ID4gICAgICAgICBpZiAoc2tiX2lzX2dzbyhza2IpKQo+
ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgPSBnc29fZmVhdHVyZXNfY2hlY2soc2tiLCBk
ZXYsIGZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdID0gZ3NvX2Zl
YXR1cmVzX2NoZWNrKHNrYiwgZGV2LCBmZWF0dXJlc1swXSk7Cj4gPiA+Cj4gPiA+ICAgICAgICAg
LyogSWYgZW5jYXBzdWxhdGlvbiBvZmZsb2FkIHJlcXVlc3QsIHZlcmlmeSB3ZSBhcmUgdGVzdGlu
Zwo+ID4gPiAgICAgICAgICAqIGhhcmR3YXJlIGVuY2Fwc3VsYXRpb24gZmVhdHVyZXMgaW5zdGVh
ZCBvZiBzdGFuZGFyZAo+ID4gPiAgICAgICAgICAqIGZlYXR1cmVzIGZvciB0aGUgbmV0ZGV2Cj4g
PiA+ICAgICAgICAgICovCj4gPiA+ICAgICAgICAgaWYgKHNrYi0+ZW5jYXBzdWxhdGlvbikKPiA+
ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IGRldi0+aHdfZW5jX2ZlYXR1cmVzOwo+ID4g
PiArICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX2FuZChmZWF0dXJlcywgZGV2LT5od19l
bmNfZmVhdHVyZXMpOwo+ID4gPgo+ID4gPiAgICAgICAgIGlmIChza2Jfdmxhbl90YWdnZWQoc2ti
KSkKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzID0gbmV0ZGV2X2ludGVyc2VjdF9mZWF0
dXJlcyhmZWF0dXJlcywKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkZXYtPnZsYW5fZmVhdHVyZXMgfAo+ID4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5FVElGX0ZfSFdfVkxBTl9D
VEFHX1RYIHwKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBORVRJRl9GX0hXX1ZMQU5fU1RBR19UWCk7Cj4gPiA+ICsgICAgICAgICAgICAg
ICBmZWF0dXJlc1swXSA9IG5ldGRldl9pbnRlcnNlY3RfZmVhdHVyZXMoZmVhdHVyZXNbMF0sCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZGV2LT52bGFuX2ZlYXR1cmVzWzBdIHwKPiA+ID4gKwo+ID4gPiBORVRJRl9GX0hXX1ZMQU5f
Q1RBR19UWCB8Cj4gPiA+ICsKPiA+ID4gTkVUSUZfRl9IV19WTEFOX1NUQUdfVFgpOwo+ID4gPgo+
ID4gPiAgICAgICAgIGlmIChkZXYtPm5ldGRldl9vcHMtPm5kb19mZWF0dXJlc19jaGVjaykKPiA+
ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IGRldi0+bmV0ZGV2X29wcy0+bmRvX2ZlYXR1
cmVzX2NoZWNrKHNrYiwgZGV2LAo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMpOwo+ID4gPiArICAgICAg
ICAgICAgICAgZGV2LT5uZXRkZXZfb3BzLT5uZG9fZmVhdHVyZXNfY2hlY2soc2tiLCBkZXYsIGZl
YXR1cmVzKTsKPiA+ID4gICAgICAgICBlbHNlCj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJl
cyAmPSBkZmx0X2ZlYXR1cmVzX2NoZWNrKHNrYiwgZGV2LCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAg
ICAgICAgICAgICBmZWF0dXJlc1swXSAmPSBkZmx0X2ZlYXR1cmVzX2NoZWNrKHNrYiwgZGV2LCBm
ZWF0dXJlc1swXSk7Cj4gPiA+Cj4gPiA+IC0gICAgICAgcmV0dXJuIGhhcm1vbml6ZV9mZWF0dXJl
cyhza2IsIGZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICBmZWF0dXJlc1swXSA9IGhhcm1vbml6ZV9m
ZWF0dXJlcyhza2IsIGZlYXR1cmVzWzBdKTsKPiA+ID4gIH0KPiA+ID4gIEVYUE9SVF9TWU1CT0wo
bmV0aWZfc2tiX2ZlYXR1cmVzKTsKPiA+ID4KPiA+ID4gQEAgLTM3MjIsMTAgKzM3MjIsMTAgQEAg
RVhQT1JUX1NZTUJPTChza2JfY3N1bV9od29mZmxvYWRfaGVscCk7Cj4gPiA+Cj4gPiA+ICBzdGF0
aWMgc3RydWN0IHNrX2J1ZmYgKnZhbGlkYXRlX3htaXRfc2tiKHN0cnVjdCBza19idWZmICpza2Is
IHN0cnVjdAo+ID4gPiBuZXRfZGV2aWNlICpkZXYsIGJvb2wgKmFnYWluKQo+ID4gPiAgewo+ID4g
PiAtICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzOwo+ID4gPiArICAgICAgIG5ldGRl
dl9mZWF0dXJlc190IGZlYXR1cmVzW05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+Cj4gPiA+
IC0gICAgICAgZmVhdHVyZXMgPSBuZXRpZl9za2JfZmVhdHVyZXMoc2tiKTsKPiA+ID4gLSAgICAg
ICBza2IgPSB2YWxpZGF0ZV94bWl0X3ZsYW4oc2tiLCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAg
bmV0aWZfc2tiX2ZlYXR1cmVzKHNrYiwgZmVhdHVyZXMpOwo+ID4gPiArICAgICAgIHNrYiA9IHZh
bGlkYXRlX3htaXRfdmxhbihza2IsIGZlYXR1cmVzWzBdKTsKPiA+ID4gICAgICAgICBpZiAodW5s
aWtlbHkoIXNrYikpCj4gPiA+ICAgICAgICAgICAgICAgICBnb3RvIG91dF9udWxsOwo+ID4gPgo+
ID4gPiBAQCAtMzczMywxMCArMzczMywxMCBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYKPiA+ID4g
KnZhbGlkYXRlX3htaXRfc2tiKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNl
Cj4gPiA+ICAgICAgICAgaWYgKHVubGlrZWx5KCFza2IpKQo+ID4gPiAgICAgICAgICAgICAgICAg
Z290byBvdXRfbnVsbDsKPiA+ID4KPiA+ID4gLSAgICAgICBpZiAobmV0aWZfbmVlZHNfZ3NvKHNr
YiwgZmVhdHVyZXMpKSB7Cj4gPiA+ICsgICAgICAgaWYgKG5ldGlmX25lZWRzX2dzbyhza2IsIGZl
YXR1cmVzWzBdKSkgewo+ID4gPiAgICAgICAgICAgICAgICAgc3RydWN0IHNrX2J1ZmYgKnNlZ3M7
Cj4gPiA+Cj4gPiA+IC0gICAgICAgICAgICAgICBzZWdzID0gc2tiX2dzb19zZWdtZW50KHNrYiwg
ZmVhdHVyZXMpOwo+ID4gPiArICAgICAgICAgICAgICAgc2VncyA9IHNrYl9nc29fc2VnbWVudChz
a2IsIGZlYXR1cmVzWzBdKTsKPiA+ID4gICAgICAgICAgICAgICAgIGlmIChJU19FUlIoc2Vncykp
IHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfa2ZyZWVfc2tiOwo+ID4g
PiAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWdzKSB7Cj4gPiA+IEBAIC0zNzQ0LDcgKzM3
NDQsNyBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKnZhbGlkYXRlX3htaXRfc2tiKHN0cnVjdAo+
ID4gPiBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlCj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgIHNrYiA9IHNlZ3M7Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAg
ICAgfSBlbHNlIHsKPiA+ID4gLSAgICAgICAgICAgICAgIGlmIChza2JfbmVlZHNfbGluZWFyaXpl
KHNrYiwgZmVhdHVyZXMpICYmCj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoc2tiX25lZWRzX2xp
bmVhcml6ZShza2IsIGZlYXR1cmVzWzBdKSAmJgo+ID4gPiAgICAgICAgICAgICAgICAgICAgIF9f
c2tiX2xpbmVhcml6ZShza2IpKQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91
dF9rZnJlZV9za2I7Cj4gPiA+Cj4gPiA+IEBAIC0zNzU5LDEyICszNzU5LDEyIEBAIHN0YXRpYyBz
dHJ1Y3Qgc2tfYnVmZgo+ID4gPiAqdmFsaWRhdGVfeG1pdF9za2Ioc3RydWN0IHNrX2J1ZmYgKnNr
Yiwgc3RydWN0IG5ldF9kZXZpY2UKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQo+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNrYl9zZXRfdHJhbnNwb3J0X2hl
YWRlcihza2IsCj4gPiA+Cj4gPiA+IHNrYl9jaGVja3N1bV9zdGFydF9vZmZzZXQoc2tiKSk7Cj4g
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGlmIChza2JfY3N1bV9od29mZmxvYWRfaGVscChz
a2IsIGZlYXR1cmVzKSkKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNrYl9jc3Vt
X2h3b2ZmbG9hZF9oZWxwKHNrYiwgZmVhdHVyZXNbMF0pKQo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGdvdG8gb3V0X2tmcmVlX3NrYjsKPiA+ID4gICAgICAgICAgICAgICAg
IH0KPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgc2tiID0gdmFsaWRhdGVfeG1p
dF94ZnJtKHNrYiwgZmVhdHVyZXMsIGFnYWluKTsKPiA+ID4gKyAgICAgICBza2IgPSB2YWxpZGF0
ZV94bWl0X3hmcm0oc2tiLCBmZWF0dXJlc1swXSwgYWdhaW4pOwo+ID4gPgo+ID4gPiAgICAgICAg
IHJldHVybiBza2I7Cj4gPiA+Cj4gPiA+IEBAIC00NDI5LDcgKzQ0MjksNyBAQCBzZXRfcnBzX2Nw
dShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAo+ID4gPgo+ID4g
PiAgICAgICAgICAgICAgICAgLyogU2hvdWxkIHdlIHN0ZWVyIHRoaXMgZmxvdyB0byBhIGRpZmZl
cmVudCBoYXJkd2FyZSBxdWV1ZT8gKi8KPiA+ID4gICAgICAgICAgICAgICAgIGlmICghc2tiX3J4
X3F1ZXVlX3JlY29yZGVkKHNrYikgfHwgIWRldi0+cnhfY3B1X3JtYXAgfHwKPiA+ID4gLSAgICAg
ICAgICAgICAgICAgICAhKGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX05UVVBMRSkpCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgIShkZXYtPmZlYXR1cmVzWzBdICYgTkVUSUZfRl9OVFVQTEUpKQo+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKPiA+ID4gICAgICAgICAgICAg
ICAgIHJ4cV9pbmRleCA9IGNwdV9ybWFwX2xvb2t1cF9pbmRleChkZXYtPnJ4X2NwdV9ybWFwLCBu
ZXh0X2NwdSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBpZiAocnhxX2luZGV4ID09IHNrYl9nZXRf
cnhfcXVldWUoc2tiKSkKPiA+ID4gQEAgLTk3OTksMTcxICs5Nzk5LDE3OSBAQCBzdGF0aWMgdm9p
ZCBuZXRfc2V0X3RvZG8oc3RydWN0IG5ldF9kZXZpY2UgKmRldikKPiA+ID4gICAgICAgICBkZXZf
bmV0KGRldiktPmRldl91bnJlZ19jb3VudCsrOwo+ID4gPiAgfQo+ID4gPgo+ID4gPiAtc3RhdGlj
IG5ldGRldl9mZWF0dXJlc190IG5ldGRldl9zeW5jX3VwcGVyX2ZlYXR1cmVzKHN0cnVjdCBuZXRf
ZGV2aWNlICpsb3dlciwKPiA+ID4gLSAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqdXBwZXIsIG5l
dGRldl9mZWF0dXJlc190IGZlYXR1cmVzKQo+ID4gPiArc3RhdGljIHZvaWQgbmV0ZGV2X3N5bmNf
dXBwZXJfZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKmxvd2VyLAo+ID4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqdXBwZXIsCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJl
c190ICpmZWF0dXJlcykKPiA+ID4gIHsKPiA+ID4gICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCB1
cHBlcl9kaXNhYmxlcyA9IE5FVElGX0ZfVVBQRVJfRElTQUJMRVM7Cj4gPiA+ICAgICAgICAgbmV0
ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZTsKPiA+ID4gICAgICAgICBpbnQgZmVhdHVyZV9iaXQ7Cj4g
PiA+ICsgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+Cj4gPiA+IC0gICAgICAgZm9yX2VhY2hf
bmV0ZGV2X2ZlYXR1cmUodXBwZXJfZGlzYWJsZXMsIGZlYXR1cmVfYml0KSB7Cj4gPiA+IC0gICAg
ICAgICAgICAgICBmZWF0dXJlID0gX19ORVRJRl9GX0JJVChmZWF0dXJlX2JpdCk7Cj4gPiA+IC0g
ICAgICAgICAgICAgICBpZiAoISh1cHBlci0+d2FudGVkX2ZlYXR1cmVzICYgZmVhdHVyZSkKPiA+
ID4gLSAgICAgICAgICAgICAgICAgICAmJiAoZmVhdHVyZXMgJiBmZWF0dXJlKSkgewo+ID4gPiAt
ICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZGJnKGxvd2VyLCAiRHJvcHBpbmcgZmVhdHVy
ZSAlcE5GLAo+ID4gPiB1cHBlciBkZXYgJXMgaGFzIGl0IG9mZi5cbiIsCj4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJmZlYXR1cmUsIHVwcGVyLT5uYW1lKTsKPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gfmZlYXR1cmU7Cj4gPiA+ICsgICAg
ICAgZm9yIChpID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKSB7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBmb3JfZWFjaF9uZXRkZXZfZmVhdHVyZSh1cHBlcl9kaXNhYmxlcywgZmVh
dHVyZV9iaXQpIHsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZSA9IF9fTkVU
SUZfRl9CSVQoZmVhdHVyZV9iaXQpOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAo
ISh1cHBlci0+d2FudGVkX2ZlYXR1cmVzW2ldICYgZmVhdHVyZSkgJiYKPiA+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIChmZWF0dXJlc1tpXSAmIGZlYXR1cmUpKSB7Cj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2RiZyhsb3dlciwgIkRyb3BwaW5nCj4g
PiA+IGZlYXR1cmVbJXVdICVwTkYsIHVwcGVyIGRldiAlcyBoYXMgaXQgb2ZmLlxuIiwKPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGksICZmZWF0dXJlLCB1
cHBlci0+bmFtZSk7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVy
ZXNbaV0gJj0gfmZlYXR1cmU7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIH0KPiA+ID4g
ICAgICAgICAgICAgICAgIH0KPiA+ID4gICAgICAgICB9Cj4gPiA+IC0KPiA+ID4gLSAgICAgICBy
ZXR1cm4gZmVhdHVyZXM7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgdm9pZCBuZXRkZXZf
c3luY19sb3dlcl9mZWF0dXJlcyhzdHJ1Y3QgbmV0X2RldmljZSAqdXBwZXIsCj4gPiA+IC0gICAg
ICAgc3RydWN0IG5ldF9kZXZpY2UgKmxvd2VyLCBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlcykK
PiA+ID4gKyAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqbG93ZXIsIG5ldGRldl9mZWF0dXJlc190
ICpmZWF0dXJlcykKPiA+ID4gIHsKPiA+ID4gICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCB1cHBl
cl9kaXNhYmxlcyA9IE5FVElGX0ZfVVBQRVJfRElTQUJMRVM7Cj4gPiA+ICAgICAgICAgbmV0ZGV2
X2ZlYXR1cmVzX3QgZmVhdHVyZTsKPiA+ID4gICAgICAgICBpbnQgZmVhdHVyZV9iaXQ7Cj4gPiA+
ICsgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+Cj4gPiA+IC0gICAgICAgZm9yX2VhY2hfbmV0
ZGV2X2ZlYXR1cmUodXBwZXJfZGlzYWJsZXMsIGZlYXR1cmVfYml0KSB7Cj4gPiA+IC0gICAgICAg
ICAgICAgICBmZWF0dXJlID0gX19ORVRJRl9GX0JJVChmZWF0dXJlX2JpdCk7Cj4gPiA+IC0gICAg
ICAgICAgICAgICBpZiAoIShmZWF0dXJlcyAmIGZlYXR1cmUpICYmIChsb3dlci0+ZmVhdHVyZXMg
JiBmZWF0dXJlKSkgewo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZGJnKHVw
cGVyLCAiRGlzYWJsaW5nIGZlYXR1cmUgJXBORiBvbgo+ID4gPiBsb3dlciBkZXYgJXMuXG4iLAo+
ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZmZWF0dXJlLCBsb3dlci0+
bmFtZSk7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGxvd2VyLT53YW50ZWRfZmVhdHVy
ZXMgJj0gfmZlYXR1cmU7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIF9fbmV0ZGV2X3Vw
ZGF0ZV9mZWF0dXJlcyhsb3dlcik7Cj4gPiA+IC0KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKHVubGlrZWx5KGxvd2VyLT5mZWF0dXJlcyAmIGZlYXR1cmUpKQo+ID4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9XQVJOKHVwcGVyLCAiZmFpbGVkIHRvIGRp
c2FibGUKPiA+ID4gJXBORiBvbiAlcyFcbiIsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJmZlYXR1cmUsIGxvd2VyLT5uYW1lKTsKPiA+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgZWxzZQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIG5ldGRldl9mZWF0dXJlc19jaGFuZ2UobG93ZXIpOwo+ID4gPiArICAgICAgIGZvciAoaSA9
IDA7IGkgPCBORVRERVZfRkVBVFVSRV9EV09SRFM7IGkrKykgewo+ID4gPiArICAgICAgICAgICAg
ICAgZm9yX2VhY2hfbmV0ZGV2X2ZlYXR1cmUodXBwZXJfZGlzYWJsZXMsIGZlYXR1cmVfYml0KSB7
Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUgPSBfX05FVElGX0ZfQklUKGZl
YXR1cmVfYml0KTsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZmVhdHVyZXNb
aV0gJiBmZWF0dXJlKSAmJgo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgKGxvd2Vy
LT5mZWF0dXJlc1tpXSAmIGZlYXR1cmUpKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbmV0ZGV2X2RiZyh1cHBlciwgIkRpc2FibGluZwo+ID4gPiBmZWF0dXJlWyV1XSAl
cE5GIG9uIGxvd2VyIGRldiAlcy5cbiIsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpLCAmZmVhdHVyZSwgbG93ZXItPm5hbWUpOwo+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyLT53YW50ZWRfZmVhdHVyZXNbaV0gJj0gfmZl
YXR1cmVbaV07Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19uZXRkZXZf
dXBkYXRlX2ZlYXR1cmVzKGxvd2VyKTsKPiA+ID4gKwo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlmICh1bmxpa2VseShsb3dlci0+ZmVhdHVyZXNbaV0gJiBmZWF0dXJlKSkK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9XQVJO
KHVwcGVyLCAiZmFpbGVkIHRvCj4gPiA+IGRpc2FibGUgZmVhdHVyZVsldV0gJXBORiBvbiAlcyFc
biIsCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpLCAmZmVhdHVyZSwgbG93ZXItPm5hbWUpOwo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGVsc2UKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG5ldGRldl9mZWF0dXJlc19jaGFuZ2UobG93ZXIpOwo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4g
PiAgfQo+ID4gPgo+ID4gPiAtc3RhdGljIG5ldGRldl9mZWF0dXJlc190IG5ldGRldl9maXhfZmVh
dHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVy
ZXNfdCBmZWF0dXJlcykKPiA+ID4gK3N0YXRpYyB2b2lkIG5ldGRldl9maXhfZmVhdHVyZXMoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBuZXRkZXZfZmVhdHVyZXNfdCAqZmVhdHVyZXMpCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgLyog
Rml4IGlsbGVnYWwgY2hlY2tzdW0gY29tYmluYXRpb25zICovCj4gPiA+IC0gICAgICAgaWYgKChm
ZWF0dXJlcyAmIE5FVElGX0ZfSFdfQ1NVTSkgJiYKPiA+ID4gLSAgICAgICAgICAgKGZlYXR1cmVz
ICYgKE5FVElGX0ZfSVBfQ1NVTXxORVRJRl9GX0lQVjZfQ1NVTSkpKSB7Cj4gPiA+ICsgICAgICAg
aWYgKChmZWF0dXJlc1swXSAmIE5FVElGX0ZfSFdfQ1NVTSkgJiYKPiA+ID4gKyAgICAgICAgICAg
KGZlYXR1cmVzWzBdICYgKE5FVElGX0ZfSVBfQ1NVTSB8IE5FVElGX0ZfSVBWNl9DU1VNKSkpIHsK
PiA+ID4gICAgICAgICAgICAgICAgIG5ldGRldl93YXJuKGRldiwgIm1peGVkIEhXIGFuZCBJUCBj
aGVja3N1bSBzZXR0aW5ncy5cbiIpOwo+ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0g
fihORVRJRl9GX0lQX0NTVU18TkVUSUZfRl9JUFY2X0NTVU0pOwo+ID4gPiArICAgICAgICAgICAg
ICAgZmVhdHVyZXNbMF0gJj0gfihORVRJRl9GX0lQX0NTVU0gfCBORVRJRl9GX0lQVjZfQ1NVTSk7
Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAgICAgICAgIC8qIFRTTyByZXF1aXJlcyB0aGF0
IFNHIGlzIHByZXNlbnQgYXMgd2VsbC4gKi8KPiA+ID4gLSAgICAgICBpZiAoKGZlYXR1cmVzICYg
TkVUSUZfRl9BTExfVFNPKSAmJiAhKGZlYXR1cmVzICYgTkVUSUZfRl9TRykpIHsKPiA+ID4gKyAg
ICAgICBpZiAoKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9BTExfVFNPKSAmJiAhKGZlYXR1cmVzWzBd
ICYgTkVUSUZfRl9TRykpIHsKPiA+ID4gICAgICAgICAgICAgICAgIG5ldGRldl9kYmcoZGV2LCAi
RHJvcHBpbmcgVFNPIGZlYXR1cmVzIHNpbmNlIG5vIFNHIGZlYXR1cmUuXG4iKTsKPiA+ID4gLSAg
ICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9GX0FMTF9UU087Cj4gPiA+ICsgICAgICAg
ICAgICAgICBmZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9BTExfVFNPOwo+ID4gPiAgICAgICAgIH0K
PiA+ID4KPiA+ID4gLSAgICAgICBpZiAoKGZlYXR1cmVzICYgTkVUSUZfRl9UU08pICYmICEoZmVh
dHVyZXMgJiBORVRJRl9GX0hXX0NTVU0pICYmCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAhKGZlYXR1cmVzICYgTkVUSUZfRl9JUF9DU1VNKSkgewo+ID4gPiAr
ICAgICAgIGlmICgoZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RTTykgJiYgIShmZWF0dXJlc1swXSAm
IE5FVElGX0ZfSFdfQ1NVTSkgJiYKPiA+ID4gKyAgICAgICAgICAgIShmZWF0dXJlc1swXSAmIE5F
VElGX0ZfSVBfQ1NVTSkpIHsKPiA+ID4gICAgICAgICAgICAgICAgIG5ldGRldl9kYmcoZGV2LCAi
RHJvcHBpbmcgVFNPIGZlYXR1cmVzIHNpbmNlIG5vIENTVU0KPiA+ID4gZmVhdHVyZS5cbiIpOwo+
ID4gPiAtICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gfk5FVElGX0ZfVFNPOwo+ID4gPiAtICAg
ICAgICAgICAgICAgZmVhdHVyZXMgJj0gfk5FVElGX0ZfVFNPX0VDTjsKPiA+ID4gKyAgICAgICAg
ICAgICAgIGZlYXR1cmVzWzBdICY9IH5ORVRJRl9GX1RTTzsKPiA+ID4gKyAgICAgICAgICAgICAg
IGZlYXR1cmVzWzBdICY9IH5ORVRJRl9GX1RTT19FQ047Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+
ID4gPiAtICAgICAgIGlmICgoZmVhdHVyZXMgJiBORVRJRl9GX1RTTzYpICYmICEoZmVhdHVyZXMg
JiBORVRJRl9GX0hXX0NTVU0pICYmCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIShmZWF0dXJlcyAmIE5FVElGX0ZfSVBWNl9DU1VNKSkgewo+ID4gPiArICAg
ICAgIGlmICgoZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RTTzYpICYmICEoZmVhdHVyZXNbMF0gJiBO
RVRJRl9GX0hXX0NTVU0pICYmCj4gPiA+ICsgICAgICAgICAgICEoZmVhdHVyZXNbMF0gJiBORVRJ
Rl9GX0lQVjZfQ1NVTSkpIHsKPiA+ID4gICAgICAgICAgICAgICAgIG5ldGRldl9kYmcoZGV2LCAi
RHJvcHBpbmcgVFNPNiBmZWF0dXJlcyBzaW5jZSBubyBDU1VNCj4gPiA+IGZlYXR1cmUuXG4iKTsK
PiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9GX1RTTzY7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBmZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9UU082Owo+ID4gPiAgICAgICAg
IH0KPiA+ID4KPiA+ID4gICAgICAgICAvKiBUU08gd2l0aCBJUHY0IElEIG1hbmdsaW5nIHJlcXVp
cmVzIElQdjQgVFNPIGJlIGVuYWJsZWQgKi8KPiA+ID4gLSAgICAgICBpZiAoKGZlYXR1cmVzICYg
TkVUSUZfRl9UU09fTUFOR0xFSUQpICYmICEoZmVhdHVyZXMgJiBORVRJRl9GX1RTTykpCj4gPiA+
IC0gICAgICAgICAgICAgICBmZWF0dXJlcyAmPSB+TkVUSUZfRl9UU09fTUFOR0xFSUQ7Cj4gPiA+
ICsgICAgICAgaWYgKChmZWF0dXJlc1swXSAmIE5FVElGX0ZfVFNPX01BTkdMRUlEKSAmJgo+ID4g
PiArICAgICAgICAgICAhKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9UU08pKQo+ID4gPiArICAgICAg
ICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfk5FVElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPgo+ID4g
PiAgICAgICAgIC8qIFRTTyBFQ04gcmVxdWlyZXMgdGhhdCBUU08gaXMgcHJlc2VudCBhcyB3ZWxs
LiAqLwo+ID4gPiAtICAgICAgIGlmICgoZmVhdHVyZXMgJiBORVRJRl9GX0FMTF9UU08pID09IE5F
VElGX0ZfVFNPX0VDTikKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9G
X1RTT19FQ047Cj4gPiA+ICsgICAgICAgaWYgKChmZWF0dXJlc1swXSAmIE5FVElGX0ZfQUxMX1RT
TykgPT0gTkVUSUZfRl9UU09fRUNOKQo+ID4gPiArICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0g
Jj0gfk5FVElGX0ZfVFNPX0VDTjsKPiA+ID4KPiA+ID4gICAgICAgICAvKiBTb2Z0d2FyZSBHU08g
ZGVwZW5kcyBvbiBTRy4gKi8KPiA+ID4gLSAgICAgICBpZiAoKGZlYXR1cmVzICYgTkVUSUZfRl9H
U08pICYmICEoZmVhdHVyZXMgJiBORVRJRl9GX1NHKSkgewo+ID4gPiArICAgICAgIGlmICgoZmVh
dHVyZXNbMF0gJiBORVRJRl9GX0dTTykgJiYgIShmZWF0dXJlc1swXSAmIE5FVElGX0ZfU0cpKSB7
Cj4gPiA+ICAgICAgICAgICAgICAgICBuZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIE5FVElGX0Zf
R1NPIHNpbmNlIG5vIFNHIGZlYXR1cmUuXG4iKTsKPiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1
cmVzICY9IH5ORVRJRl9GX0dTTzsKPiA+ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9
IH5ORVRJRl9GX0dTTzsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgLyogR1NP
IHBhcnRpYWwgZmVhdHVyZXMgcmVxdWlyZSBHU08gcGFydGlhbCBiZSBzZXQgKi8KPiA+ID4gLSAg
ICAgICBpZiAoKGZlYXR1cmVzICYgZGV2LT5nc29fcGFydGlhbF9mZWF0dXJlcykgJiYKPiA+ID4g
LSAgICAgICAgICAgIShmZWF0dXJlcyAmIE5FVElGX0ZfR1NPX1BBUlRJQUwpKSB7Cj4gPiA+ICsg
ICAgICAgaWYgKChmZWF0dXJlc1swXSAmIGRldi0+Z3NvX3BhcnRpYWxfZmVhdHVyZXMpICYmCj4g
PiA+ICsgICAgICAgICAgICEoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0dTT19QQVJUSUFMKSkgewo+
ID4gPiAgICAgICAgICAgICAgICAgbmV0ZGV2X2RiZyhkZXYsCj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICJEcm9wcGluZyBwYXJ0aWFsbHkgc3VwcG9ydGVkIEdTTyBmZWF0dXJlcwo+
ID4gPiBzaW5jZSBubyBHU08gcGFydGlhbC5cbiIpOwo+ID4gPiAtICAgICAgICAgICAgICAgZmVh
dHVyZXMgJj0gfmRldi0+Z3NvX3BhcnRpYWxfZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgICAgICAg
ICBmZWF0dXJlc1swXSAmPSB+ZGV2LT5nc29fcGFydGlhbF9mZWF0dXJlczsKPiA+ID4gICAgICAg
ICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYgKCEoZmVhdHVyZXMgJiBORVRJRl9GX1JYQ1NVTSkp
IHsKPiA+ID4gKyAgICAgICBpZiAoIShmZWF0dXJlc1swXSAmIE5FVElGX0ZfUlhDU1VNKSkgewo+
ID4gPiAgICAgICAgICAgICAgICAgLyogTkVUSUZfRl9HUk9fSFcgaW1wbGllcyBkb2luZyBSWENT
VU0gc2luY2UgZXZlcnkgcGFja2V0Cj4gPiA+ICAgICAgICAgICAgICAgICAgKiBzdWNjZXNzZnVs
bHkgbWVyZ2VkIGJ5IGhhcmR3YXJlIG11c3QgYWxzbyBoYXZlIHRoZQo+ID4gPiAgICAgICAgICAg
ICAgICAgICogY2hlY2tzdW0gdmVyaWZpZWQgYnkgaGFyZHdhcmUuICBJZiB0aGUgdXNlciBkb2Vz
IG5vdAo+ID4gPiAgICAgICAgICAgICAgICAgICogd2FudCB0byBlbmFibGUgUlhDU1VNLCBsb2dp
Y2FsbHksIHdlIHNob3VsZCBkaXNhYmxlIEdST19IVy4KPiA+ID4gICAgICAgICAgICAgICAgICAq
Lwo+ID4gPiAtICAgICAgICAgICAgICAgaWYgKGZlYXR1cmVzICYgTkVUSUZfRl9HUk9fSFcpIHsK
PiA+ID4gKyAgICAgICAgICAgICAgIGlmIChmZWF0dXJlc1swXSAmIE5FVElGX0ZfR1JPX0hXKSB7
Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9kYmcoZGV2LCAiRHJvcHBpbmcg
TkVUSUZfRl9HUk9fSFcgc2luY2UKPiA+ID4gbm8gUlhDU1VNIGZlYXR1cmUuXG4iKTsKPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXMgJj0gfk5FVElGX0ZfR1JPX0hXOwo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9HUk9fSFc7
Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAgICAg
ICAgIC8qIExSTy9IVy1HUk8gZmVhdHVyZXMgY2Fubm90IGJlIGNvbWJpbmVkIHdpdGggUlgtRkNT
ICovCj4gPiA+IC0gICAgICAgaWYgKGZlYXR1cmVzICYgTkVUSUZfRl9SWEZDUykgewo+ID4gPiAt
ICAgICAgICAgICAgICAgaWYgKGZlYXR1cmVzICYgTkVUSUZfRl9MUk8pIHsKPiA+ID4gKyAgICAg
ICBpZiAoZmVhdHVyZXNbMF0gJiBORVRJRl9GX1JYRkNTKSB7Cj4gPiA+ICsgICAgICAgICAgICAg
ICBpZiAoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0xSTykgewo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICBuZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIExSTyBmZWF0dXJlIHNpbmNlCj4gPiA+
IFJYLUZDUyBpcyByZXF1ZXN0ZWQuXG4iKTsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ZmVhdHVyZXMgJj0gfk5FVElGX0ZfTFJPOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBm
ZWF0dXJlc1swXSAmPSB+TkVUSUZfRl9MUk87Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+
Cj4gPiA+IC0gICAgICAgICAgICAgICBpZiAoZmVhdHVyZXMgJiBORVRJRl9GX0dST19IVykgewo+
ID4gPiArICAgICAgICAgICAgICAgaWYgKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9HUk9fSFcpIHsK
PiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2RiZyhkZXYsICJEcm9wcGluZyBI
Vy1HUk8gZmVhdHVyZSBzaW5jZQo+ID4gPiBSWC1GQ1MgaXMgcmVxdWVzdGVkLlxuIik7Cj4gPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9GX0dST19IVzsKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXNbMF0gJj0gfk5FVElGX0ZfR1JPX0hX
Owo+ID4gPiAgICAgICAgICAgICAgICAgfQo+ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAg
ICAgICBpZiAoZmVhdHVyZXMgJiBORVRJRl9GX0hXX1RMU19UWCkgewo+ID4gPiAtICAgICAgICAg
ICAgICAgYm9vbCBpcF9jc3VtID0gKGZlYXR1cmVzICYgKE5FVElGX0ZfSVBfQ1NVTSB8Cj4gPiA+
IE5FVElGX0ZfSVBWNl9DU1VNKSkgPT0KPiA+ID4gKyAgICAgICBpZiAoZmVhdHVyZXNbMF0gJiBO
RVRJRl9GX0hXX1RMU19UWCkgewo+ID4gPiArICAgICAgICAgICAgICAgYm9vbCBpcF9jc3VtID0g
KGZlYXR1cmVzWzBdICYgKE5FVElGX0ZfSVBfQ1NVTSB8Cj4gPiA+IE5FVElGX0ZfSVBWNl9DU1VN
KSkgPT0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgKE5FVElGX0ZfSVBfQ1NVTSB8IE5F
VElGX0ZfSVBWNl9DU1VNKTsKPiA+ID4gLSAgICAgICAgICAgICAgIGJvb2wgaHdfY3N1bSA9IGZl
YXR1cmVzICYgTkVUSUZfRl9IV19DU1VNOwo+ID4gPiArICAgICAgICAgICAgICAgYm9vbCBod19j
c3VtID0gZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX0NTVU07Cj4gPiA+Cj4gPiA+ICAgICAgICAg
ICAgICAgICBpZiAoIWlwX2NzdW0gJiYgIWh3X2NzdW0pIHsKPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgbmV0ZGV2X2RiZyhkZXYsICJEcm9wcGluZyBUTFMgVFggSFcgb2ZmbG9hZAo+ID4g
PiBmZWF0dXJlIHNpbmNlIG5vIENTVU0gZmVhdHVyZS5cbiIpOwo+ID4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICBmZWF0dXJlcyAmPSB+TkVUSUZfRl9IV19UTFNfVFg7Cj4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH5ORVRJRl9GX0hXX1RMU19UWDsKPiA+ID4g
ICAgICAgICAgICAgICAgIH0KPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgaWYg
KChmZWF0dXJlcyAmIE5FVElGX0ZfSFdfVExTX1JYKSAmJiAhKGZlYXR1cmVzICYgTkVUSUZfRl9S
WENTVU0pKSB7Cj4gPiA+ICsgICAgICAgaWYgKChmZWF0dXJlc1swXSAmIE5FVElGX0ZfSFdfVExT
X1JYKSAmJgo+ID4gPiArICAgICAgICAgICAhKGZlYXR1cmVzWzBdICYgTkVUSUZfRl9SWENTVU0p
KSB7Cj4gPiA+ICAgICAgICAgICAgICAgICBuZXRkZXZfZGJnKGRldiwgIkRyb3BwaW5nIFRMUyBS
WCBIVyBvZmZsb2FkIGZlYXR1cmUKPiA+ID4gc2luY2Ugbm8gUlhDU1VNIGZlYXR1cmUuXG4iKTsK
PiA+ID4gLSAgICAgICAgICAgICAgIGZlYXR1cmVzICY9IH5ORVRJRl9GX0hXX1RMU19SWDsKPiA+
ID4gKyAgICAgICAgICAgICAgIGZlYXR1cmVzWzBdICY9IH5ORVRJRl9GX0hXX1RMU19SWDsKPiA+
ID4gICAgICAgICB9Cj4gPiA+IC0KPiA+ID4gLSAgICAgICByZXR1cm4gZmVhdHVyZXM7Cj4gPiA+
ICB9Cj4gPiA+Cj4gPiA+ICBpbnQgX19uZXRkZXZfdXBkYXRlX2ZlYXR1cmVzKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYpCj4gPiA+ICB7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVh
dHVyZXNbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsKPiA+ID4gICAgICAgICBzdHJ1Y3QgbmV0X2Rl
dmljZSAqdXBwZXIsICpsb3dlcjsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0
dXJlczsKPiA+ID4gICAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkICppdGVyOwo+ID4gPiArICAgICAg
IHVuc2lnbmVkIGludCBpOwo+ID4gPiAgICAgICAgIGludCBlcnIgPSAtMTsKPiA+ID4KPiA+ID4g
ICAgICAgICBBU1NFUlRfUlROTCgpOwo+ID4gPgo+ID4gPiAtICAgICAgIGZlYXR1cmVzID0gbmV0
ZGV2X2dldF93YW50ZWRfZmVhdHVyZXMoZGV2KTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZ2V0X3dh
bnRlZF9mZWF0dXJlcyhkZXYsIGZlYXR1cmVzKTsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAoZGV2
LT5uZXRkZXZfb3BzLT5uZG9fZml4X2ZlYXR1cmVzKQo+ID4gPiAtICAgICAgICAgICAgICAgZmVh
dHVyZXMgPSBkZXYtPm5ldGRldl9vcHMtPm5kb19maXhfZmVhdHVyZXMoZGV2LCBmZWF0dXJlcyk7
Cj4gPiA+ICsgICAgICAgICAgICAgICBkZXYtPm5ldGRldl9vcHMtPm5kb19maXhfZmVhdHVyZXMo
ZGV2LCBmZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgLyogZHJpdmVyIG1pZ2h0IGJlIGxl
c3Mgc3RyaWN0IGFib3V0IGZlYXR1cmUgZGVwZW5kZW5jaWVzICovCj4gPiA+IC0gICAgICAgZmVh
dHVyZXMgPSBuZXRkZXZfZml4X2ZlYXR1cmVzKGRldiwgZmVhdHVyZXMpOwo+ID4gPiArICAgICAg
IG5ldGRldl9maXhfZmVhdHVyZXMoZGV2LCBmZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+ICAgICAgICAg
Lyogc29tZSBmZWF0dXJlcyBjYW4ndCBiZSBlbmFibGVkIGlmIHRoZXkncmUgb2ZmIG9uIGFuIHVw
cGVyIGRldmljZSAqLwo+ID4gPiAgICAgICAgIG5ldGRldl9mb3JfZWFjaF91cHBlcl9kZXZfcmN1
KGRldiwgdXBwZXIsIGl0ZXIpCj4gPiA+IC0gICAgICAgICAgICAgICBmZWF0dXJlcyA9IG5ldGRl
dl9zeW5jX3VwcGVyX2ZlYXR1cmVzKGRldiwgdXBwZXIsIGZlYXR1cmVzKTsKPiA+ID4gKyAgICAg
ICAgICAgICAgIG5ldGRldl9zeW5jX3VwcGVyX2ZlYXR1cmVzKGRldiwgdXBwZXIsIGZlYXR1cmVz
KTsKPiA+ID4KPiA+ID4gLSAgICAgICBpZiAoZGV2LT5mZWF0dXJlcyA9PSBmZWF0dXJlcykKPiA+
ID4gKyAgICAgICBpZiAobmV0ZGV2X2ZlYXR1cmVzX2VxdWFsKGRldi0+ZmVhdHVyZXMsIGZlYXR1
cmVzKSkKPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gc3luY19sb3dlcjsKPiA+ID4KPiA+ID4g
LSAgICAgICBuZXRkZXZfZGJnKGRldiwgIkZlYXR1cmVzIGNoYW5nZWQ6ICVwTkYgLT4gJXBORlxu
IiwKPiA+ID4gLSAgICAgICAgICAgICAgICZkZXYtPmZlYXR1cmVzLCAmZmVhdHVyZXMpOwo+ID4g
PiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBORVRERVZfRkVBVFVSRV9EV09SRFM7IGkrKykKPiA+
ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9kYmcoZGV2LCAiRmVhdHVyZXNbJXVdIGNoYW5nZWQ6
ICVwTkYgLT4gJXBORlxuIiwKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgaSwgJmRl
di0+ZmVhdHVyZXNbaV0sICZmZWF0dXJlc1tpXSk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKGRl
di0+bmV0ZGV2X29wcy0+bmRvX3NldF9mZWF0dXJlcykKPiA+ID4gICAgICAgICAgICAgICAgIGVy
ciA9IGRldi0+bmV0ZGV2X29wcy0+bmRvX3NldF9mZWF0dXJlcyhkZXYsIGZlYXR1cmVzKTsKPiA+
ID4gQEAgLTk5NzEsOSArOTk3OSwxMCBAQCBpbnQgX19uZXRkZXZfdXBkYXRlX2ZlYXR1cmVzKHN0
cnVjdCBuZXRfZGV2aWNlICpkZXYpCj4gPiA+ICAgICAgICAgICAgICAgICBlcnIgPSAwOwo+ID4g
Pgo+ID4gPiAgICAgICAgIGlmICh1bmxpa2VseShlcnIgPCAwKSkgewo+ID4gPiAtICAgICAgICAg
ICAgICAgbmV0ZGV2X2VycihkZXYsCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICJzZXRf
ZmVhdHVyZXMoKSBmYWlsZWQgKCVkKTsgd2FudGVkICVwTkYsIGxlZnQgJXBORlxuIiwKPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgZXJyLCAmZmVhdHVyZXMsICZkZXYtPmZlYXR1cmVzKTsK
PiA+ID4gKyAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBORVRERVZfRkVBVFVSRV9EV09S
RFM7IGkrKykKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2VycihkZXYsCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNldF9mZWF0dXJlcygpIGZh
aWxlZCAoJWQpOwo+ID4gPiB3YW50ZWRbJXVdICVwTkYsIGxlZnRbJXVdICVwTkZcbiIsCj4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLCBpLCAmZmVhdHVyZXNbaV0s
IGksICZkZXYtPmZlYXR1cmVzW2ldKTsKPiA+ID4gICAgICAgICAgICAgICAgIC8qIHJldHVybiBu
b24tMCBzaW5jZSBzb21lIGZlYXR1cmVzIG1pZ2h0IGhhdmUgY2hhbmdlZCBhbmQKPiA+ID4gICAg
ICAgICAgICAgICAgICAqIGl0J3MgYmV0dGVyIHRvIGZpcmUgYSBzcHVyaW91cyBub3RpZmljYXRp
b24gdGhhbiBtaXNzIGl0Cj4gPiA+ICAgICAgICAgICAgICAgICAgKi8KPiA+ID4gQEAgLTk5ODgs
OSArOTk5NywxMCBAQCBpbnQgX19uZXRkZXZfdXBkYXRlX2ZlYXR1cmVzKHN0cnVjdCBuZXRfZGV2
aWNlICpkZXYpCj4gPiA+ICAgICAgICAgICAgICAgICBuZXRkZXZfc3luY19sb3dlcl9mZWF0dXJl
cyhkZXYsIGxvd2VyLCBmZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKCFlcnIpIHsK
PiA+ID4gLSAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc190IGRpZmYgPSBmZWF0dXJlcyBe
IGRldi0+ZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgICAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBk
aWZmW05FVERFVl9GRUFUVVJFX0RXT1JEU107Cj4gPiA+Cj4gPiA+IC0gICAgICAgICAgICAgICBp
ZiAoZGlmZiAmIE5FVElGX0ZfUlhfVURQX1RVTk5FTF9QT1JUKSB7Cj4gPiA+ICsgICAgICAgICAg
ICAgICBuZXRkZXZfZmVhdHVyZXNfeG9yKGRpZmYsIGZlYXR1cmVzLCBkZXYtPmZlYXR1cmVzKTsK
PiA+ID4gKyAgICAgICAgICAgICAgIGlmIChkaWZmWzBdICYgTkVUSUZfRl9SWF9VRFBfVFVOTkVM
X1BPUlQpIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgLyogdWRwX3R1bm5lbF97Z2V0
LGRyb3B9X3J4X2luZm8gYm90aCBuZWVkCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAq
IE5FVElGX0ZfUlhfVURQX1RVTk5FTF9QT1JUIGVuYWJsZWQgb24gdGhlCj4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAqIGRldmljZSwgb3IgdGhleSB3b24ndCBkbyBhbnl0aGluZy4KPiA+
ID4gQEAgLTk5OTgsMzMgKzEwMDA4LDMzIEBAIGludCBfX25ldGRldl91cGRhdGVfZmVhdHVyZXMo
c3RydWN0IG5ldF9kZXZpY2UgKmRldikKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICog
KmJlZm9yZSogY2FsbGluZyB1ZHBfdHVubmVsX2dldF9yeF9pbmZvLAo+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgKiBidXQgKmFmdGVyKiBjYWxsaW5nIHVkcF90dW5uZWxfZHJvcF9yeF9p
bmZvLgo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KPiA+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKGZlYXR1cmVzICYgTkVUSUZfRl9SWF9VRFBfVFVOTkVMX1BPUlQpIHsK
PiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzID0gZmVh
dHVyZXM7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZWF0dXJlc1swXSAmIE5F
VElGX0ZfUlhfVURQX1RVTk5FTF9QT1JUKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZGV2LT5mZWF0dXJlc1swXSA9IGZlYXR1cmVzWzBdOwo+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVkcF90dW5uZWxfZ2V0X3J4X2luZm8oZGV2KTsKPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1ZHBfdHVubmVsX2Ryb3BfcnhfaW5mbyhkZXYpOwo+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICB9Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0g
ICAgICAgICAgICAgICBpZiAoZGlmZiAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRFUikgewo+
ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmVhdHVyZXMgJiBORVRJRl9GX0hXX1ZM
QU5fQ1RBR19GSUxURVIpIHsKPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBk
ZXYtPmZlYXR1cmVzID0gZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoZGlmZlsw
XSAmIE5FVElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRFUikgewo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICBpZiAoZmVhdHVyZXNbMF0gJiBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVIpIHsK
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzWzBdID0g
ZmVhdHVyZXNbMF07Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyIHw9
IHZsYW5fZ2V0X3J4X2N0YWdfZmlsdGVyX2luZm8oZGV2KTsKPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgfSBlbHNlIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
bGFuX2Ryb3BfcnhfY3RhZ19maWx0ZXJfaW5mbyhkZXYpOwo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICB9Cj4gPiA+ICAgICAgICAgICAgICAgICB9Cj4gPiA+Cj4gPiA+IC0gICAgICAgICAg
ICAgICBpZiAoZGlmZiAmIE5FVElGX0ZfSFdfVkxBTl9TVEFHX0ZJTFRFUikgewo+ID4gPiArICAg
ICAgICAgICAgICAgaWYgKGRpZmZbMF0gJiBORVRJRl9GX0hXX1ZMQU5fU1RBR19GSUxURVIpIHsK
PiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZlYXR1cmVzICYgTkVUSUZfRl9IV19W
TEFOX1NUQUdfRklMVEVSKSB7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZGV2LT5mZWF0dXJlcyA9IGZlYXR1cmVzOwo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRldi0+ZmVhdHVyZXNbMF0gPSBmZWF0dXJlc1swXTsKPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBlcnIgfD0gdmxhbl9nZXRfcnhfc3RhZ19maWx0ZXJfaW5mbyhk
ZXYpOwo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugewo+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHZsYW5fZHJvcF9yeF9zdGFnX2ZpbHRlcl9pbmZvKGRl
dik7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIH0KPiA+ID4gICAgICAgICAgICAgICAg
IH0KPiA+ID4KPiA+ID4gLSAgICAgICAgICAgICAgIGRldi0+ZmVhdHVyZXMgPSBmZWF0dXJlczsK
PiA+ID4gKyAgICAgICAgICAgICAgIG5ldGRldl9mZWF0dXJlc19jb3B5KGRldi0+ZmVhdHVyZXMs
IGZlYXR1cmVzKTsKPiA+ID4gICAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgcmV0dXJuIGVy
ciA8IDAgPyAwIDogMTsKPiA+ID4gQEAgLTEwMjEzLDcgKzEwMjIzLDcgQEAgaW50IHJlZ2lzdGVy
X25ldGRldmljZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQo+ID4gPiAgICAgICAgIGludCByZXQ7
Cj4gPiA+ICAgICAgICAgc3RydWN0IG5ldCAqbmV0ID0gZGV2X25ldChkZXYpOwo+ID4gPgo+ID4g
PiAtICAgICAgIEJVSUxEX0JVR19PTihzaXplb2YobmV0ZGV2X2ZlYXR1cmVzX3QpICogQklUU19Q
RVJfQllURSA8Cj4gPiA+ICsgICAgICAgQlVJTERfQlVHX09OKHNpemVvZihkZXYtPmZlYXR1cmVz
KSAqIEJJVFNfUEVSX0JZVEUgPAo+ID4gPiAgICAgICAgICAgICAgICAgICAgICBORVRERVZfRkVB
VFVSRV9DT1VOVCk7Cj4gPiA+ICAgICAgICAgQlVHX09OKGRldl9ib290X3BoYXNlKTsKPiA+ID4g
ICAgICAgICBBU1NFUlRfUlROTCgpOwo+ID4gPiBAQCAtMTAyNTAsNyArMTAyNjAsNyBAQCBpbnQg
cmVnaXN0ZXJfbmV0ZGV2aWNlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCj4gPiA+ICAgICAgICAg
ICAgICAgICB9Cj4gPiA+ICAgICAgICAgfQo+ID4gPgo+ID4gPiAtICAgICAgIGlmICgoKGRldi0+
aHdfZmVhdHVyZXMgfCBkZXYtPmZlYXR1cmVzKSAmCj4gPiA+ICsgICAgICAgaWYgKCgoZGV2LT5o
d19mZWF0dXJlc1swXSB8IGRldi0+ZmVhdHVyZXNbMF0pICYKPiA+ID4gICAgICAgICAgICAgIE5F
VElGX0ZfSFdfVkxBTl9DVEFHX0ZJTFRFUikgJiYKPiA+ID4gICAgICAgICAgICAgKCFkZXYtPm5l
dGRldl9vcHMtPm5kb192bGFuX3J4X2FkZF92aWQgfHwKPiA+ID4gICAgICAgICAgICAgICFkZXYt
Pm5ldGRldl9vcHMtPm5kb192bGFuX3J4X2tpbGxfdmlkKSkgewo+ID4gPiBAQCAtMTAyNjgsNDQg
KzEwMjc4LDQ2IEBAIGludCByZWdpc3Rlcl9uZXRkZXZpY2Uoc3RydWN0IG5ldF9kZXZpY2UgKmRl
dikKPiA+ID4gICAgICAgICAvKiBUcmFuc2ZlciBjaGFuZ2VhYmxlIGZlYXR1cmVzIHRvIHdhbnRl
ZF9mZWF0dXJlcyBhbmQgZW5hYmxlCj4gPiA+ICAgICAgICAgICogc29mdHdhcmUgb2ZmbG9hZHMg
KEdTTyBhbmQgR1JPKS4KPiA+ID4gICAgICAgICAgKi8KPiA+ID4gLSAgICAgICBkZXYtPmh3X2Zl
YXR1cmVzIHw9IChORVRJRl9GX1NPRlRfRkVBVFVSRVMgfCBORVRJRl9GX1NPRlRfRkVBVFVSRVNf
T0ZGKTsKPiA+ID4gLSAgICAgICBkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfU09GVF9GRUFUVVJF
UzsKPiA+ID4gKyAgICAgICBkZXYtPmh3X2ZlYXR1cmVzWzBdIHw9Cj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIChORVRJRl9GX1NPRlRfRkVBVFVSRVMgfCBORVRJRl9GX1NPRlRfRkVBVFVS
RVNfT0ZGKTsKPiA+ID4gKyAgICAgICBkZXYtPmZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfU09GVF9G
RUFUVVJFUzsKPiA+ID4KPiA+ID4gICAgICAgICBpZiAoZGV2LT51ZHBfdHVubmVsX25pY19pbmZv
KSB7Cj4gPiA+IC0gICAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfUlhfVURQ
X1RVTk5FTF9QT1JUOwo+ID4gPiAtICAgICAgICAgICAgICAgZGV2LT5od19mZWF0dXJlcyB8PSBO
RVRJRl9GX1JYX1VEUF9UVU5ORUxfUE9SVDsKPiA+ID4gKyAgICAgICAgICAgICAgIGRldi0+ZmVh
dHVyZXNbMF0gfD0gTkVUSUZfRl9SWF9VRFBfVFVOTkVMX1BPUlQ7Cj4gPiA+ICsgICAgICAgICAg
ICAgICBkZXYtPmh3X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfUlhfVURQX1RVTk5FTF9QT1JUOwo+
ID4gPiAgICAgICAgIH0KPiA+ID4KPiA+ID4gLSAgICAgICBkZXYtPndhbnRlZF9mZWF0dXJlcyA9
IGRldi0+ZmVhdHVyZXMgJiBkZXYtPmh3X2ZlYXR1cmVzOwo+ID4gPiArICAgICAgIG5ldGRldl9m
ZWF0dXJlc19hbmQoZGV2LT53YW50ZWRfZmVhdHVyZXMsIGRldi0+ZmVhdHVyZXMsCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPmh3X2ZlYXR1cmVzKTsKPiA+ID4KPiA+ID4g
ICAgICAgICBpZiAoIShkZXYtPmZsYWdzICYgSUZGX0xPT1BCQUNLKSkKPiA+ID4gLSAgICAgICAg
ICAgICAgIGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9OT0NBQ0hFX0NPUFk7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBkZXYtPmh3X2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfTk9DQUNIRV9DT1BZ
Owo+ID4gPgo+ID4gPiAgICAgICAgIC8qIElmIElQdjQgVENQIHNlZ21lbnRhdGlvbiBvZmZsb2Fk
IGlzIHN1cHBvcnRlZCB3ZSBzaG91bGQgYWxzbwo+ID4gPiAgICAgICAgICAqIGFsbG93IHRoZSBk
ZXZpY2UgdG8gZW5hYmxlIHNlZ21lbnRpbmcgdGhlIGZyYW1lIHdpdGggdGhlIG9wdGlvbgo+ID4g
PiAgICAgICAgICAqIG9mIGlnbm9yaW5nIGEgc3RhdGljIElQIElEIHZhbHVlLiAgVGhpcyBkb2Vz
bid0IGVuYWJsZSB0aGUKPiA+ID4gICAgICAgICAgKiBmZWF0dXJlIGl0c2VsZiBidXQgYWxsb3dz
IHRoZSB1c2VyIHRvIGVuYWJsZSBpdCBsYXRlci4KPiA+ID4gICAgICAgICAgKi8KPiA+ID4gLSAg
ICAgICBpZiAoZGV2LT5od19mZWF0dXJlcyAmIE5FVElGX0ZfVFNPKQo+ID4gPiAtICAgICAgICAg
ICAgICAgZGV2LT5od19mZWF0dXJlcyB8PSBORVRJRl9GX1RTT19NQU5HTEVJRDsKPiA+ID4gLSAg
ICAgICBpZiAoZGV2LT52bGFuX2ZlYXR1cmVzICYgTkVUSUZfRl9UU08pCj4gPiA+IC0gICAgICAg
ICAgICAgICBkZXYtPnZsYW5fZmVhdHVyZXMgfD0gTkVUSUZfRl9UU09fTUFOR0xFSUQ7Cj4gPiA+
IC0gICAgICAgaWYgKGRldi0+bXBsc19mZWF0dXJlcyAmIE5FVElGX0ZfVFNPKQo+ID4gPiAtICAg
ICAgICAgICAgICAgZGV2LT5tcGxzX2ZlYXR1cmVzIHw9IE5FVElGX0ZfVFNPX01BTkdMRUlEOwo+
ID4gPiAtICAgICAgIGlmIChkZXYtPmh3X2VuY19mZWF0dXJlcyAmIE5FVElGX0ZfVFNPKQo+ID4g
PiAtICAgICAgICAgICAgICAgZGV2LT5od19lbmNfZmVhdHVyZXMgfD0gTkVUSUZfRl9UU09fTUFO
R0xFSUQ7Cj4gPiA+ICsgICAgICAgaWYgKGRldi0+aHdfZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RT
TykKPiA+ID4gKyAgICAgICAgICAgICAgIGRldi0+aHdfZmVhdHVyZXNbMF0gfD0gTkVUSUZfRl9U
U09fTUFOR0xFSUQ7Cj4gPiA+ICsgICAgICAgaWYgKGRldi0+dmxhbl9mZWF0dXJlc1swXSAmIE5F
VElGX0ZfVFNPKQo+ID4gPiArICAgICAgICAgICAgICAgZGV2LT52bGFuX2ZlYXR1cmVzWzBdIHw9
IE5FVElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPiArICAgICAgIGlmIChkZXYtPm1wbHNfZmVhdHVy
ZXNbMF0gJiBORVRJRl9GX1RTTykKPiA+ID4gKyAgICAgICAgICAgICAgIGRldi0+bXBsc19mZWF0
dXJlc1swXSB8PSBORVRJRl9GX1RTT19NQU5HTEVJRDsKPiA+ID4gKyAgICAgICBpZiAoZGV2LT5o
d19lbmNfZmVhdHVyZXNbMF0gJiBORVRJRl9GX1RTTykKPiA+ID4gKyAgICAgICAgICAgICAgIGRl
di0+aHdfZW5jX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0ZfVFNPX01BTkdMRUlEOwo+ID4gPgo+ID4g
PiAgICAgICAgIC8qIE1ha2UgTkVUSUZfRl9ISUdIRE1BIGluaGVyaXRhYmxlIHRvIFZMQU4gZGV2
aWNlcy4KPiA+ID4gICAgICAgICAgKi8KPiA+ID4gLSAgICAgICBkZXYtPnZsYW5fZmVhdHVyZXMg
fD0gTkVUSUZfRl9ISUdIRE1BOwo+ID4gPiArICAgICAgIGRldi0+dmxhbl9mZWF0dXJlc1swXSB8
PSBORVRJRl9GX0hJR0hETUE7Cj4gPiA+Cj4gPiA+ICAgICAgICAgLyogTWFrZSBORVRJRl9GX1NH
IGluaGVyaXRhYmxlIHRvIHR1bm5lbCBkZXZpY2VzLgo+ID4gPiAgICAgICAgICAqLwo+ID4gPiAt
ICAgICAgIGRldi0+aHdfZW5jX2ZlYXR1cmVzIHw9IE5FVElGX0ZfU0cgfCBORVRJRl9GX0dTT19Q
QVJUSUFMOwo+ID4gPiArICAgICAgIGRldi0+aHdfZW5jX2ZlYXR1cmVzWzBdIHw9IE5FVElGX0Zf
U0cgfCBORVRJRl9GX0dTT19QQVJUSUFMOwo+ID4gPgo+ID4gPiAgICAgICAgIC8qIE1ha2UgTkVU
SUZfRl9TRyBpbmhlcml0YWJsZSB0byBNUExTLgo+ID4gPiAgICAgICAgICAqLwo+ID4gPiAtICAg
ICAgIGRldi0+bXBsc19mZWF0dXJlcyB8PSBORVRJRl9GX1NHOwo+ID4gPiArICAgICAgIGRldi0+
bXBsc19mZWF0dXJlc1swXSB8PSBORVRJRl9GX1NHOwo+ID4gPgo+ID4gPiAgICAgICAgIHJldCA9
IGNhbGxfbmV0ZGV2aWNlX25vdGlmaWVycyhORVRERVZfUE9TVF9JTklULCBkZXYpOwo+ID4gPiAg
ICAgICAgIHJldCA9IG5vdGlmaWVyX3RvX2Vycm5vKHJldCk7Cj4gPiA+IEBAIC0xMTE0Niw3ICsx
MTE1OCw3IEBAIGludCBfX2Rldl9jaGFuZ2VfbmV0X25hbWVzcGFjZShzdHJ1Y3QKPiA+ID4gbmV0
X2RldmljZSAqZGV2LCBzdHJ1Y3QgbmV0ICpuZXQsCj4gPiA+Cj4gPiA+ICAgICAgICAgLyogRG9u
J3QgYWxsb3cgbmFtZXNwYWNlIGxvY2FsIGRldmljZXMgdG8gYmUgbW92ZWQuICovCj4gPiA+ICAg
ICAgICAgZXJyID0gLUVJTlZBTDsKPiA+ID4gLSAgICAgICBpZiAoZGV2LT5mZWF0dXJlcyAmIE5F
VElGX0ZfTkVUTlNfTE9DQUwpCj4gPiA+ICsgICAgICAgaWYgKGRldi0+ZmVhdHVyZXNbMF0gJiBO
RVRJRl9GX05FVE5TX0xPQ0FMKQo+ID4gPiAgICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gPiA+
Cj4gPiA+ICAgICAgICAgLyogRW5zdXJlIHRoZSBkZXZpY2UgaGFzIGJlZW4gcmVnaXN0cmVyZWQg
Ki8KPiA+ID4gQEAgLTExNTA2LDcgKzExNTE4LDcgQEAgc3RhdGljIHZvaWQgX19uZXRfZXhpdAo+
ID4gPiBkZWZhdWx0X2RldmljZV9leGl0KHN0cnVjdCBuZXQgKm5ldCkKPiA+ID4gICAgICAgICAg
ICAgICAgIGNoYXIgZmJfbmFtZVtJRk5BTVNJWl07Cj4gPiA+Cj4gPiA+ICAgICAgICAgICAgICAg
ICAvKiBJZ25vcmUgdW5tb3ZlYWJsZSBkZXZpY2VzIChpLmUuIGxvb3BiYWNrKSAqLwo+ID4gPiAt
ICAgICAgICAgICAgICAgaWYgKGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX05FVE5TX0xPQ0FMKQo+
ID4gPiArICAgICAgICAgICAgICAgaWYgKGRldi0+ZmVhdHVyZXNbMF0gJiBORVRJRl9GX05FVE5T
X0xPQ0FMKQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPiA+ID4KPiA+
ID4gICAgICAgICAgICAgICAgIC8qIExlYXZlIHZpcnR1YWwgZGV2aWNlcyBmb3IgdGhlIGdlbmVy
aWMgY2xlYW51cCAqLwo+ID4gPiBkaWZmIC0tZ2l0IGEvbmV0L2NvcmUvbmV0cG9sbC5jIGIvbmV0
L2NvcmUvbmV0cG9sbC5jCj4gPiA+IGluZGV4IDBhNmIwNDcuLjJjMGFkZjQgMTAwNjQ0Cj4gPiA+
IC0tLSBhL25ldC9jb3JlL25ldHBvbGwuYwo+ID4gPiArKysgYi9uZXQvY29yZS9uZXRwb2xsLmMK
PiA+ID4gQEAgLTc0LDEzICs3NCwxMyBAQCBzdGF0aWMgbmV0ZGV2X3R4X3QgbmV0cG9sbF9zdGFy
dF94bWl0KHN0cnVjdCBza19idWZmICpza2IsCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKPiA+ID4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgbmV0ZGV2X3F1ZXVlICp0eHEpCj4gPiA+
ICB7Cj4gPiA+ICsgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXNbTkVUREVWX0ZFQVRV
UkVfRFdPUkRTXTsKPiA+ID4gICAgICAgICBuZXRkZXZfdHhfdCBzdGF0dXMgPSBORVRERVZfVFhf
T0s7Cj4gPiA+IC0gICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXM7Cj4gPiA+Cj4gPiA+
IC0gICAgICAgZmVhdHVyZXMgPSBuZXRpZl9za2JfZmVhdHVyZXMoc2tiKTsKPiA+ID4gKyAgICAg
ICBuZXRpZl9za2JfZmVhdHVyZXMoc2tiLCBmZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+ICAgICAgICAg
aWYgKHNrYl92bGFuX3RhZ19wcmVzZW50KHNrYikgJiYKPiA+ID4gLSAgICAgICAgICAgIXZsYW5f
aHdfb2ZmbG9hZF9jYXBhYmxlKGZlYXR1cmVzLCBza2ItPnZsYW5fcHJvdG8pKSB7Cj4gPiA+ICsg
ICAgICAgICAgICF2bGFuX2h3X29mZmxvYWRfY2FwYWJsZShmZWF0dXJlc1swXSwgc2tiLT52bGFu
X3Byb3RvKSkgewo+ID4gPiAgICAgICAgICAgICAgICAgc2tiID0gX192bGFuX2h3YWNjZWxfcHVz
aF9pbnNpZGUoc2tiKTsKPiA+ID4gICAgICAgICAgICAgICAgIGlmICh1bmxpa2VseSghc2tiKSkg
ewo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAvKiBUaGlzIGlzIGFjdHVhbGx5IGEgcGFj
a2V0IGRyb3AsIGJ1dCB3ZQo+ID4gPiBkaWZmIC0tZ2l0IGEvbmV0L2V0aHRvb2wvZmVhdHVyZXMu
YyBiL25ldC9ldGh0b29sL2ZlYXR1cmVzLmMKPiA+ID4gaW5kZXggMWM5ZjRkZi4uMGVlZGIxNyAx
MDA2NDQKPiA+ID4gLS0tIGEvbmV0L2V0aHRvb2wvZmVhdHVyZXMuYwo+ID4gPiArKysgYi9uZXQv
ZXRodG9vbC9mZWF0dXJlcy5jCj4gPiA+IEBAIC0yNSwxMiArMjUsMTMgQEAgY29uc3Qgc3RydWN0
IG5sYV9wb2xpY3kgZXRobmxfZmVhdHVyZXNfZ2V0X3BvbGljeVtdID0gewo+ID4gPiAgICAgICAg
ICAgICAgICAgTkxBX1BPTElDWV9ORVNURUQoZXRobmxfaGVhZGVyX3BvbGljeSksCj4gPiA+ICB9
Owo+ID4gPgo+ID4gPiAtc3RhdGljIHZvaWQgZXRobmxfZmVhdHVyZXNfdG9fYml0bWFwMzIodTMy
ICpkZXN0LCBuZXRkZXZfZmVhdHVyZXNfdCBzcmMpCj4gPiA+ICtzdGF0aWMgdm9pZCBldGhubF9m
ZWF0dXJlc190b19iaXRtYXAzMih1MzIgKmRlc3QsIG5ldGRldl9mZWF0dXJlc190ICpzcmMpCj4g
PiA+ICB7Cj4gPiA+ICsgICAgICAgdTMyICpfX3NyYyA9ICh1MzIgKilzcmM7Cj4gPiA+ICAgICAg
ICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IEVU
SFRPT0xfREVWX0ZFQVRVUkVfV09SRFM7IGkrKykKPiA+ID4gLSAgICAgICAgICAgICAgIGRlc3Rb
aV0gPSBzcmMgPj4gKDMyICogaSk7Cj4gPiA+ICsgICAgICAgICAgICAgICBkZXN0W2ldID0gX19z
cmNbaV07Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICBzdGF0aWMgaW50IGZlYXR1cmVzX3ByZXBhcmVf
ZGF0YShjb25zdCBzdHJ1Y3QgZXRobmxfcmVxX2luZm8gKnJlcV9iYXNlLAo+ID4gPiBAQCAtMzgs
MTUgKzM5LDIzIEBAIHN0YXRpYyBpbnQgZmVhdHVyZXNfcHJlcGFyZV9kYXRhKGNvbnN0IHN0cnVj
dAo+ID4gPiBldGhubF9yZXFfaW5mbyAqcmVxX2Jhc2UsCj4gPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBnZW5sX2luZm8gKmluZm8pCj4gPiA+ICB7Cj4gPiA+ICAg
ICAgICAgc3RydWN0IGZlYXR1cmVzX3JlcGx5X2RhdGEgKmRhdGEgPSBGRUFUVVJFU19SRVBEQVRB
KHJlcGx5X2Jhc2UpOwo+ID4gPiArICAgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzW05F
VERFVl9GRUFUVVJFX0RXT1JEU10gPSB7MH07Cj4gPiA+ICAgICAgICAgc3RydWN0IG5ldF9kZXZp
Y2UgKmRldiA9IHJlcGx5X2Jhc2UtPmRldjsKPiA+ID4gLSAgICAgICBuZXRkZXZfZmVhdHVyZXNf
dCBhbGxfZmVhdHVyZXM7Cj4gPiA+ICsgICAgICAgdW5zaWduZWQgaW50IGk7Cj4gPiA+Cj4gPiA+
ICAgICAgICAgZXRobmxfZmVhdHVyZXNfdG9fYml0bWFwMzIoZGF0YS0+aHcsIGRldi0+aHdfZmVh
dHVyZXMpOwo+ID4gPiAgICAgICAgIGV0aG5sX2ZlYXR1cmVzX3RvX2JpdG1hcDMyKGRhdGEtPndh
bnRlZCwgZGV2LT53YW50ZWRfZmVhdHVyZXMpOwo+ID4gPiAgICAgICAgIGV0aG5sX2ZlYXR1cmVz
X3RvX2JpdG1hcDMyKGRhdGEtPmFjdGl2ZSwgZGV2LT5mZWF0dXJlcyk7Cj4gPiA+IC0gICAgICAg
ZXRobmxfZmVhdHVyZXNfdG9fYml0bWFwMzIoZGF0YS0+bm9jaGFuZ2UsIE5FVElGX0ZfTkVWRVJf
Q0hBTkdFKTsKPiA+ID4gLSAgICAgICBhbGxfZmVhdHVyZXMgPSBHRU5NQVNLX1VMTChORVRERVZf
RkVBVFVSRV9DT1VOVCAtIDEsIDApOwo+ID4gPiAtICAgICAgIGV0aG5sX2ZlYXR1cmVzX3RvX2Jp
dG1hcDMyKGRhdGEtPmFsbCwgYWxsX2ZlYXR1cmVzKTsKPiA+ID4gKyAgICAgICBmZWF0dXJlc1sw
XSA9IE5FVElGX0ZfTkVWRVJfQ0hBTkdFOwo+ID4gPiArICAgICAgIGV0aG5sX2ZlYXR1cmVzX3Rv
X2JpdG1hcDMyKGRhdGEtPm5vY2hhbmdlLCBmZWF0dXJlcyk7Cj4gPiA+ICsgICAgICAgZm9yIChp
ID0gMDsgaSA8IE5FVERFVl9GRUFUVVJFX0RXT1JEUzsgaSsrKSB7Cj4gPiA+ICsgICAgICAgICAg
ICAgICBpZiAoTkVUREVWX0ZFQVRVUkVfQ09VTlQgPj0gKGkgKyAxKSAqIDY0KQo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBmZWF0dXJlc1tpXSA9IEdFTk1BU0tfVUxMKDYzLCAwKTsKPiA+
ID4gKyAgICAgICAgICAgICAgIGVsc2UKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZmVh
dHVyZXNbaV0gPSBHRU5NQVNLX1VMTChORVRERVZfRkVBVFVSRV9DT1VOVCAtIGkgKiA2NCwKPiA+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwKTsK
PiA+ID4gKyAgICAgICB9Cj4gPiA+ICsgICAgICAgZXRobmxfZmVhdHVyZXNfdG9fYml0bWFwMzIo
ZGF0YS0+YWxsLCBmZWF0dXJlcyk7Cj4gPiA+Cj4gPiA+ICAgICAgICAgcmV0dXJuIDA7Cj4gPiA+
ICB9Cj4gPiA+IEBAIC0xMzEsMjcgKzE0MCwyOSBAQCBjb25zdCBzdHJ1Y3QgbmxhX3BvbGljeSBl
dGhubF9mZWF0dXJlc19zZXRfcG9saWN5W10gPSB7Cj4gPiA+ICAgICAgICAgW0VUSFRPT0xfQV9G
RUFUVVJFU19XQU5URURdICAgICA9IHsgLnR5cGUgPSBOTEFfTkVTVEVEIH0sCj4gPiA+ICB9Owo+
ID4gPgo+ID4gPiAtc3RhdGljIHZvaWQgZXRobmxfZmVhdHVyZXNfdG9fYml0bWFwKHVuc2lnbmVk
IGxvbmcgKmRlc3QsCj4gPiA+IG5ldGRldl9mZWF0dXJlc190IHZhbCkKPiA+ID4gK3N0YXRpYyB2
b2lkIGV0aG5sX2ZlYXR1cmVzX3RvX2JpdG1hcCh1bnNpZ25lZCBsb25nICpkZXN0LAo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2ZlYXR1cmVzX3QgKnZh
bCkKPiA+ID4gIHsKPiA+ID4gICAgICAgICBjb25zdCB1bnNpZ25lZCBpbnQgd29yZHMgPSBCSVRT
X1RPX0xPTkdTKE5FVERFVl9GRUFUVVJFX0NPVU5UKTsKPiA+ID4gICAgICAgICB1bnNpZ25lZCBp
bnQgaTsKPiA+ID4KPiA+ID4gICAgICAgICBiaXRtYXBfemVybyhkZXN0LCBORVRERVZfRkVBVFVS
RV9DT1VOVCk7Cj4gPiA+ICAgICAgICAgZm9yIChpID0gMDsgaSA8IHdvcmRzOyBpKyspCj4gPiA+
IC0gICAgICAgICAgICAgICBkZXN0W2ldID0gKHVuc2lnbmVkIGxvbmcpKHZhbCA+PiAoaSAqIEJJ
VFNfUEVSX0xPTkcpKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGRlc3RbaV0gPQo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAodW5zaWduZWQgbG9uZykodmFsW2kgLyAyXSA+PiAoaSAlIDIg
KiBCSVRTX1BFUl9MT05HKSk7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+IC1zdGF0aWMgbmV0ZGV2X2Zl
YXR1cmVzX3QgZXRobmxfYml0bWFwX3RvX2ZlYXR1cmVzKHVuc2lnbmVkIGxvbmcgKnNyYykKPiA+
ID4gK3N0YXRpYyB2b2lkIGV0aG5sX2JpdG1hcF90b19mZWF0dXJlcyhuZXRkZXZfZmVhdHVyZXNf
dCAqdmFsLCB1bnNpZ25lZAo+ID4gPiBsb25nICpzcmMpCj4gPiA+ICB7Cj4gPiA+IC0gICAgICAg
Y29uc3QgdW5zaWduZWQgaW50IG5mdF9iaXRzID0gc2l6ZW9mKG5ldGRldl9mZWF0dXJlc190KSAq
IEJJVFNfUEVSX0JZVEU7Cj4gPiA+ICAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IHdvcmRzID0g
QklUU19UT19MT05HUyhORVRERVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+IC0gICAgICAgbmV0ZGV2
X2ZlYXR1cmVzX3QgcmV0ID0gMDsKPiA+ID4gICAgICAgICB1bnNpZ25lZCBpbnQgaTsKPiA+ID4K
PiA+ID4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgTkVUREVWX0ZFQVRVUkVfRFdPUkRTOyBpKysp
Cj4gPiA+ICsgICAgICAgICAgICAgICB2YWxbaV0gPSAwOwo+ID4gPiArCj4gPiA+ICAgICAgICAg
Zm9yIChpID0gMDsgaSA8IHdvcmRzOyBpKyspCj4gPiA+IC0gICAgICAgICAgICAgICByZXQgfD0g
KG5ldGRldl9mZWF0dXJlc190KShzcmNbaV0pIDw8IChpICogQklUU19QRVJfTE9ORyk7Cj4gPiA+
IC0gICAgICAgcmV0ICY9IH4obmV0ZGV2X2ZlYXR1cmVzX3QpMCA+PiAobmZ0X2JpdHMgLSBORVRE
RVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+IC0gICAgICAgcmV0dXJuIHJldDsKPiA+ID4gKyAgICAg
ICAgICAgICAgIHZhbFtpIC8gMl0gfD0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgKG5l
dGRldl9mZWF0dXJlc190KShzcmNbaV0pIDw8IChpICUgMiAqIEJJVFNfUEVSX0xPTkcpOwo+ID4g
PiAgfQo+ID4gPgo+ID4gPiAgc3RhdGljIGludCBmZWF0dXJlc19zZW5kX3JlcGx5KHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsIHN0cnVjdCBnZW5sX2luZm8gKmluZm8sCj4gPiA+IEBAIC0yMTIsMTIg
KzIyMywxNCBAQCBpbnQgZXRobmxfc2V0X2ZlYXR1cmVzKHN0cnVjdCBza19idWZmICpza2IsCj4g
PiA+IHN0cnVjdCBnZW5sX2luZm8gKmluZm8pCj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgREVDTEFS
RV9CSVRNQVAod2FudGVkX2RpZmZfbWFzaywgTkVUREVWX0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAg
ICAgICAgIERFQ0xBUkVfQklUTUFQKGFjdGl2ZV9kaWZmX21hc2ssIE5FVERFVl9GRUFUVVJFX0NP
VU5UKTsKPiA+ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlc1tORVRERVZfRkVB
VFVSRV9EV09SRFNdOwo+ID4gPiAgICAgICAgIERFQ0xBUkVfQklUTUFQKG9sZF9hY3RpdmUsIE5F
VERFVl9GRUFUVVJFX0NPVU5UKTsKPiA+ID4gICAgICAgICBERUNMQVJFX0JJVE1BUChvbGRfd2Fu
dGVkLCBORVRERVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+ICAgICAgICAgREVDTEFSRV9CSVRNQVAo
bmV3X2FjdGl2ZSwgTkVUREVWX0ZFQVRVUkVfQ09VTlQpOwo+ID4gPiAgICAgICAgIERFQ0xBUkVf
QklUTUFQKG5ld193YW50ZWQsIE5FVERFVl9GRUFUVVJFX0NPVU5UKTsKPiA+ID4gICAgICAgICBE
RUNMQVJFX0JJVE1BUChyZXFfd2FudGVkLCBORVRERVZfRkVBVFVSRV9DT1VOVCk7Cj4gPiA+ICAg
ICAgICAgREVDTEFSRV9CSVRNQVAocmVxX21hc2ssIE5FVERFVl9GRUFUVVJFX0NPVU5UKTsKPiA+
ID4gKyAgICAgICBuZXRkZXZfZmVhdHVyZXNfdCB0bXBbTkVUREVWX0ZFQVRVUkVfRFdPUkRTXTsK
PiA+ID4gICAgICAgICBzdHJ1Y3QgZXRobmxfcmVxX2luZm8gcmVxX2luZm8gPSB7fTsKPiA+ID4g
ICAgICAgICBzdHJ1Y3QgbmxhdHRyICoqdGIgPSBpbmZvLT5hdHRyczsKPiA+ID4gICAgICAgICBz
dHJ1Y3QgbmV0X2RldmljZQoKCgotLQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpDYWtlIG1haWxpbmcgbGlzdApDYWtlQGxpc3RzLmJ1ZmZlcmJsb2F0Lm5l
dApodHRwczovL2xpc3RzLmJ1ZmZlcmJsb2F0Lm5ldC9saXN0aW5mby9jYWtlCg==

Return-Path: <cake-bounces@lists.bufferbloat.net>
X-Original-To: lists+cake@lfdr.de
Delivered-To: lists+cake@lfdr.de
Received: from mail.toke.dk (mail.toke.dk [45.145.95.4])
	by mail.lfdr.de (Postfix) with ESMTPS id 85C74C8D8D0
	for <lists+cake@lfdr.de>; Thu, 27 Nov 2025 10:31:10 +0100 (CET)
Received: from [45.145.95.3] (localhost.localdomain [IPv6:::1])
	by mail.toke.dk (Postfix) with ESMTP id ABFC19D3ED0;
	Thu, 27 Nov 2025 10:31:08 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
	d=lists.bufferbloat.net; s=20250711; t=1764235868;
	bh=e8PpxmMA2o+RbW4+icQvpqHH2jpaqbz+NbEoo7EJ02s=;
	h=Date:References:In-Reply-To:To:Cc:Subject:List-Id:List-Archive:
	 List-Help:List-Owner:List-Post:List-Subscribe:List-Unsubscribe:
	 From:Reply-To:From;
	b=J9MTYSFL1GSRl+s9gc5BYiAu3Hdh0BCzs7gBFhWFECgC4QcvOVWgCnmbYyo1NXllG
	 D/bODd3io6A/SPOKj7yNkJt4C1+fqUrCn2dLIfDNl02Tx/BaKo3kNWsuWZrkK4exxG
	 akTL48SWbARUOc8TZXes/zfQbxQ+Suh1f/PXdLeyPF1L47kqr5hkTqr1kDEJ9i2P1e
	 +wWG0xBiM2UJ8sL3y5zYQjh0ax3qWRtMfuNfCRD/R7UTx/tuDfyFrPxPAxy9GRIiHW
	 hQxuWjhd4+66Hjzo6b99vtLJ0oKvv9iIb0DQs+Xv2qVEwLZ12HLIGZgqCLG1xZINCw
	 /P5GmGA7r8sTw==
ARC-Seal: i=1; cv=none; a=rsa-sha256; d=toke.dk; s=arc202507;
 t=1764235868;
 b=lJuM4kHhQsRUNKeFfjTXLBGV/i9PdDuNeC0mpOjLdqI8+rYHzU30ji8A89y/n+89IoNrw
 uSlx74FNpu1EIwxE/LHkrNX73P7EvQNkWY6aZu0h0Itij9u0hdB8fPg8N4QqMqPw44pZQpw
 f/cP/8eTZjyDe+eqsrs5LjXeuLance8=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=toke.dk;
 s=arc202507; t=1764235868; h=from : sender : reply-to : subject : date
 : message-id : to : cc : mime-version : content-type :
 content-transfer-encoding : content-id : content-description :
 resent-date : resent-from : resent-sender : resent-to : resent-cc :
 resent-message-id : in-reply-to : references : list-id : list-help :
 list-unsubscribe : list-subscribe : list-post : list-owner :
 list-archive; bh=e8PpxmMA2o+RbW4+icQvpqHH2jpaqbz+NbEoo7EJ02s=;
 b=7J2nCouCwy/GinW6DLCdm2vAC5YlmYN4McwCL384BcH/FPJeM+k3zFK+ZMTKCs5aLw8jm
 KhQZgczcM9zCbRo+FYTtkl2V6P1s7RVUQpy40FNhIZCOz7ExyNy3Dxtu/fE8hx8GnL3tyEI
 qzgs7Ee9TTfXo2MqW2oKFQmMkfmwF4Q=
ARC-Authentication-Results: i=1; mail.toke.dk;
 spf=pass smtp.mailfrom=;
 dkim=pass header.d=redhat.com;
 arc=none;
 dmarc=pass header.from=redhat.com policy.dmarc=quarantine
Authentication-Results: mail.toke.dk; spf=pass smtp.mailfrom=;
 dkim=pass header.d=redhat.com; arc=none (Message is not ARC signed);
 dmarc=pass (Used From Domain Record) header.from=redhat.com
 policy.dmarc=quarantine
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
	by mail.toke.dk (Postfix) with ESMTPS id E046A9D3E9B
	for <cake@lists.bufferbloat.net>; Thu, 27 Nov 2025 10:31:05 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
	s=mimecast20190719; t=1764235863;
	h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
	 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding:
	 in-reply-to:in-reply-to:references:references;
	bh=fYsNtpO1R5U2YmXQRCyrPnN4Zbs126tMuztWKlbGgA0=;
	b=Yr8lQ/jC6s9AqH8ao+65NCWcIs2HAqyfmQB6O9ee2UcRxW13Rbv9arELCYQ2Bu06m+pZZU
	uG9+EzkjfEZfVOTAecJapD5HPVqXh/1xOotB4bJSKiQZ5r7jBCw2AwkZ8P9ZENzoJ6L14B
	10m+nXRv2eDUEQbchIKxKhBWTBZ13ck=
Received: from mail-ej1-f71.google.com (mail-ej1-f71.google.com
 [209.85.218.71]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-508-UNZJub9PM5q3kmcK1RCStA-1; Thu, 27 Nov 2025 04:31:01 -0500
X-MC-Unique: UNZJub9PM5q3kmcK1RCStA-1
X-Mimecast-MFC-AGG-ID: UNZJub9PM5q3kmcK1RCStA_1764235860
Received: by mail-ej1-f71.google.com with SMTP id
 a640c23a62f3a-b73720562ceso52432966b.0
        for <cake@lists.bufferbloat.net>;
 Thu, 27 Nov 2025 01:31:01 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1764235860; x=1764840660;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-gg:x-gm-message-state:from:to
         :cc:subject:date:message-id:reply-to;
        bh=fYsNtpO1R5U2YmXQRCyrPnN4Zbs126tMuztWKlbGgA0=;
        b=wVKUBUQgQWE14ft2kFayoe4v6sPgfb+JpvHgTdS2wU+1L5yHkXX7KvgVAMqm+uV0BJ
         Jz580F5HXcJkb20m4BpKsXWbfTfvTGxqHsX9VqoGybisUl1QOOysTdiktpl8mvw+acAR
         p7rU3uNzTtjmp0tKFdy7E48zTebwN2b4EfM3YbIGuPgjNm/IOJmHD1wtSrxqX/eDYCOW
         G/0SPZHcf8tFAFrBPlFm+dxGGfV+h3+hddExAIk2F/UlwM0Pk5hcyMMLhFW270KxKuuG
         4oTzV3f5BVKUKEzIwcctsAIHjKOvF0WKsPV2WICIaPSg1WO8t0cf1ot7PuoVEsNsDnUf
         2Puw==
X-Forwarded-Encrypted: i=1;
 AJvYcCUKabtqp7bFJujLFaIXNCyLNAqTg4YNPXMleKDKaz4sXfLY8Bjy7S/525j2T/L9Rt5/fG4K@lists.bufferbloat.net
X-Gm-Message-State: AOJu0YzhyIP6pkghw8C55cruYyPBaaWvCtNrK6c6Jex4x8M7MzZyKj+W
	5x3nIgeKCZvRRPiIU9E7NXbKT+qdlkTs3Xy3Ajqr49xK3yXkPVwagq6A+etpDeP/gPIQm20Hmi5
	6sY0l4O6FMBNcPGss0kdxMthaziIGGGPQtfzPqtZ68yH/hbrKBLnKxALsBsSaUxE=
X-Gm-Gg: ASbGnctgMMA9Zgz0y3O1+RXaiDNOsnUO7QD5ug2af+/MYotVigh8DelFIaIAOSX/uei
	+NYSFk1FfLEL5NdvZbUHk+wuXB0twEkc0CDAG9opRbYtxRIuOEt5e0QicdNCLkJ2oKKHbTFnV+m
	oN+7ViqOgyaEslNCTQ3w/GkhxFuHQnL/ZTuwu8vkagyYgOIhiRYmTL8HAWcZv3UcfqSWn13u4Vg
	diw0QSu4mN0AcFw2eAFntcLdha9tUau3G+qSX8fzKh2JVY6bMy+pch7AFSZJarkva9TJK3mGiMK
	E77UtyvMPs4lcLcTHqo/thwaNIxzdKbvcjtaKzoDQncPoQew1luQcX0USaGlVTpqNoNHYrP7wRQ
	IFIqlAZuf+2YyDrX+QRSuVr1tYJHF6uYAGfX2
X-Received: by 2002:a17:907:980b:b0:b73:3d1d:2249 with SMTP id
 a640c23a62f3a-b76c55131b6mr1154846066b.29.1764235859718;
        Thu, 27 Nov 2025 01:30:59 -0800 (PST)
X-Google-Smtp-Source: 
 AGHT+IGyvcweSYxVr2KMe/lOAlrRf8zwYME8RPIfFY4y4dBwXFsVCZ889TOT8bgy8RWApLHNqkVBPw==
X-Received: by 2002:a17:907:980b:b0:b73:3d1d:2249 with SMTP id
 a640c23a62f3a-b76c55131b6mr1154842966b.29.1764235859198;
        Thu, 27 Nov 2025 01:30:59 -0800 (PST)
Received: from alrua-x1.borgediget.toke.dk (alrua-x1.borgediget.toke.dk.
 [2a0c:4d80:42:443::2])
        by smtp.gmail.com with ESMTPSA id
 4fb4d7f45d1cf-64750a90caasm1062040a12.11.2025.11.27.01.30.57
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Thu, 27 Nov 2025 01:30:58 -0800 (PST)
Received: by alrua-x1.borgediget.toke.dk (Postfix, from userid 1000)
	id 42EA9395701; Thu, 27 Nov 2025 10:30:57 +0100 (CET)
Date: Thu, 27 Nov 2025 10:30:51 +0100
MIME-Version: 1.0
Message-Id: <20251127-mq-cake-sub-qdisc-v2-1-24d9ead047b9@redhat.com>
References: <20251127-mq-cake-sub-qdisc-v2-0-24d9ead047b9@redhat.com>
In-Reply-To: <20251127-mq-cake-sub-qdisc-v2-0-24d9ead047b9@redhat.com>
To: =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen?= <toke@toke.dk>,
 Jamal Hadi Salim <jhs@mojatatu.com>, Cong Wang <xiyou.wangcong@gmail.com>,
 Jiri Pirko <jiri@resnulli.us>, "David S. Miller" <davem@davemloft.net>,
 Eric Dumazet <edumazet@google.com>, Jakub Kicinski <kuba@kernel.org>,
 Paolo Abeni <pabeni@redhat.com>, Simon Horman <horms@kernel.org>
Cc: =?utf-8?q?Jonas_K=C3=B6ppeler?= <j.koeppeler@tu-berlin.de>,
 cake@lists.bufferbloat.net, netdev@vger.kernel.org,
 =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen?= <toke@redhat.com>
X-Mailer: b4 0.14.3
X-Mimecast-Spam-Score: 0
X-Mimecast-MFC-PROC-ID: Ur6dETTIbw80ce_d9CkDsjvNQcdZgbbjyFhwT8SY77M_1764235860
X-Mimecast-Originator: redhat.com
Content-Type: text/plain; charset="utf-8"
Message-ID-Hash: NEHF2TKKY3BRWJD7QGE7AELEXK32N4EC
X-Message-ID-Hash: NEHF2TKKY3BRWJD7QGE7AELEXK32N4EC
X-MailFrom: toke@redhat.com
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; loop;
 banned-address; emergency; member-moderation; nonmember-moderation;
 administrivia; implicit-dest; max-recipients; max-size; news-moderation;
 no-subject; digests; suspicious-header
X-Mailman-Version: 3.3.10
Precedence: list
Subject: [Cake] [PATCH net-next v2 1/4] net/sched: sch_cake: Factor out config
 variables into separate struct
List-Id: Cake - FQ_codel the next generation <cake.lists.bufferbloat.net>
Archived-At: 
 <https://lists.bufferbloat.net/cake/20251127-mq-cake-sub-qdisc-v2-1-24d9ead047b9@redhat.com/>
List-Archive: <https://lists.bufferbloat.net/cake/>
List-Help: <mailto:cake-request@lists.bufferbloat.net?subject=help>
List-Owner: <mailto:cake-owner@lists.bufferbloat.net>
List-Post: <mailto:cake@lists.bufferbloat.net>
List-Subscribe: <mailto:cake-join@lists.bufferbloat.net>
List-Unsubscribe: <mailto:cake-leave@lists.bufferbloat.net>
From: =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen_via_Cake?=
 <cake@lists.bufferbloat.net>
Reply-To: =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen?= <toke@redhat.com>
Content-Transfer-Encoding: base64

RmFjdG9yIG91dCBhbGwgdGhlIHVzZXItY29uZmlndXJhYmxlIHZhcmlhYmxlcyBpbnRvIGEgc2Vw
YXJhdGUgc3RydWN0DQphbmQgZW1iZWQgaXQgaW50byBzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhLiBU
aGlzIGlzIGRvbmUgaW4gcHJlcGFyYXRpb24NCmZvciBzaGFyaW5nIHRoZSBjb25maWd1cmF0aW9u
IGFjcm9zcyBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgY2FrZSBpbiBhbiBtcQ0Kc2V0dXAuDQoNCk5v
IGZ1bmN0aW9uYWwgY2hhbmdlIGlzIGludGVuZGVkIHdpdGggdGhpcyBwYXRjaC4NCg0KUmV2aWV3
ZWQtYnk6IEphbWFsIEhhZGkgU2FsaW0gPGpoc0Btb2phdGF0dS5jb20+DQpTaWduZWQtb2ZmLWJ5
OiBUb2tlIEjDuGlsYW5kLUrDuHJnZW5zZW4gPHRva2VAcmVkaGF0LmNvbT4NCi0tLQ0KIG5ldC9z
Y2hlZC9zY2hfY2FrZS5jIHwgMjQ1ICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQ0KIDEgZmlsZSBjaGFuZ2VkLCAxMzMgaW5zZXJ0aW9ucygrKSwgMTEy
IGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvbmV0L3NjaGVkL3NjaF9jYWtlLmMgYi9uZXQv
c2NoZWQvc2NoX2Nha2UuYw0KaW5kZXggMGVhOTQ0MGY2OGM2Li41NDViOWI4MzBjY2UgMTAwNjQ0
DQotLS0gYS9uZXQvc2NoZWQvc2NoX2Nha2UuYw0KKysrIGIvbmV0L3NjaGVkL3NjaF9jYWtlLmMN
CkBAIC0xOTcsNDAgKzE5Nyw0MiBAQCBzdHJ1Y3QgY2FrZV90aW5fZGF0YSB7DQogCXUzMgl3YXlf
Y29sbGlzaW9uczsNCiB9OyAvKiBudW1iZXIgb2YgdGlucyBpcyBzbWFsbCwgc28gc2l6ZSBvZiB0
aGlzIHN0cnVjdCBkb2Vzbid0IG1hdHRlciBtdWNoICovDQogDQorc3RydWN0IGNha2Vfc2NoZWRf
Y29uZmlnIHsNCisJdTY0CQlyYXRlX2JwczsNCisJdTY0CQlpbnRlcnZhbDsNCisJdTY0CQl0YXJn
ZXQ7DQorCXUzMgkJYnVmZmVyX2NvbmZpZ19saW1pdDsNCisJdTMyCQlmd21hcmtfbWFzazsNCisJ
dTE2CQlmd21hcmtfc2hmdDsNCisJczE2CQlyYXRlX292ZXJoZWFkOw0KKwl1MTYJCXJhdGVfbXB1
Ow0KKwl1MTYJCXJhdGVfZmxhZ3M7DQorCXU4CQl0aW5fbW9kZTsNCisJdTgJCWZsb3dfbW9kZTsN
CisJdTgJCWF0bV9tb2RlOw0KKwl1OAkJYWNrX2ZpbHRlcjsNCit9Ow0KKw0KIHN0cnVjdCBjYWtl
X3NjaGVkX2RhdGEgew0KIAlzdHJ1Y3QgdGNmX3Byb3RvIF9fcmN1ICpmaWx0ZXJfbGlzdDsgLyog
b3B0aW9uYWwgZXh0ZXJuYWwgY2xhc3NpZmllciAqLw0KIAlzdHJ1Y3QgdGNmX2Jsb2NrICpibG9j
azsNCiAJc3RydWN0IGNha2VfdGluX2RhdGEgKnRpbnM7DQorCXN0cnVjdCBjYWtlX3NjaGVkX2Nv
bmZpZyAqY29uZmlnOw0KIA0KIAlzdHJ1Y3QgY2FrZV9oZWFwX2VudHJ5IG92ZXJmbG93X2hlYXBb
Q0FLRV9RVUVVRVMgKiBDQUtFX01BWF9USU5TXTsNCi0JdTE2CQlvdmVyZmxvd190aW1lb3V0Ow0K
LQ0KLQl1MTYJCXRpbl9jbnQ7DQotCXU4CQl0aW5fbW9kZTsNCi0JdTgJCWZsb3dfbW9kZTsNCi0J
dTgJCWFja19maWx0ZXI7DQotCXU4CQlhdG1fbW9kZTsNCi0NCi0JdTMyCQlmd21hcmtfbWFzazsN
Ci0JdTE2CQlmd21hcmtfc2hmdDsNCiANCiAJLyogdGltZV9uZXh0ID0gdGltZV90aGlzICsgKChs
ZW4gKiByYXRlX25zKSA+PiByYXRlX3NoZnQpICovDQotCXUxNgkJcmF0ZV9zaGZ0Ow0KIAlrdGlt
ZV90CQl0aW1lX25leHRfcGFja2V0Ow0KIAlrdGltZV90CQlmYWlsc2FmZV9uZXh0X3BhY2tldDsN
CiAJdTY0CQlyYXRlX25zOw0KLQl1NjQJCXJhdGVfYnBzOw0KLQl1MTYJCXJhdGVfZmxhZ3M7DQot
CXMxNgkJcmF0ZV9vdmVyaGVhZDsNCi0JdTE2CQlyYXRlX21wdTsNCi0JdTY0CQlpbnRlcnZhbDsN
Ci0JdTY0CQl0YXJnZXQ7DQorCXUxNgkJcmF0ZV9zaGZ0Ow0KKwl1MTYJCW92ZXJmbG93X3RpbWVv
dXQ7DQorCXUxNgkJdGluX2NudDsNCiANCiAJLyogcmVzb3VyY2UgdHJhY2tpbmcgKi8NCiAJdTMy
CQlidWZmZXJfdXNlZDsNCiAJdTMyCQlidWZmZXJfbWF4X3VzZWQ7DQogCXUzMgkJYnVmZmVyX2xp
bWl0Ow0KLQl1MzIJCWJ1ZmZlcl9jb25maWdfbGltaXQ7DQogDQogCS8qIGluZGljZXMgZm9yIGRl
cXVldWUgKi8NCiAJdTE2CQljdXJfdGluOw0KQEAgLTExOTgsNyArMTIwMCw3IEBAIHN0YXRpYyBi
b29sIGNha2VfdGNwaF9tYXlfZHJvcChjb25zdCBzdHJ1Y3QgdGNwaGRyICp0Y3BoLA0KIHN0YXRp
YyBzdHJ1Y3Qgc2tfYnVmZiAqY2FrZV9hY2tfZmlsdGVyKHN0cnVjdCBjYWtlX3NjaGVkX2RhdGEg
KnEsDQogCQkJCSAgICAgICBzdHJ1Y3QgY2FrZV9mbG93ICpmbG93KQ0KIHsNCi0JYm9vbCBhZ2dy
ZXNzaXZlID0gcS0+YWNrX2ZpbHRlciA9PSBDQUtFX0FDS19BR0dSRVNTSVZFOw0KKwlib29sIGFn
Z3Jlc3NpdmUgPSBxLT5jb25maWctPmFja19maWx0ZXIgPT0gQ0FLRV9BQ0tfQUdHUkVTU0lWRTsN
CiAJc3RydWN0IHNrX2J1ZmYgKmVsaWdfYWNrID0gTlVMTCwgKmVsaWdfYWNrX3ByZXYgPSBOVUxM
Ow0KIAlzdHJ1Y3Qgc2tfYnVmZiAqc2tiX2NoZWNrLCAqc2tiX3ByZXYgPSBOVUxMOw0KIAljb25z
dCBzdHJ1Y3QgaXB2NmhkciAqaXB2NmgsICppcHY2aF9jaGVjazsNCkBAIC0xMzU4LDE1ICsxMzYw
LDE3IEBAIHN0YXRpYyB1NjQgY2FrZV9ld21hKHU2NCBhdmcsIHU2NCBzYW1wbGUsIHUzMiBzaGlm
dCkNCiAJcmV0dXJuIGF2ZzsNCiB9DQogDQotc3RhdGljIHUzMiBjYWtlX2NhbGNfb3ZlcmhlYWQo
c3RydWN0IGNha2Vfc2NoZWRfZGF0YSAqcSwgdTMyIGxlbiwgdTMyIG9mZikNCitzdGF0aWMgdTMy
IGNha2VfY2FsY19vdmVyaGVhZChzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxZCwgdTMyIGxlbiwg
dTMyIG9mZikNCiB7DQorCXN0cnVjdCBjYWtlX3NjaGVkX2NvbmZpZyAqcSA9IHFkLT5jb25maWc7
DQorDQogCWlmIChxLT5yYXRlX2ZsYWdzICYgQ0FLRV9GTEFHX09WRVJIRUFEKQ0KIAkJbGVuIC09
IG9mZjsNCiANCi0JaWYgKHEtPm1heF9uZXRsZW4gPCBsZW4pDQotCQlxLT5tYXhfbmV0bGVuID0g
bGVuOw0KLQlpZiAocS0+bWluX25ldGxlbiA+IGxlbikNCi0JCXEtPm1pbl9uZXRsZW4gPSBsZW47
DQorCWlmIChxZC0+bWF4X25ldGxlbiA8IGxlbikNCisJCXFkLT5tYXhfbmV0bGVuID0gbGVuOw0K
KwlpZiAocWQtPm1pbl9uZXRsZW4gPiBsZW4pDQorCQlxZC0+bWluX25ldGxlbiA9IGxlbjsNCiAN
CiAJbGVuICs9IHEtPnJhdGVfb3ZlcmhlYWQ7DQogDQpAQCAtMTM4NSwxMCArMTM4OSwxMCBAQCBz
dGF0aWMgdTMyIGNha2VfY2FsY19vdmVyaGVhZChzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxLCB1
MzIgbGVuLCB1MzIgb2ZmKQ0KIAkJbGVuICs9IChsZW4gKyA2MykgLyA2NDsNCiAJfQ0KIA0KLQlp
ZiAocS0+bWF4X2FkamxlbiA8IGxlbikNCi0JCXEtPm1heF9hZGpsZW4gPSBsZW47DQotCWlmIChx
LT5taW5fYWRqbGVuID4gbGVuKQ0KLQkJcS0+bWluX2FkamxlbiA9IGxlbjsNCisJaWYgKHFkLT5t
YXhfYWRqbGVuIDwgbGVuKQ0KKwkJcWQtPm1heF9hZGpsZW4gPSBsZW47DQorCWlmIChxZC0+bWlu
X2FkamxlbiA+IGxlbikNCisJCXFkLT5taW5fYWRqbGVuID0gbGVuOw0KIA0KIAlyZXR1cm4gbGVu
Ow0KIH0NCkBAIC0xNTg2LDcgKzE1OTAsNyBAQCBzdGF0aWMgdW5zaWduZWQgaW50IGNha2VfZHJv
cChzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IHNrX2J1ZmYgKip0b19mcmVlKQ0KIAlmbG93LT5k
cm9wcGVkKys7DQogCWItPnRpbl9kcm9wcGVkKys7DQogDQotCWlmIChxLT5yYXRlX2ZsYWdzICYg
Q0FLRV9GTEFHX0lOR1JFU1MpDQorCWlmIChxLT5jb25maWctPnJhdGVfZmxhZ3MgJiBDQUtFX0ZM
QUdfSU5HUkVTUykNCiAJCWNha2VfYWR2YW5jZV9zaGFwZXIocSwgYiwgc2tiLCBub3csIHRydWUp
Ow0KIA0KIAlxZGlzY19kcm9wX3JlYXNvbihza2IsIHNjaCwgdG9fZnJlZSwgU0tCX0RST1BfUkVB
U09OX1FESVNDX09WRVJMSU1JVCk7DQpAQCAtMTY1Nyw3ICsxNjYxLDggQEAgc3RhdGljIHU4IGNh
a2VfaGFuZGxlX2RpZmZzZXJ2KHN0cnVjdCBza19idWZmICpza2IsIGJvb2wgd2FzaCkNCiBzdGF0
aWMgc3RydWN0IGNha2VfdGluX2RhdGEgKmNha2Vfc2VsZWN0X3RpbihzdHJ1Y3QgUWRpc2MgKnNj
aCwNCiAJCQkJCSAgICAgc3RydWN0IHNrX2J1ZmYgKnNrYikNCiB7DQotCXN0cnVjdCBjYWtlX3Nj
aGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7DQorCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEg
KnFkID0gcWRpc2NfcHJpdihzY2gpOw0KKwlzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcgKnEgPSBx
ZC0+Y29uZmlnOw0KIAl1MzIgdGluLCBtYXJrOw0KIAlib29sIHdhc2g7DQogCXU4IGRzY3A7DQpA
QCAtMTY3NCwyNCArMTY3OSwyNCBAQCBzdGF0aWMgc3RydWN0IGNha2VfdGluX2RhdGEgKmNha2Vf
c2VsZWN0X3RpbihzdHJ1Y3QgUWRpc2MgKnNjaCwNCiAJaWYgKHEtPnRpbl9tb2RlID09IENBS0Vf
RElGRlNFUlZfQkVTVEVGRk9SVCkNCiAJCXRpbiA9IDA7DQogDQotCWVsc2UgaWYgKG1hcmsgJiYg
bWFyayA8PSBxLT50aW5fY250KQ0KLQkJdGluID0gcS0+dGluX29yZGVyW21hcmsgLSAxXTsNCisJ
ZWxzZSBpZiAobWFyayAmJiBtYXJrIDw9IHFkLT50aW5fY250KQ0KKwkJdGluID0gcWQtPnRpbl9v
cmRlclttYXJrIC0gMV07DQogDQogCWVsc2UgaWYgKFRDX0hfTUFKKHNrYi0+cHJpb3JpdHkpID09
IHNjaC0+aGFuZGxlICYmDQogCQkgVENfSF9NSU4oc2tiLT5wcmlvcml0eSkgPiAwICYmDQotCQkg
VENfSF9NSU4oc2tiLT5wcmlvcml0eSkgPD0gcS0+dGluX2NudCkNCi0JCXRpbiA9IHEtPnRpbl9v
cmRlcltUQ19IX01JTihza2ItPnByaW9yaXR5KSAtIDFdOw0KKwkJIFRDX0hfTUlOKHNrYi0+cHJp
b3JpdHkpIDw9IHFkLT50aW5fY250KQ0KKwkJdGluID0gcWQtPnRpbl9vcmRlcltUQ19IX01JTihz
a2ItPnByaW9yaXR5KSAtIDFdOw0KIA0KIAllbHNlIHsNCiAJCWlmICghd2FzaCkNCiAJCQlkc2Nw
ID0gY2FrZV9oYW5kbGVfZGlmZnNlcnYoc2tiLCB3YXNoKTsNCi0JCXRpbiA9IHEtPnRpbl9pbmRl
eFtkc2NwXTsNCisJCXRpbiA9IHFkLT50aW5faW5kZXhbZHNjcF07DQogDQotCQlpZiAodW5saWtl
bHkodGluID49IHEtPnRpbl9jbnQpKQ0KKwkJaWYgKHVubGlrZWx5KHRpbiA+PSBxZC0+dGluX2Nu
dCkpDQogCQkJdGluID0gMDsNCiAJfQ0KIA0KLQlyZXR1cm4gJnEtPnRpbnNbdGluXTsNCisJcmV0
dXJuICZxZC0+dGluc1t0aW5dOw0KIH0NCiANCiBzdGF0aWMgdTMyIGNha2VfY2xhc3NpZnkoc3Ry
dWN0IFFkaXNjICpzY2gsIHN0cnVjdCBjYWtlX3Rpbl9kYXRhICoqdCwNCkBAIC0xNzQ3LDcgKzE3
NTIsNyBAQCBzdGF0aWMgczMyIGNha2VfZW5xdWV1ZShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1
Y3QgUWRpc2MgKnNjaCwNCiAJdTMyIGlkeCwgdGluOw0KIA0KIAkvKiBjaG9vc2UgZmxvdyB0byBp
bnNlcnQgaW50byAqLw0KLQlpZHggPSBjYWtlX2NsYXNzaWZ5KHNjaCwgJmIsIHNrYiwgcS0+Zmxv
d19tb2RlLCAmcmV0KTsNCisJaWR4ID0gY2FrZV9jbGFzc2lmeShzY2gsICZiLCBza2IsIHEtPmNv
bmZpZy0+Zmxvd19tb2RlLCAmcmV0KTsNCiAJaWYgKGlkeCA9PSAwKSB7DQogCQlpZiAocmV0ICYg
X19ORVRfWE1JVF9CWVBBU1MpDQogCQkJcWRpc2NfcXN0YXRzX2Ryb3Aoc2NoKTsNCkBAIC0xNzgy
LDcgKzE3ODcsNyBAQCBzdGF0aWMgczMyIGNha2VfZW5xdWV1ZShzdHJ1Y3Qgc2tfYnVmZiAqc2ti
LCBzdHJ1Y3QgUWRpc2MgKnNjaCwNCiAJaWYgKHVubGlrZWx5KGxlbiA+IGItPm1heF9za2JsZW4p
KQ0KIAkJYi0+bWF4X3NrYmxlbiA9IGxlbjsNCiANCi0JaWYgKHFkaXNjX3BrdF9zZWdzKHNrYikg
PiAxICYmIHEtPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdfU1BMSVRfR1NPKSB7DQorCWlmIChxZGlz
Y19wa3Rfc2Vncyhza2IpID4gMSAmJiBxLT5jb25maWctPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdf
U1BMSVRfR1NPKSB7DQogCQlzdHJ1Y3Qgc2tfYnVmZiAqc2VncywgKm5za2I7DQogCQluZXRkZXZf
ZmVhdHVyZXNfdCBmZWF0dXJlcyA9IG5ldGlmX3NrYl9mZWF0dXJlcyhza2IpOw0KIAkJdW5zaWdu
ZWQgaW50IHNsZW4gPSAwLCBudW1zZWdzID0gMDsNCkBAIC0xODIyLDcgKzE4MjcsNyBAQCBzdGF0
aWMgczMyIGNha2VfZW5xdWV1ZShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgUWRpc2MgKnNj
aCwNCiAJCWdldF9jb2JhbHRfY2Ioc2tiKS0+YWRqdXN0ZWRfbGVuID0gY2FrZV9vdmVyaGVhZChx
LCBza2IpOw0KIAkJZmxvd19xdWV1ZV9hZGQoZmxvdywgc2tiKTsNCiANCi0JCWlmIChxLT5hY2tf
ZmlsdGVyKQ0KKwkJaWYgKHEtPmNvbmZpZy0+YWNrX2ZpbHRlcikNCiAJCQlhY2sgPSBjYWtlX2Fj
a19maWx0ZXIocSwgZmxvdyk7DQogDQogCQlpZiAoYWNrKSB7DQpAQCAtMTgzMSw3ICsxODM2LDcg
QEAgc3RhdGljIHMzMiBjYWtlX2VucXVldWUoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IFFk
aXNjICpzY2gsDQogCQkJYi0+Ynl0ZXMgKz0gcWRpc2NfcGt0X2xlbihhY2spOw0KIAkJCWxlbiAt
PSBxZGlzY19wa3RfbGVuKGFjayk7DQogCQkJcS0+YnVmZmVyX3VzZWQgKz0gc2tiLT50cnVlc2l6
ZSAtIGFjay0+dHJ1ZXNpemU7DQotCQkJaWYgKHEtPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdfSU5H
UkVTUykNCisJCQlpZiAocS0+Y29uZmlnLT5yYXRlX2ZsYWdzICYgQ0FLRV9GTEFHX0lOR1JFU1Mp
DQogCQkJCWNha2VfYWR2YW5jZV9zaGFwZXIocSwgYiwgYWNrLCBub3csIHRydWUpOw0KIA0KIAkJ
CXFkaXNjX3RyZWVfcmVkdWNlX2JhY2tsb2coc2NoLCAxLCBxZGlzY19wa3RfbGVuKGFjaykpOw0K
QEAgLTE4NTQsNyArMTg1OSw3IEBAIHN0YXRpYyBzMzIgY2FrZV9lbnF1ZXVlKHN0cnVjdCBza19i
dWZmICpza2IsIHN0cnVjdCBRZGlzYyAqc2NoLA0KIAkJY2FrZV9oZWFwaWZ5X3VwKHEsIGItPm92
ZXJmbG93X2lkeFtpZHhdKTsNCiANCiAJLyogaW5jb21pbmcgYmFuZHdpZHRoIGNhcGFjaXR5IGVz
dGltYXRlICovDQotCWlmIChxLT5yYXRlX2ZsYWdzICYgQ0FLRV9GTEFHX0FVVE9SQVRFX0lOR1JF
U1MpIHsNCisJaWYgKHEtPmNvbmZpZy0+cmF0ZV9mbGFncyAmIENBS0VfRkxBR19BVVRPUkFURV9J
TkdSRVNTKSB7DQogCQl1NjQgcGFja2V0X2ludGVydmFsID0gXA0KIAkJCWt0aW1lX3RvX25zKGt0
aW1lX3N1Yihub3csIHEtPmxhc3RfcGFja2V0X3RpbWUpKTsNCiANCkBAIC0xODg2LDcgKzE4OTEs
NyBAQCBzdGF0aWMgczMyIGNha2VfZW5xdWV1ZShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3Qg
UWRpc2MgKnNjaCwNCiAJCQlpZiAoa3RpbWVfYWZ0ZXIobm93LA0KIAkJCQkJa3RpbWVfYWRkX21z
KHEtPmxhc3RfcmVjb25maWdfdGltZSwNCiAJCQkJCQkgICAgIDI1MCkpKSB7DQotCQkJCXEtPnJh
dGVfYnBzID0gKHEtPmF2Z19wZWFrX2JhbmR3aWR0aCAqIDE1KSA+PiA0Ow0KKwkJCQlxLT5jb25m
aWctPnJhdGVfYnBzID0gKHEtPmF2Z19wZWFrX2JhbmR3aWR0aCAqIDE1KSA+PiA0Ow0KIAkJCQlj
YWtlX3JlY29uZmlndXJlKHNjaCk7DQogCQkJfQ0KIAkJfQ0KQEAgLTE5MDYsNyArMTkxMSw3IEBA
IHN0YXRpYyBzMzIgY2FrZV9lbnF1ZXVlKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBRZGlz
YyAqc2NoLA0KIAkJZmxvdy0+c2V0ID0gQ0FLRV9TRVRfU1BBUlNFOw0KIAkJYi0+c3BhcnNlX2Zs
b3dfY291bnQrKzsNCiANCi0JCWZsb3ctPmRlZmljaXQgPSBjYWtlX2dldF9mbG93X3F1YW50dW0o
YiwgZmxvdywgcS0+Zmxvd19tb2RlKTsNCisJCWZsb3ctPmRlZmljaXQgPSBjYWtlX2dldF9mbG93
X3F1YW50dW0oYiwgZmxvdywgcS0+Y29uZmlnLT5mbG93X21vZGUpOw0KIAl9IGVsc2UgaWYgKGZs
b3ctPnNldCA9PSBDQUtFX1NFVF9TUEFSU0VfV0FJVCkgew0KIAkJLyogdGhpcyBmbG93IHdhcyBl
bXB0eSwgYWNjb3VudGVkIGFzIGEgc3BhcnNlIGZsb3csIGJ1dCBhY3R1YWxseQ0KIAkJICogaW4g
dGhlIGJ1bGsgcm90YXRpb24uDQpAQCAtMTkxNSw4ICsxOTIwLDggQEAgc3RhdGljIHMzMiBjYWtl
X2VucXVldWUoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IFFkaXNjICpzY2gsDQogCQliLT5z
cGFyc2VfZmxvd19jb3VudC0tOw0KIAkJYi0+YnVsa19mbG93X2NvdW50Kys7DQogDQotCQljYWtl
X2luY19zcmNob3N0X2J1bGtfZmxvd19jb3VudChiLCBmbG93LCBxLT5mbG93X21vZGUpOw0KLQkJ
Y2FrZV9pbmNfZHN0aG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Zmxvd19tb2RlKTsN
CisJCWNha2VfaW5jX3NyY2hvc3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3csIHEtPmNvbmZpZy0+
Zmxvd19tb2RlKTsNCisJCWNha2VfaW5jX2RzdGhvc3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3cs
IHEtPmNvbmZpZy0+Zmxvd19tb2RlKTsNCiAJfQ0KIA0KIAlpZiAocS0+YnVmZmVyX3VzZWQgPiBx
LT5idWZmZXJfbWF4X3VzZWQpDQpAQCAtMjA5OCw4ICsyMTAzLDggQEAgc3RhdGljIHN0cnVjdCBz
a19idWZmICpjYWtlX2RlcXVldWUoc3RydWN0IFFkaXNjICpzY2gpDQogCQkJCWItPnNwYXJzZV9m
bG93X2NvdW50LS07DQogCQkJCWItPmJ1bGtfZmxvd19jb3VudCsrOw0KIA0KLQkJCQljYWtlX2lu
Y19zcmNob3N0X2J1bGtfZmxvd19jb3VudChiLCBmbG93LCBxLT5mbG93X21vZGUpOw0KLQkJCQlj
YWtlX2luY19kc3Rob3N0X2J1bGtfZmxvd19jb3VudChiLCBmbG93LCBxLT5mbG93X21vZGUpOw0K
KwkJCQljYWtlX2luY19zcmNob3N0X2J1bGtfZmxvd19jb3VudChiLCBmbG93LCBxLT5jb25maWct
PmZsb3dfbW9kZSk7DQorCQkJCWNha2VfaW5jX2RzdGhvc3RfYnVsa19mbG93X2NvdW50KGIsIGZs
b3csIHEtPmNvbmZpZy0+Zmxvd19tb2RlKTsNCiANCiAJCQkJZmxvdy0+c2V0ID0gQ0FLRV9TRVRf
QlVMSzsNCiAJCQl9IGVsc2Ugew0KQEAgLTIxMTEsNyArMjExNiw3IEBAIHN0YXRpYyBzdHJ1Y3Qg
c2tfYnVmZiAqY2FrZV9kZXF1ZXVlKHN0cnVjdCBRZGlzYyAqc2NoKQ0KIAkJCX0NCiAJCX0NCiAN
Ci0JCWZsb3ctPmRlZmljaXQgKz0gY2FrZV9nZXRfZmxvd19xdWFudHVtKGIsIGZsb3csIHEtPmZs
b3dfbW9kZSk7DQorCQlmbG93LT5kZWZpY2l0ICs9IGNha2VfZ2V0X2Zsb3dfcXVhbnR1bShiLCBm
bG93LCBxLT5jb25maWctPmZsb3dfbW9kZSk7DQogCQlsaXN0X21vdmVfdGFpbCgmZmxvdy0+Zmxv
d2NoYWluLCAmYi0+b2xkX2Zsb3dzKTsNCiANCiAJCWdvdG8gcmV0cnk7DQpAQCAtMjEzNSw4ICsy
MTQwLDggQEAgc3RhdGljIHN0cnVjdCBza19idWZmICpjYWtlX2RlcXVldWUoc3RydWN0IFFkaXNj
ICpzY2gpDQogCQkJCWlmIChmbG93LT5zZXQgPT0gQ0FLRV9TRVRfQlVMSykgew0KIAkJCQkJYi0+
YnVsa19mbG93X2NvdW50LS07DQogDQotCQkJCQljYWtlX2RlY19zcmNob3N0X2J1bGtfZmxvd19j
b3VudChiLCBmbG93LCBxLT5mbG93X21vZGUpOw0KLQkJCQkJY2FrZV9kZWNfZHN0aG9zdF9idWxr
X2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Zmxvd19tb2RlKTsNCisJCQkJCWNha2VfZGVjX3NyY2hv
c3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3csIHEtPmNvbmZpZy0+Zmxvd19tb2RlKTsNCisJCQkJ
CWNha2VfZGVjX2RzdGhvc3RfYnVsa19mbG93X2NvdW50KGIsIGZsb3csIHEtPmNvbmZpZy0+Zmxv
d19tb2RlKTsNCiANCiAJCQkJCWItPmRlY2F5aW5nX2Zsb3dfY291bnQrKzsNCiAJCQkJfSBlbHNl
IGlmIChmbG93LT5zZXQgPT0gQ0FLRV9TRVRfU1BBUlNFIHx8DQpAQCAtMjE1NCw4ICsyMTU5LDgg
QEAgc3RhdGljIHN0cnVjdCBza19idWZmICpjYWtlX2RlcXVldWUoc3RydWN0IFFkaXNjICpzY2gp
DQogCQkJCWVsc2UgaWYgKGZsb3ctPnNldCA9PSBDQUtFX1NFVF9CVUxLKSB7DQogCQkJCQliLT5i
dWxrX2Zsb3dfY291bnQtLTsNCiANCi0JCQkJCWNha2VfZGVjX3NyY2hvc3RfYnVsa19mbG93X2Nv
dW50KGIsIGZsb3csIHEtPmZsb3dfbW9kZSk7DQotCQkJCQljYWtlX2RlY19kc3Rob3N0X2J1bGtf
Zmxvd19jb3VudChiLCBmbG93LCBxLT5mbG93X21vZGUpOw0KKwkJCQkJY2FrZV9kZWNfc3JjaG9z
dF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Y29uZmlnLT5mbG93X21vZGUpOw0KKwkJCQkJ
Y2FrZV9kZWNfZHN0aG9zdF9idWxrX2Zsb3dfY291bnQoYiwgZmxvdywgcS0+Y29uZmlnLT5mbG93
X21vZGUpOw0KIAkJCQl9IGVsc2UNCiAJCQkJCWItPmRlY2F5aW5nX2Zsb3dfY291bnQtLTsNCiAN
CkBAIC0yMTY2LDE0ICsyMTcxLDE0IEBAIHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqY2FrZV9kZXF1
ZXVlKHN0cnVjdCBRZGlzYyAqc2NoKQ0KIA0KIAkJcmVhc29uID0gY29iYWx0X3Nob3VsZF9kcm9w
KCZmbG93LT5jdmFycywgJmItPmNwYXJhbXMsIG5vdywgc2tiLA0KIAkJCQkJICAgIChiLT5idWxr
X2Zsb3dfY291bnQgKg0KLQkJCQkJICAgICAhIShxLT5yYXRlX2ZsYWdzICYNCisJCQkJCSAgICAg
ISEocS0+Y29uZmlnLT5yYXRlX2ZsYWdzICYNCiAJCQkJCQlDQUtFX0ZMQUdfSU5HUkVTUykpKTsN
CiAJCS8qIExhc3QgcGFja2V0IGluIHF1ZXVlIG1heSBiZSBtYXJrZWQsIHNob3VsZG4ndCBiZSBk
cm9wcGVkICovDQogCQlpZiAocmVhc29uID09IFNLQl9OT1RfRFJPUFBFRF9ZRVQgfHwgIWZsb3ct
PmhlYWQpDQogCQkJYnJlYWs7DQogDQogCQkvKiBkcm9wIHRoaXMgcGFja2V0LCBnZXQgYW5vdGhl
ciBvbmUgKi8NCi0JCWlmIChxLT5yYXRlX2ZsYWdzICYgQ0FLRV9GTEFHX0lOR1JFU1MpIHsNCisJ
CWlmIChxLT5jb25maWctPnJhdGVfZmxhZ3MgJiBDQUtFX0ZMQUdfSU5HUkVTUykgew0KIAkJCWxl
biA9IGNha2VfYWR2YW5jZV9zaGFwZXIocSwgYiwgc2tiLA0KIAkJCQkJCSAgbm93LCB0cnVlKTsN
CiAJCQlmbG93LT5kZWZpY2l0IC09IGxlbjsNCkBAIC0yMTg0LDcgKzIxODksNyBAQCBzdGF0aWMg
c3RydWN0IHNrX2J1ZmYgKmNha2VfZGVxdWV1ZShzdHJ1Y3QgUWRpc2MgKnNjaCkNCiAJCXFkaXNj
X3RyZWVfcmVkdWNlX2JhY2tsb2coc2NoLCAxLCBxZGlzY19wa3RfbGVuKHNrYikpOw0KIAkJcWRp
c2NfcXN0YXRzX2Ryb3Aoc2NoKTsNCiAJCXFkaXNjX2RlcXVldWVfZHJvcChzY2gsIHNrYiwgcmVh
c29uKTsNCi0JCWlmIChxLT5yYXRlX2ZsYWdzICYgQ0FLRV9GTEFHX0lOR1JFU1MpDQorCQlpZiAo
cS0+Y29uZmlnLT5yYXRlX2ZsYWdzICYgQ0FLRV9GTEFHX0lOR1JFU1MpDQogCQkJZ290byByZXRy
eTsNCiAJfQ0KIA0KQEAgLTIzMDYsNyArMjMxMSw3IEBAIHN0YXRpYyBpbnQgY2FrZV9jb25maWdf
YmVzdGVmZm9ydChzdHJ1Y3QgUWRpc2MgKnNjaCkNCiAJc3RydWN0IGNha2Vfc2NoZWRfZGF0YSAq
cSA9IHFkaXNjX3ByaXYoc2NoKTsNCiAJc3RydWN0IGNha2VfdGluX2RhdGEgKmIgPSAmcS0+dGlu
c1swXTsNCiAJdTMyIG10dSA9IHBzY2hlZF9tdHUocWRpc2NfZGV2KHNjaCkpOw0KLQl1NjQgcmF0
ZSA9IHEtPnJhdGVfYnBzOw0KKwl1NjQgcmF0ZSA9IHEtPmNvbmZpZy0+cmF0ZV9icHM7DQogDQog
CXEtPnRpbl9jbnQgPSAxOw0KIA0KQEAgLTIzMTQsNyArMjMxOSw3IEBAIHN0YXRpYyBpbnQgY2Fr
ZV9jb25maWdfYmVzdGVmZm9ydChzdHJ1Y3QgUWRpc2MgKnNjaCkNCiAJcS0+dGluX29yZGVyID0g
bm9ybWFsX29yZGVyOw0KIA0KIAljYWtlX3NldF9yYXRlKGIsIHJhdGUsIG10dSwNCi0JCSAgICAg
IHVzX3RvX25zKHEtPnRhcmdldCksIHVzX3RvX25zKHEtPmludGVydmFsKSk7DQorCQkgICAgICB1
c190b19ucyhxLT5jb25maWctPnRhcmdldCksIHVzX3RvX25zKHEtPmNvbmZpZy0+aW50ZXJ2YWwp
KTsNCiAJYi0+dGluX3F1YW50dW0gPSA2NTUzNTsNCiANCiAJcmV0dXJuIDA7DQpAQCAtMjMyNSw3
ICsyMzMwLDcgQEAgc3RhdGljIGludCBjYWtlX2NvbmZpZ19wcmVjZWRlbmNlKHN0cnVjdCBRZGlz
YyAqc2NoKQ0KIAkvKiBjb252ZXJ0IGhpZ2gtbGV2ZWwgKHVzZXIgdmlzaWJsZSkgcGFyYW1ldGVy
cyBpbnRvIGludGVybmFsIGZvcm1hdCAqLw0KIAlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxID0g
cWRpc2NfcHJpdihzY2gpOw0KIAl1MzIgbXR1ID0gcHNjaGVkX210dShxZGlzY19kZXYoc2NoKSk7
DQotCXU2NCByYXRlID0gcS0+cmF0ZV9icHM7DQorCXU2NCByYXRlID0gcS0+Y29uZmlnLT5yYXRl
X2JwczsNCiAJdTMyIHF1YW50dW0gPSAyNTY7DQogCXUzMiBpOw0KIA0KQEAgLTIzMzYsOCArMjM0
MSw4IEBAIHN0YXRpYyBpbnQgY2FrZV9jb25maWdfcHJlY2VkZW5jZShzdHJ1Y3QgUWRpc2MgKnNj
aCkNCiAJZm9yIChpID0gMDsgaSA8IHEtPnRpbl9jbnQ7IGkrKykgew0KIAkJc3RydWN0IGNha2Vf
dGluX2RhdGEgKmIgPSAmcS0+dGluc1tpXTsNCiANCi0JCWNha2Vfc2V0X3JhdGUoYiwgcmF0ZSwg
bXR1LCB1c190b19ucyhxLT50YXJnZXQpLA0KLQkJCSAgICAgIHVzX3RvX25zKHEtPmludGVydmFs
KSk7DQorCQljYWtlX3NldF9yYXRlKGIsIHJhdGUsIG10dSwgdXNfdG9fbnMocS0+Y29uZmlnLT50
YXJnZXQpLA0KKwkJCSAgICAgIHVzX3RvX25zKHEtPmNvbmZpZy0+aW50ZXJ2YWwpKTsNCiANCiAJ
CWItPnRpbl9xdWFudHVtID0gbWF4X3QodTE2LCAxVSwgcXVhbnR1bSk7DQogDQpAQCAtMjQxNCw3
ICsyNDE5LDcgQEAgc3RhdGljIGludCBjYWtlX2NvbmZpZ19kaWZmc2Vydjgoc3RydWN0IFFkaXNj
ICpzY2gpDQogDQogCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7
DQogCXUzMiBtdHUgPSBwc2NoZWRfbXR1KHFkaXNjX2RldihzY2gpKTsNCi0JdTY0IHJhdGUgPSBx
LT5yYXRlX2JwczsNCisJdTY0IHJhdGUgPSBxLT5jb25maWctPnJhdGVfYnBzOw0KIAl1MzIgcXVh
bnR1bSA9IDI1NjsNCiAJdTMyIGk7DQogDQpAQCAtMjQyOCw4ICsyNDMzLDggQEAgc3RhdGljIGlu
dCBjYWtlX2NvbmZpZ19kaWZmc2Vydjgoc3RydWN0IFFkaXNjICpzY2gpDQogCWZvciAoaSA9IDA7
IGkgPCBxLT50aW5fY250OyBpKyspIHsNCiAJCXN0cnVjdCBjYWtlX3Rpbl9kYXRhICpiID0gJnEt
PnRpbnNbaV07DQogDQotCQljYWtlX3NldF9yYXRlKGIsIHJhdGUsIG10dSwgdXNfdG9fbnMocS0+
dGFyZ2V0KSwNCi0JCQkgICAgICB1c190b19ucyhxLT5pbnRlcnZhbCkpOw0KKwkJY2FrZV9zZXRf
cmF0ZShiLCByYXRlLCBtdHUsIHVzX3RvX25zKHEtPmNvbmZpZy0+dGFyZ2V0KSwNCisJCQkgICAg
ICB1c190b19ucyhxLT5jb25maWctPmludGVydmFsKSk7DQogDQogCQliLT50aW5fcXVhbnR1bSA9
IG1heF90KHUxNiwgMVUsIHF1YW50dW0pOw0KIA0KQEAgLTI0NTgsNyArMjQ2Myw3IEBAIHN0YXRp
YyBpbnQgY2FrZV9jb25maWdfZGlmZnNlcnY0KHN0cnVjdCBRZGlzYyAqc2NoKQ0KIA0KIAlzdHJ1
Y3QgY2FrZV9zY2hlZF9kYXRhICpxID0gcWRpc2NfcHJpdihzY2gpOw0KIAl1MzIgbXR1ID0gcHNj
aGVkX210dShxZGlzY19kZXYoc2NoKSk7DQotCXU2NCByYXRlID0gcS0+cmF0ZV9icHM7DQorCXU2
NCByYXRlID0gcS0+Y29uZmlnLT5yYXRlX2JwczsNCiAJdTMyIHF1YW50dW0gPSAxMDI0Ow0KIA0K
IAlxLT50aW5fY250ID0gNDsNCkBAIC0yNDY5LDEzICsyNDc0LDEzIEBAIHN0YXRpYyBpbnQgY2Fr
ZV9jb25maWdfZGlmZnNlcnY0KHN0cnVjdCBRZGlzYyAqc2NoKQ0KIA0KIAkvKiBjbGFzcyBjaGFy
YWN0ZXJpc3RpY3MgKi8NCiAJY2FrZV9zZXRfcmF0ZSgmcS0+dGluc1swXSwgcmF0ZSwgbXR1LA0K
LQkJICAgICAgdXNfdG9fbnMocS0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+aW50ZXJ2YWwpKTsNCisJ
CSAgICAgIHVzX3RvX25zKHEtPmNvbmZpZy0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+Y29uZmlnLT5p
bnRlcnZhbCkpOw0KIAljYWtlX3NldF9yYXRlKCZxLT50aW5zWzFdLCByYXRlID4+IDQsIG10dSwN
Ci0JCSAgICAgIHVzX3RvX25zKHEtPnRhcmdldCksIHVzX3RvX25zKHEtPmludGVydmFsKSk7DQor
CQkgICAgICB1c190b19ucyhxLT5jb25maWctPnRhcmdldCksIHVzX3RvX25zKHEtPmNvbmZpZy0+
aW50ZXJ2YWwpKTsNCiAJY2FrZV9zZXRfcmF0ZSgmcS0+dGluc1syXSwgcmF0ZSA+PiAxLCBtdHUs
DQotCQkgICAgICB1c190b19ucyhxLT50YXJnZXQpLCB1c190b19ucyhxLT5pbnRlcnZhbCkpOw0K
KwkJICAgICAgdXNfdG9fbnMocS0+Y29uZmlnLT50YXJnZXQpLCB1c190b19ucyhxLT5jb25maWct
PmludGVydmFsKSk7DQogCWNha2Vfc2V0X3JhdGUoJnEtPnRpbnNbM10sIHJhdGUgPj4gMiwgbXR1
LA0KLQkJICAgICAgdXNfdG9fbnMocS0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+aW50ZXJ2YWwpKTsN
CisJCSAgICAgIHVzX3RvX25zKHEtPmNvbmZpZy0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+Y29uZmln
LT5pbnRlcnZhbCkpOw0KIA0KIAkvKiBiYW5kd2lkdGgtc2hhcmluZyB3ZWlnaHRzICovDQogCXEt
PnRpbnNbMF0udGluX3F1YW50dW0gPSBxdWFudHVtOw0KQEAgLTI0OTUsNyArMjUwMCw3IEBAIHN0
YXRpYyBpbnQgY2FrZV9jb25maWdfZGlmZnNlcnYzKHN0cnVjdCBRZGlzYyAqc2NoKQ0KICAqLw0K
IAlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxID0gcWRpc2NfcHJpdihzY2gpOw0KIAl1MzIgbXR1
ID0gcHNjaGVkX210dShxZGlzY19kZXYoc2NoKSk7DQotCXU2NCByYXRlID0gcS0+cmF0ZV9icHM7
DQorCXU2NCByYXRlID0gcS0+Y29uZmlnLT5yYXRlX2JwczsNCiAJdTMyIHF1YW50dW0gPSAxMDI0
Ow0KIA0KIAlxLT50aW5fY250ID0gMzsNCkBAIC0yNTA2LDExICsyNTExLDExIEBAIHN0YXRpYyBp
bnQgY2FrZV9jb25maWdfZGlmZnNlcnYzKHN0cnVjdCBRZGlzYyAqc2NoKQ0KIA0KIAkvKiBjbGFz
cyBjaGFyYWN0ZXJpc3RpY3MgKi8NCiAJY2FrZV9zZXRfcmF0ZSgmcS0+dGluc1swXSwgcmF0ZSwg
bXR1LA0KLQkJICAgICAgdXNfdG9fbnMocS0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+aW50ZXJ2YWwp
KTsNCisJCSAgICAgIHVzX3RvX25zKHEtPmNvbmZpZy0+dGFyZ2V0KSwgdXNfdG9fbnMocS0+Y29u
ZmlnLT5pbnRlcnZhbCkpOw0KIAljYWtlX3NldF9yYXRlKCZxLT50aW5zWzFdLCByYXRlID4+IDQs
IG10dSwNCi0JCSAgICAgIHVzX3RvX25zKHEtPnRhcmdldCksIHVzX3RvX25zKHEtPmludGVydmFs
KSk7DQorCQkgICAgICB1c190b19ucyhxLT5jb25maWctPnRhcmdldCksIHVzX3RvX25zKHEtPmNv
bmZpZy0+aW50ZXJ2YWwpKTsNCiAJY2FrZV9zZXRfcmF0ZSgmcS0+dGluc1syXSwgcmF0ZSA+PiAy
LCBtdHUsDQotCQkgICAgICB1c190b19ucyhxLT50YXJnZXQpLCB1c190b19ucyhxLT5pbnRlcnZh
bCkpOw0KKwkJICAgICAgdXNfdG9fbnMocS0+Y29uZmlnLT50YXJnZXQpLCB1c190b19ucyhxLT5j
b25maWctPmludGVydmFsKSk7DQogDQogCS8qIGJhbmR3aWR0aC1zaGFyaW5nIHdlaWdodHMgKi8N
CiAJcS0+dGluc1swXS50aW5fcXVhbnR1bSA9IHF1YW50dW07DQpAQCAtMjUyMiw3ICsyNTI3LDgg
QEAgc3RhdGljIGludCBjYWtlX2NvbmZpZ19kaWZmc2VydjMoc3RydWN0IFFkaXNjICpzY2gpDQog
DQogc3RhdGljIHZvaWQgY2FrZV9yZWNvbmZpZ3VyZShzdHJ1Y3QgUWRpc2MgKnNjaCkNCiB7DQot
CXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7DQorCXN0cnVjdCBj
YWtlX3NjaGVkX2RhdGEgKnFkID0gcWRpc2NfcHJpdihzY2gpOw0KKwlzdHJ1Y3QgY2FrZV9zY2hl
ZF9jb25maWcgKnEgPSBxZC0+Y29uZmlnOw0KIAlpbnQgYywgZnQ7DQogDQogCXN3aXRjaCAocS0+
dGluX21vZGUpIHsNCkBAIC0yNTQ4LDM2ICsyNTU0LDM3IEBAIHN0YXRpYyB2b2lkIGNha2VfcmVj
b25maWd1cmUoc3RydWN0IFFkaXNjICpzY2gpDQogCQlicmVhazsNCiAJfQ0KIA0KLQlmb3IgKGMg
PSBxLT50aW5fY250OyBjIDwgQ0FLRV9NQVhfVElOUzsgYysrKSB7DQorCWZvciAoYyA9IHFkLT50
aW5fY250OyBjIDwgQ0FLRV9NQVhfVElOUzsgYysrKSB7DQogCQljYWtlX2NsZWFyX3RpbihzY2gs
IGMpOw0KLQkJcS0+dGluc1tjXS5jcGFyYW1zLm10dV90aW1lID0gcS0+dGluc1tmdF0uY3BhcmFt
cy5tdHVfdGltZTsNCisJCXFkLT50aW5zW2NdLmNwYXJhbXMubXR1X3RpbWUgPSBxZC0+dGluc1tm
dF0uY3BhcmFtcy5tdHVfdGltZTsNCiAJfQ0KIA0KLQlxLT5yYXRlX25zICAgPSBxLT50aW5zW2Z0
XS50aW5fcmF0ZV9uczsNCi0JcS0+cmF0ZV9zaGZ0ID0gcS0+dGluc1tmdF0udGluX3JhdGVfc2hm
dDsNCisJcWQtPnJhdGVfbnMgICA9IHFkLT50aW5zW2Z0XS50aW5fcmF0ZV9uczsNCisJcWQtPnJh
dGVfc2hmdCA9IHFkLT50aW5zW2Z0XS50aW5fcmF0ZV9zaGZ0Ow0KIA0KIAlpZiAocS0+YnVmZmVy
X2NvbmZpZ19saW1pdCkgew0KLQkJcS0+YnVmZmVyX2xpbWl0ID0gcS0+YnVmZmVyX2NvbmZpZ19s
aW1pdDsNCisJCXFkLT5idWZmZXJfbGltaXQgPSBxLT5idWZmZXJfY29uZmlnX2xpbWl0Ow0KIAl9
IGVsc2UgaWYgKHEtPnJhdGVfYnBzKSB7DQogCQl1NjQgdCA9IHEtPnJhdGVfYnBzICogcS0+aW50
ZXJ2YWw7DQogDQogCQlkb19kaXYodCwgVVNFQ19QRVJfU0VDIC8gNCk7DQotCQlxLT5idWZmZXJf
bGltaXQgPSBtYXhfdCh1MzIsIHQsIDRVIDw8IDIwKTsNCisJCXFkLT5idWZmZXJfbGltaXQgPSBt
YXhfdCh1MzIsIHQsIDRVIDw8IDIwKTsNCiAJfSBlbHNlIHsNCi0JCXEtPmJ1ZmZlcl9saW1pdCA9
IH4wOw0KKwkJcWQtPmJ1ZmZlcl9saW1pdCA9IH4wOw0KIAl9DQogDQogCXNjaC0+ZmxhZ3MgJj0g
flRDUV9GX0NBTl9CWVBBU1M7DQogDQotCXEtPmJ1ZmZlcl9saW1pdCA9IG1pbihxLT5idWZmZXJf
bGltaXQsDQotCQkJICAgICAgbWF4KHNjaC0+bGltaXQgKiBwc2NoZWRfbXR1KHFkaXNjX2Rldihz
Y2gpKSwNCi0JCQkJICBxLT5idWZmZXJfY29uZmlnX2xpbWl0KSk7DQorCXFkLT5idWZmZXJfbGlt
aXQgPSBtaW4ocWQtPmJ1ZmZlcl9saW1pdCwNCisJCQkgICAgICAgbWF4KHNjaC0+bGltaXQgKiBw
c2NoZWRfbXR1KHFkaXNjX2RldihzY2gpKSwNCisJCQkJICAgcS0+YnVmZmVyX2NvbmZpZ19saW1p
dCkpOw0KIH0NCiANCiBzdGF0aWMgaW50IGNha2VfY2hhbmdlKHN0cnVjdCBRZGlzYyAqc2NoLCBz
dHJ1Y3QgbmxhdHRyICpvcHQsDQogCQkgICAgICAgc3RydWN0IG5ldGxpbmtfZXh0X2FjayAqZXh0
YWNrKQ0KIHsNCi0Jc3RydWN0IGNha2Vfc2NoZWRfZGF0YSAqcSA9IHFkaXNjX3ByaXYoc2NoKTsN
CisJc3RydWN0IGNha2Vfc2NoZWRfZGF0YSAqcWQgPSBxZGlzY19wcml2KHNjaCk7DQorCXN0cnVj
dCBjYWtlX3NjaGVkX2NvbmZpZyAqcSA9IHFkLT5jb25maWc7DQogCXN0cnVjdCBubGF0dHIgKnRi
W1RDQV9DQUtFX01BWCArIDFdOw0KIAl1MTYgcmF0ZV9mbGFnczsNCiAJdTggZmxvd19tb2RlOw0K
QEAgLTI2MzEsMTkgKzI2MzgsMTkgQEAgc3RhdGljIGludCBjYWtlX2NoYW5nZShzdHJ1Y3QgUWRp
c2MgKnNjaCwgc3RydWN0IG5sYXR0ciAqb3B0LA0KIAkJCSAgIG5sYV9nZXRfczMyKHRiW1RDQV9D
QUtFX09WRVJIRUFEXSkpOw0KIAkJcmF0ZV9mbGFncyB8PSBDQUtFX0ZMQUdfT1ZFUkhFQUQ7DQog
DQotCQlxLT5tYXhfbmV0bGVuID0gMDsNCi0JCXEtPm1heF9hZGpsZW4gPSAwOw0KLQkJcS0+bWlu
X25ldGxlbiA9IH4wOw0KLQkJcS0+bWluX2FkamxlbiA9IH4wOw0KKwkJcWQtPm1heF9uZXRsZW4g
PSAwOw0KKwkJcWQtPm1heF9hZGpsZW4gPSAwOw0KKwkJcWQtPm1pbl9uZXRsZW4gPSB+MDsNCisJ
CXFkLT5taW5fYWRqbGVuID0gfjA7DQogCX0NCiANCiAJaWYgKHRiW1RDQV9DQUtFX1JBV10pIHsN
CiAJCXJhdGVfZmxhZ3MgJj0gfkNBS0VfRkxBR19PVkVSSEVBRDsNCiANCi0JCXEtPm1heF9uZXRs
ZW4gPSAwOw0KLQkJcS0+bWF4X2FkamxlbiA9IDA7DQotCQlxLT5taW5fbmV0bGVuID0gfjA7DQot
CQlxLT5taW5fYWRqbGVuID0gfjA7DQorCQlxZC0+bWF4X25ldGxlbiA9IDA7DQorCQlxZC0+bWF4
X2FkamxlbiA9IDA7DQorCQlxZC0+bWluX25ldGxlbiA9IH4wOw0KKwkJcWQtPm1pbl9hZGpsZW4g
PSB+MDsNCiAJfQ0KIA0KIAlpZiAodGJbVENBX0NBS0VfTVBVXSkNCkBAIC0yNjk5LDcgKzI3MDYs
NyBAQCBzdGF0aWMgaW50IGNha2VfY2hhbmdlKHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3Qgbmxh
dHRyICpvcHQsDQogDQogCVdSSVRFX09OQ0UocS0+cmF0ZV9mbGFncywgcmF0ZV9mbGFncyk7DQog
CVdSSVRFX09OQ0UocS0+Zmxvd19tb2RlLCBmbG93X21vZGUpOw0KLQlpZiAocS0+dGlucykgew0K
KwlpZiAocWQtPnRpbnMpIHsNCiAJCXNjaF90cmVlX2xvY2soc2NoKTsNCiAJCWNha2VfcmVjb25m
aWd1cmUoc2NoKTsNCiAJCXNjaF90cmVlX3VubG9jayhzY2gpOw0KQEAgLTI3MTUsMTQgKzI3MjIs
MjAgQEAgc3RhdGljIHZvaWQgY2FrZV9kZXN0cm95KHN0cnVjdCBRZGlzYyAqc2NoKQ0KIAlxZGlz
Y193YXRjaGRvZ19jYW5jZWwoJnEtPndhdGNoZG9nKTsNCiAJdGNmX2Jsb2NrX3B1dChxLT5ibG9j
ayk7DQogCWt2ZnJlZShxLT50aW5zKTsNCisJa3ZmcmVlKHEtPmNvbmZpZyk7DQogfQ0KIA0KIHN0
YXRpYyBpbnQgY2FrZV9pbml0KHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQs
DQogCQkgICAgIHN0cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaykNCiB7DQotCXN0cnVjdCBj
YWtlX3NjaGVkX2RhdGEgKnEgPSBxZGlzY19wcml2KHNjaCk7DQorCXN0cnVjdCBjYWtlX3NjaGVk
X2RhdGEgKnFkID0gcWRpc2NfcHJpdihzY2gpOw0KKwlzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcg
KnE7DQogCWludCBpLCBqLCBlcnI7DQogDQorCXEgPSBrdmNhbGxvYygxLCBzaXplb2Yoc3RydWN0
IGNha2Vfc2NoZWRfY29uZmlnKSwgR0ZQX0tFUk5FTCk7DQorCWlmICghcSkNCisJCXJldHVybiAt
RU5PTUVNOw0KKw0KIAlzY2gtPmxpbWl0ID0gMTAyNDA7DQogCXNjaC0+ZmxhZ3MgfD0gVENRX0Zf
REVRVUVVRV9EUk9QUzsNCiANCkBAIC0yNzM2LDMzICsyNzQ5LDM2IEBAIHN0YXRpYyBpbnQgY2Fr
ZV9pbml0KHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQogCQkJICAgICAg
ICogZm9yIDUgdG8gMTAlIG9mIGludGVydmFsDQogCQkJICAgICAgICovDQogCXEtPnJhdGVfZmxh
Z3MgfD0gQ0FLRV9GTEFHX1NQTElUX0dTTzsNCi0JcS0+Y3VyX3RpbiA9IDA7DQotCXEtPmN1cl9m
bG93ICA9IDA7DQorCXFkLT5jdXJfdGluID0gMDsNCisJcWQtPmN1cl9mbG93ICA9IDA7DQorCXFk
LT5jb25maWcgPSBxOw0KIA0KLQlxZGlzY193YXRjaGRvZ19pbml0KCZxLT53YXRjaGRvZywgc2No
KTsNCisJcWRpc2Nfd2F0Y2hkb2dfaW5pdCgmcWQtPndhdGNoZG9nLCBzY2gpOw0KIA0KIAlpZiAo
b3B0KSB7DQogCQllcnIgPSBjYWtlX2NoYW5nZShzY2gsIG9wdCwgZXh0YWNrKTsNCiANCiAJCWlm
IChlcnIpDQotCQkJcmV0dXJuIGVycjsNCisJCQlnb3RvIGVycjsNCiAJfQ0KIA0KLQllcnIgPSB0
Y2ZfYmxvY2tfZ2V0KCZxLT5ibG9jaywgJnEtPmZpbHRlcl9saXN0LCBzY2gsIGV4dGFjayk7DQor
CWVyciA9IHRjZl9ibG9ja19nZXQoJnFkLT5ibG9jaywgJnFkLT5maWx0ZXJfbGlzdCwgc2NoLCBl
eHRhY2spOw0KIAlpZiAoZXJyKQ0KLQkJcmV0dXJuIGVycjsNCisJCWdvdG8gZXJyOw0KIA0KIAlx
dWFudHVtX2RpdlswXSA9IH4wOw0KIAlmb3IgKGkgPSAxOyBpIDw9IENBS0VfUVVFVUVTOyBpKysp
DQogCQlxdWFudHVtX2RpdltpXSA9IDY1NTM1IC8gaTsNCiANCi0JcS0+dGlucyA9IGt2Y2FsbG9j
KENBS0VfTUFYX1RJTlMsIHNpemVvZihzdHJ1Y3QgY2FrZV90aW5fZGF0YSksDQotCQkJICAgR0ZQ
X0tFUk5FTCk7DQotCWlmICghcS0+dGlucykNCi0JCXJldHVybiAtRU5PTUVNOw0KKwlxZC0+dGlu
cyA9IGt2Y2FsbG9jKENBS0VfTUFYX1RJTlMsIHNpemVvZihzdHJ1Y3QgY2FrZV90aW5fZGF0YSks
DQorCQkJICAgIEdGUF9LRVJORUwpOw0KKwlpZiAoIXFkLT50aW5zKSB7DQorCQllcnIgPSAtRU5P
TUVNOw0KKwkJZ290byBlcnI7DQorCX0NCiANCiAJZm9yIChpID0gMDsgaSA8IENBS0VfTUFYX1RJ
TlM7IGkrKykgew0KLQkJc3RydWN0IGNha2VfdGluX2RhdGEgKmIgPSBxLT50aW5zICsgaTsNCisJ
CXN0cnVjdCBjYWtlX3Rpbl9kYXRhICpiID0gcWQtPnRpbnMgKyBpOw0KIA0KIAkJSU5JVF9MSVNU
X0hFQUQoJmItPm5ld19mbG93cyk7DQogCQlJTklUX0xJU1RfSEVBRCgmYi0+b2xkX2Zsb3dzKTsN
CkBAIC0yNzc4LDIyICsyNzk0LDI3IEBAIHN0YXRpYyBpbnQgY2FrZV9pbml0KHN0cnVjdCBRZGlz
YyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQogCQkJSU5JVF9MSVNUX0hFQUQoJmZsb3ctPmZs
b3djaGFpbik7DQogCQkJY29iYWx0X3ZhcnNfaW5pdCgmZmxvdy0+Y3ZhcnMpOw0KIA0KLQkJCXEt
Pm92ZXJmbG93X2hlYXBba10udCA9IGk7DQotCQkJcS0+b3ZlcmZsb3dfaGVhcFtrXS5iID0gajsN
CisJCQlxZC0+b3ZlcmZsb3dfaGVhcFtrXS50ID0gaTsNCisJCQlxZC0+b3ZlcmZsb3dfaGVhcFtr
XS5iID0gajsNCiAJCQliLT5vdmVyZmxvd19pZHhbal0gPSBrOw0KIAkJfQ0KIAl9DQogDQogCWNh
a2VfcmVjb25maWd1cmUoc2NoKTsNCi0JcS0+YXZnX3BlYWtfYmFuZHdpZHRoID0gcS0+cmF0ZV9i
cHM7DQotCXEtPm1pbl9uZXRsZW4gPSB+MDsNCi0JcS0+bWluX2FkamxlbiA9IH4wOw0KKwlxZC0+
YXZnX3BlYWtfYmFuZHdpZHRoID0gcS0+cmF0ZV9icHM7DQorCXFkLT5taW5fbmV0bGVuID0gfjA7
DQorCXFkLT5taW5fYWRqbGVuID0gfjA7DQogCXJldHVybiAwOw0KK2VycjoNCisJa3ZmcmVlKHFk
LT5jb25maWcpOw0KKwlxZC0+Y29uZmlnID0gTlVMTDsNCisJcmV0dXJuIGVycjsNCiB9DQogDQog
c3RhdGljIGludCBjYWtlX2R1bXAoc3RydWN0IFFkaXNjICpzY2gsIHN0cnVjdCBza19idWZmICpz
a2IpDQogew0KLQlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxID0gcWRpc2NfcHJpdihzY2gpOw0K
KwlzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhICpxZCA9IHFkaXNjX3ByaXYoc2NoKTsNCisJc3RydWN0
IGNha2Vfc2NoZWRfY29uZmlnICpxID0gcWQtPmNvbmZpZzsNCiAJc3RydWN0IG5sYXR0ciAqb3B0
czsNCiAJdTE2IHJhdGVfZmxhZ3M7DQogCXU4IGZsb3dfbW9kZTsNCg0KLS0gDQoyLjUyLjANCg0K
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KQ2FrZSBtYWls
aW5nIGxpc3QgLS0gY2FrZUBsaXN0cy5idWZmZXJibG9hdC5uZXQKVG8gdW5zdWJzY3JpYmUgc2Vu
ZCBhbiBlbWFpbCB0byBjYWtlLWxlYXZlQGxpc3RzLmJ1ZmZlcmJsb2F0Lm5ldAo=

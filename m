Return-Path: <cake-bounces@lists.bufferbloat.net>
X-Original-To: lists+cake@lfdr.de
Delivered-To: lists+cake@lfdr.de
Received: from mail.toke.dk (mail.toke.dk [IPv6:2a0c:4d80:42:2001::664])
	by mail.lfdr.de (Postfix) with ESMTPS id 9CC33C8D8D4
	for <lists+cake@lfdr.de>; Thu, 27 Nov 2025 10:31:11 +0100 (CET)
Received: from [45.145.95.3] (localhost.localdomain [IPv6:::1])
	by mail.toke.dk (Postfix) with ESMTP id 0DB839D3EE8;
	Thu, 27 Nov 2025 10:31:09 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
	d=lists.bufferbloat.net; s=20250711; t=1764235869;
	bh=x+EXyrCD5iXitr7RshpsTb34pyLJb/lAWm2gjg/Jlw0=;
	h=Date:References:In-Reply-To:To:Cc:Subject:List-Id:List-Archive:
	 List-Help:List-Owner:List-Post:List-Subscribe:List-Unsubscribe:
	 From:Reply-To:From;
	b=JVDj2Jarb7exiL18iuFyowG1N9dFuPRfWmb1rpX/wUlHRx/5t48gsNrKCQq9czexf
	 lh2zL4gufKtByeqQY839jMAdiZUG+RCyVsHbccnI4z/3fKlWw4aaNFAC8mzh/uOZsC
	 jv+VXmwYFPKyGMVwmoVExRFxt0w0pITZcRRKzCFsNQlcAvhVeIzFagHNqJt2kDdZuU
	 1pwqTfdH1AYBaF/D/Kwww7he4UPQlJ1n1MTwL6n4ZW4tl96v2/dbivkk8Ej4B390R0
	 VFhlwb0VFUNiamFfyS03Gj/Dz1jCO1AywOsYRc5HBqHCZZwPPGmGf2jStZtISVvGFf
	 ZLzvjhwGhV0qg==
ARC-Seal: i=1; cv=none; a=rsa-sha256; d=toke.dk; s=arc202507;
 t=1764235868;
 b=bTR1gbdA2PM/iKFLpBiL1jOfSxMIRT5pv9RPCDMTl7Z3zM5MStTS7e1mYcH/QFLPDDoXJ
 kvEa0VkggWBSGj6KO5BoaIuU61jPANCIxoIUZEjZ3L3rmUQMs+nsLV4kDFlJynm3qxdUw6d
 RHICzD+7sR7skFYS9ncFpkWNIb/DP+Y=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=toke.dk;
 s=arc202507; t=1764235868; h=from : sender : reply-to : subject : date
 : message-id : to : cc : mime-version : content-type :
 content-transfer-encoding : content-id : content-description :
 resent-date : resent-from : resent-sender : resent-to : resent-cc :
 resent-message-id : in-reply-to : references : list-id : list-help :
 list-unsubscribe : list-subscribe : list-post : list-owner :
 list-archive; bh=x+EXyrCD5iXitr7RshpsTb34pyLJb/lAWm2gjg/Jlw0=;
 b=Opt0hx2AYQ701zBnw1eNvkBt0Vcj53G6N6AayW1BT0grc8GtDOnTyb69cEsOqEKQmyEep
 X3S6/NsJEK+/1KzSfCdd8flALyoIZNVmSeJ8o2XYiPqcMwaYWZpGZU2rFeLd0oilirdevt3
 wSyN5YPVIgAQdUYO8m+0PmprTiRH7Bc=
ARC-Authentication-Results: i=1; mail.toke.dk;
 spf=pass smtp.mailfrom=;
 dkim=pass header.d=redhat.com;
 arc=none;
 dmarc=pass header.from=redhat.com policy.dmarc=quarantine
Authentication-Results: mail.toke.dk; spf=pass smtp.mailfrom=;
 dkim=pass header.d=redhat.com; arc=none (Message is not ARC signed);
 dmarc=pass (Used From Domain Record) header.from=redhat.com
 policy.dmarc=quarantine
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
	by mail.toke.dk (Postfix) with ESMTPS id F2FC89D3E9C
	for <cake@lists.bufferbloat.net>; Thu, 27 Nov 2025 10:31:05 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
	s=mimecast20190719; t=1764235864;
	h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
	 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding:
	 in-reply-to:in-reply-to:references:references;
	bh=Pj33bTqXMSC7ywulh8bZ1bZ3T/x3a3YwpFGz0M4L04M=;
	b=fRCaNMzpifqiy5w/plhBDqu0uKFSapmYUh4WxIgfjrc0xZ9/MyC7M9mcTPvPksq9auFrgG
	fmevx+CkyQaxDavWHusL+RqjDjxA3USJ4VY0iB39kfIKEaksuLJv4DVb8Xc5zncWB/TCZW
	oopLft7QPEtK37HP/apY5J1bf5Ja49Q=
Received: from mail-ej1-f71.google.com (mail-ej1-f71.google.com
 [209.85.218.71]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-511-AvxvecuMN8uy_RMx41QYdQ-1; Thu, 27 Nov 2025 04:31:02 -0500
X-MC-Unique: AvxvecuMN8uy_RMx41QYdQ-1
X-Mimecast-MFC-AGG-ID: AvxvecuMN8uy_RMx41QYdQ_1764235861
Received: by mail-ej1-f71.google.com with SMTP id
 a640c23a62f3a-b763b24f223so65726266b.0
        for <cake@lists.bufferbloat.net>;
 Thu, 27 Nov 2025 01:31:02 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1764235861; x=1764840661;
        h=cc:to:in-reply-to:references:message-id:content-transfer-encoding
         :mime-version:subject:date:from:x-gm-gg:x-gm-message-state:from:to
         :cc:subject:date:message-id:reply-to;
        bh=Pj33bTqXMSC7ywulh8bZ1bZ3T/x3a3YwpFGz0M4L04M=;
        b=VCkOKzmUa23wApM3+oBrFNBnFhKXuSntXzaZMGI/6u4305wynSnFQ05pdy9JAEsUXU
         WsiGPsIeLOp/5bj55bpejRk2TRV0G3YIk1BPbPquJ8k8hKJ9vXMlw1ALWLMHMEh9byvo
         tFA0c32vqQonaksA3F2nCEcItFkpwhmEGlYCEK1TysOdjchFXo16ceCcZrfYeoANvKaQ
         TS14HMNeG+XlEDO+ugoW0NfKM5gkOPVf29FoDKXBIGW6HrkpJMImPs4Nb404ANJovtSi
         rF2zzUE0xWsiK0raTbdSd3oUFeV92lHuBhzNfkzEGFq428ACx9t9rMlizENdeyl4HrwZ
         Qd0Q==
X-Forwarded-Encrypted: i=1;
 AJvYcCWZhtW3tDW+JBUlmy2wPG+mlFPSp3+7a5wnBD6xrfVb4zTU84A6734E0pBWdDjwHwjVJsWg@lists.bufferbloat.net
X-Gm-Message-State: AOJu0YyqX85tSe+/nJRq6sye7EmbtZ2SNsKPtWAuSBOrFFFxoJIf7tIw
	StR/YyX2wA9dRJuy4xXhhlEe73xjJyhOS94ayyih7w40FRVtRL46Ch+kt+MF2SpRN7FClsnq2uf
	/gv61Qc1lUriR4QwSC7FX4eRaUswX1zXtjVHp007XgpD2gSSTHOGBKVqlXDXE9Bc=
X-Gm-Gg: ASbGncs1G6t6C3Pkb0dI10uEIiVyKjd5du4eMtrbgdyWrkPZWHG8LYoicLgj0H2GKAG
	peEe7vHH5Rx24NUBFv8cBYu2z2Tqb2xtglVquo4n9tVR40QWs+dTeckQUCedzv6UOTu1BPFb6nH
	aN0BtAbGw7/fzv5uXURoijyvqmTSFGkVPQFJRuOakbHF0RmLduZZBFBBbhdrwyr0pAR6T3q29TK
	sAh9X21Rp4XG3HWypKexPTD/+13Cj5ExWKedGB4jQEhR+JMleeOwPpEpK54wBQ5xWo6eQvoWT6T
	uNmu1dR7V4LooIq92M9T3nrPXEOL7Jv4nJqRa1IU5PqfEv67Q9LMWbx1eCW3sAPT14VPyG6yKAg
	PwwGHhWLWWpk6ML0V2tRd79fPo4LazCMI3A==
X-Received: by 2002:a17:907:94c5:b0:b73:7ac4:a5f with SMTP id
 a640c23a62f3a-b7671565517mr2339121166b.21.1764235860879;
        Thu, 27 Nov 2025 01:31:00 -0800 (PST)
X-Google-Smtp-Source: 
 AGHT+IFvU90swQslTLLvC2voemumWXJDCQQ+KgSSrQZpF/UMrek6Uk3TGdcOA0AVROnhjd2fFtBwXQ==
X-Received: by 2002:a17:907:94c5:b0:b73:7ac4:a5f with SMTP id
 a640c23a62f3a-b7671565517mr2339118266b.21.1764235860436;
        Thu, 27 Nov 2025 01:31:00 -0800 (PST)
Received: from alrua-x1.borgediget.toke.dk ([45.145.92.2])
        by smtp.gmail.com with ESMTPSA id
 a640c23a62f3a-b76f59a6a5csm111077866b.41.2025.11.27.01.30.57
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Thu, 27 Nov 2025 01:30:58 -0800 (PST)
Received: by alrua-x1.borgediget.toke.dk (Postfix, from userid 1000)
	id 493FC395705; Thu, 27 Nov 2025 10:30:57 +0100 (CET)
Date: Thu, 27 Nov 2025 10:30:53 +0100
MIME-Version: 1.0
Message-Id: <20251127-mq-cake-sub-qdisc-v2-3-24d9ead047b9@redhat.com>
References: <20251127-mq-cake-sub-qdisc-v2-0-24d9ead047b9@redhat.com>
In-Reply-To: <20251127-mq-cake-sub-qdisc-v2-0-24d9ead047b9@redhat.com>
To: =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen?= <toke@toke.dk>,
 Jamal Hadi Salim <jhs@mojatatu.com>, Cong Wang <xiyou.wangcong@gmail.com>,
 Jiri Pirko <jiri@resnulli.us>, "David S. Miller" <davem@davemloft.net>,
 Eric Dumazet <edumazet@google.com>, Jakub Kicinski <kuba@kernel.org>,
 Paolo Abeni <pabeni@redhat.com>, Simon Horman <horms@kernel.org>
Cc: =?utf-8?q?Jonas_K=C3=B6ppeler?= <j.koeppeler@tu-berlin.de>,
 cake@lists.bufferbloat.net, netdev@vger.kernel.org,
 =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen?= <toke@redhat.com>
X-Mailer: b4 0.14.3
X-Mimecast-Spam-Score: 0
X-Mimecast-MFC-PROC-ID: ZL5s4S5Sb4Ez6gfmDE19sRzIST-GFYytu94G6ijf0Lw_1764235861
X-Mimecast-Originator: redhat.com
Content-Type: text/plain; charset="utf-8"
Message-ID-Hash: 6XHNEGK5OO7MVRHZUMRLLTTLDNKCZU6Q
X-Message-ID-Hash: 6XHNEGK5OO7MVRHZUMRLLTTLDNKCZU6Q
X-MailFrom: toke@redhat.com
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; loop;
 banned-address; emergency; member-moderation; nonmember-moderation;
 administrivia; implicit-dest; max-recipients; max-size; news-moderation;
 no-subject; digests; suspicious-header
X-Mailman-Version: 3.3.10
Precedence: list
Subject: [Cake] [PATCH net-next v2 3/4] net/sched: sch_cake: Share config across
 cake_mq sub-qdiscs
List-Id: Cake - FQ_codel the next generation <cake.lists.bufferbloat.net>
Archived-At: 
 <https://lists.bufferbloat.net/cake/20251127-mq-cake-sub-qdisc-v2-3-24d9ead047b9@redhat.com/>
List-Archive: <https://lists.bufferbloat.net/cake/>
List-Help: <mailto:cake-request@lists.bufferbloat.net?subject=help>
List-Owner: <mailto:cake-owner@lists.bufferbloat.net>
List-Post: <mailto:cake@lists.bufferbloat.net>
List-Subscribe: <mailto:cake-join@lists.bufferbloat.net>
List-Unsubscribe: <mailto:cake-leave@lists.bufferbloat.net>
From: =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen_via_Cake?=
 <cake@lists.bufferbloat.net>
Reply-To: =?utf-8?q?Toke_H=C3=B8iland-J=C3=B8rgensen?= <toke@redhat.com>
Content-Transfer-Encoding: base64

VGhpcyBhZGRzIHN1cHBvcnQgZm9yIGNvbmZpZ3VyaW5nIHRoZSBjYWtlX21xIGluc3RhbmNlIGRp
cmVjdGx5LCBzaGFyaW5nDQp0aGUgY29uZmlnIGFjcm9zcyB0aGUgY2FrZSBzdWItcWRpc2NzLg0K
DQpSZXZpZXdlZC1ieTogSmFtYWwgSGFkaSBTYWxpbSA8amhzQG1vamF0YXR1LmNvbT4NClNpZ25l
ZC1vZmYtYnk6IFRva2UgSMO4aWxhbmQtSsO4cmdlbnNlbiA8dG9rZUByZWRoYXQuY29tPg0KLS0t
DQogbmV0L3NjaGVkL3NjaF9jYWtlLmMgfCAxNDcgKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKystLS0tLS0tLS0tDQogMSBmaWxlIGNoYW5nZWQsIDExOCBpbnNlcnRpb25z
KCspLCAyOSBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL25ldC9zY2hlZC9zY2hfY2FrZS5j
IGIvbmV0L3NjaGVkL3NjaF9jYWtlLmMNCmluZGV4IDJlNGI3NzA2YzU3Yy4uMDY2YWEwM2YzZmE1
IDEwMDY0NA0KLS0tIGEvbmV0L3NjaGVkL3NjaF9jYWtlLmMNCisrKyBiL25ldC9zY2hlZC9zY2hf
Y2FrZS5jDQpAQCAtMjExLDYgKzIxMSw3IEBAIHN0cnVjdCBjYWtlX3NjaGVkX2NvbmZpZyB7DQog
CXU4CQlmbG93X21vZGU7DQogCXU4CQlhdG1fbW9kZTsNCiAJdTgJCWFja19maWx0ZXI7DQorCXU4
CQlpc19zaGFyZWQ7DQogfTsNCiANCiBzdHJ1Y3QgY2FrZV9zY2hlZF9kYXRhIHsNCkBAIC0yNTgw
LDExICsyNTgxLDkgQEAgc3RhdGljIHZvaWQgY2FrZV9yZWNvbmZpZ3VyZShzdHJ1Y3QgUWRpc2Mg
KnNjaCkNCiAJCQkJICAgcS0+YnVmZmVyX2NvbmZpZ19saW1pdCkpOw0KIH0NCiANCi1zdGF0aWMg
aW50IGNha2VfY2hhbmdlKHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQot
CQkgICAgICAgc3RydWN0IG5ldGxpbmtfZXh0X2FjayAqZXh0YWNrKQ0KK3N0YXRpYyBpbnQgY2Fr
ZV9jb25maWdfY2hhbmdlKHN0cnVjdCBjYWtlX3NjaGVkX2NvbmZpZyAqcSwgc3RydWN0IG5sYXR0
ciAqb3B0LA0KKwkJCSAgICAgIHN0cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaywgYm9vbCAq
b3ZlcmhlYWRfY2hhbmdlZCkNCiB7DQotCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnFkID0gcWRp
c2NfcHJpdihzY2gpOw0KLQlzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcgKnEgPSBxZC0+Y29uZmln
Ow0KIAlzdHJ1Y3QgbmxhdHRyICp0YltUQ0FfQ0FLRV9NQVggKyAxXTsNCiAJdTE2IHJhdGVfZmxh
Z3M7DQogCXU4IGZsb3dfbW9kZTsNCkBAIC0yNjM3LDIwICsyNjM2LDEyIEBAIHN0YXRpYyBpbnQg
Y2FrZV9jaGFuZ2Uoc3RydWN0IFFkaXNjICpzY2gsIHN0cnVjdCBubGF0dHIgKm9wdCwNCiAJCVdS
SVRFX09OQ0UocS0+cmF0ZV9vdmVyaGVhZCwNCiAJCQkgICBubGFfZ2V0X3MzMih0YltUQ0FfQ0FL
RV9PVkVSSEVBRF0pKTsNCiAJCXJhdGVfZmxhZ3MgfD0gQ0FLRV9GTEFHX09WRVJIRUFEOw0KLQ0K
LQkJcWQtPm1heF9uZXRsZW4gPSAwOw0KLQkJcWQtPm1heF9hZGpsZW4gPSAwOw0KLQkJcWQtPm1p
bl9uZXRsZW4gPSB+MDsNCi0JCXFkLT5taW5fYWRqbGVuID0gfjA7DQorCQkqb3ZlcmhlYWRfY2hh
bmdlZCA9IHRydWU7DQogCX0NCiANCiAJaWYgKHRiW1RDQV9DQUtFX1JBV10pIHsNCiAJCXJhdGVf
ZmxhZ3MgJj0gfkNBS0VfRkxBR19PVkVSSEVBRDsNCi0NCi0JCXFkLT5tYXhfbmV0bGVuID0gMDsN
Ci0JCXFkLT5tYXhfYWRqbGVuID0gMDsNCi0JCXFkLT5taW5fbmV0bGVuID0gfjA7DQotCQlxZC0+
bWluX2FkamxlbiA9IH4wOw0KKwkJKm92ZXJoZWFkX2NoYW5nZWQgPSB0cnVlOw0KIAl9DQogDQog
CWlmICh0YltUQ0FfQ0FLRV9NUFVdKQ0KQEAgLTI3MDYsNiArMjY5NywzNCBAQCBzdGF0aWMgaW50
IGNha2VfY2hhbmdlKHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQogDQog
CVdSSVRFX09OQ0UocS0+cmF0ZV9mbGFncywgcmF0ZV9mbGFncyk7DQogCVdSSVRFX09OQ0UocS0+
Zmxvd19tb2RlLCBmbG93X21vZGUpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGlu
dCBjYWtlX2NoYW5nZShzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IG5sYXR0ciAqb3B0LA0KKwkJ
ICAgICAgIHN0cnVjdCBuZXRsaW5rX2V4dF9hY2sgKmV4dGFjaykNCit7DQorCXN0cnVjdCBjYWtl
X3NjaGVkX2RhdGEgKnFkID0gcWRpc2NfcHJpdihzY2gpOw0KKwlzdHJ1Y3QgY2FrZV9zY2hlZF9j
b25maWcgKnEgPSBxZC0+Y29uZmlnOw0KKwlib29sIG92ZXJoZWFkX2NoYW5nZWQgPSBmYWxzZTsN
CisJaW50IHJldDsNCisNCisJaWYgKHEtPmlzX3NoYXJlZCkgew0KKwkJTkxfU0VUX0VSUl9NU0co
ZXh0YWNrLCAiY2FuJ3QgcmVjb25maWd1cmUgY2FrZV9tcSBzdWItcWRpc2NzIik7DQorCQlyZXR1
cm4gLUVPUE5PVFNVUFA7DQorCX0NCisNCisJcmV0ID0gY2FrZV9jb25maWdfY2hhbmdlKHEsIG9w
dCwgZXh0YWNrLCAmb3ZlcmhlYWRfY2hhbmdlZCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0
Ow0KKw0KKwlpZiAob3ZlcmhlYWRfY2hhbmdlZCkgew0KKwkJcWQtPm1heF9uZXRsZW4gPSAwOw0K
KwkJcWQtPm1heF9hZGpsZW4gPSAwOw0KKwkJcWQtPm1pbl9uZXRsZW4gPSB+MDsNCisJCXFkLT5t
aW5fYWRqbGVuID0gfjA7DQorCX0NCisNCiAJaWYgKHFkLT50aW5zKSB7DQogCQlzY2hfdHJlZV9s
b2NrKHNjaCk7DQogCQljYWtlX3JlY29uZmlndXJlKHNjaCk7DQpAQCAtMjcyMiw3ICsyNzQxLDIz
IEBAIHN0YXRpYyB2b2lkIGNha2VfZGVzdHJveShzdHJ1Y3QgUWRpc2MgKnNjaCkNCiAJcWRpc2Nf
d2F0Y2hkb2dfY2FuY2VsKCZxLT53YXRjaGRvZyk7DQogCXRjZl9ibG9ja19wdXQocS0+YmxvY2sp
Ow0KIAlrdmZyZWUocS0+dGlucyk7DQotCWt2ZnJlZShxLT5jb25maWcpOw0KKwlpZiAoIXEtPmNv
bmZpZy0+aXNfc2hhcmVkKQ0KKwkJa3ZmcmVlKHEtPmNvbmZpZyk7DQorfQ0KKw0KK3N0YXRpYyB2
b2lkIGNha2VfY29uZmlnX2luaXQoc3RydWN0IGNha2Vfc2NoZWRfY29uZmlnICpxLCBib29sIGlz
X3NoYXJlZCkNCit7DQorCXEtPnRpbl9tb2RlID0gQ0FLRV9ESUZGU0VSVl9ESUZGU0VSVjM7DQor
CXEtPmZsb3dfbW9kZSAgPSBDQUtFX0ZMT1dfVFJJUExFOw0KKw0KKwlxLT5yYXRlX2JwcyA9IDA7
IC8qIHVubGltaXRlZCBieSBkZWZhdWx0ICovDQorDQorCXEtPmludGVydmFsID0gMTAwMDAwOyAv
KiAxMDBtcyBkZWZhdWx0ICovDQorCXEtPnRhcmdldCAgID0gICA1MDAwOyAvKiA1bXM6IGNvZGVs
IFJGQyBhcmd1ZXMNCisJCQkgICAgICAgKiBmb3IgNSB0byAxMCUgb2YgaW50ZXJ2YWwNCisJCQkg
ICAgICAgKi8NCisJcS0+cmF0ZV9mbGFncyB8PSBDQUtFX0ZMQUdfU1BMSVRfR1NPOw0KKwlxLT5p
c19zaGFyZWQgPSBpc19zaGFyZWQ7DQogfQ0KIA0KIHN0YXRpYyBpbnQgY2FrZV9pbml0KHN0cnVj
dCBRZGlzYyAqc2NoLCBzdHJ1Y3QgbmxhdHRyICpvcHQsDQpAQCAtMjczNiwxOSArMjc3MSwxMSBA
QCBzdGF0aWMgaW50IGNha2VfaW5pdChzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IG5sYXR0ciAq
b3B0LA0KIAlpZiAoIXEpDQogCQlyZXR1cm4gLUVOT01FTTsNCiANCisJY2FrZV9jb25maWdfaW5p
dChxLCBmYWxzZSk7DQorDQogCXNjaC0+bGltaXQgPSAxMDI0MDsNCiAJc2NoLT5mbGFncyB8PSBU
Q1FfRl9ERVFVRVVFX0RST1BTOw0KIA0KLQlxLT50aW5fbW9kZSA9IENBS0VfRElGRlNFUlZfRElG
RlNFUlYzOw0KLQlxLT5mbG93X21vZGUgID0gQ0FLRV9GTE9XX1RSSVBMRTsNCi0NCi0JcS0+cmF0
ZV9icHMgPSAwOyAvKiB1bmxpbWl0ZWQgYnkgZGVmYXVsdCAqLw0KLQ0KLQlxLT5pbnRlcnZhbCA9
IDEwMDAwMDsgLyogMTAwbXMgZGVmYXVsdCAqLw0KLQlxLT50YXJnZXQgICA9ICAgNTAwMDsgLyog
NW1zOiBjb2RlbCBSRkMgYXJndWVzDQotCQkJICAgICAgICogZm9yIDUgdG8gMTAlIG9mIGludGVy
dmFsDQotCQkJICAgICAgICovDQotCXEtPnJhdGVfZmxhZ3MgfD0gQ0FLRV9GTEFHX1NQTElUX0dT
TzsNCiAJcWQtPmN1cl90aW4gPSAwOw0KIAlxZC0+Y3VyX2Zsb3cgID0gMDsNCiAJcWQtPmNvbmZp
ZyA9IHE7DQpAQCAtMjgxMSwxMCArMjgzOCwyMSBAQCBzdGF0aWMgaW50IGNha2VfaW5pdChzdHJ1
Y3QgUWRpc2MgKnNjaCwgc3RydWN0IG5sYXR0ciAqb3B0LA0KIAlyZXR1cm4gZXJyOw0KIH0NCiAN
Ci1zdGF0aWMgaW50IGNha2VfZHVtcChzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IHNrX2J1ZmYg
KnNrYikNCitzdGF0aWMgdm9pZCBjYWtlX2NvbmZpZ19yZXBsYWNlKHN0cnVjdCBRZGlzYyAqc2No
LCBzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcgKmNmZykNCiB7DQogCXN0cnVjdCBjYWtlX3NjaGVk
X2RhdGEgKnFkID0gcWRpc2NfcHJpdihzY2gpOw0KIAlzdHJ1Y3QgY2FrZV9zY2hlZF9jb25maWcg
KnEgPSBxZC0+Y29uZmlnOw0KKw0KKwlxZC0+Y29uZmlnID0gY2ZnOw0KKw0KKwlpZiAoIXEtPmlz
X3NoYXJlZCkNCisJCWt2ZnJlZShxKTsNCisNCisJY2FrZV9yZWNvbmZpZ3VyZShzY2gpOw0KK30N
CisNCitzdGF0aWMgaW50IGNha2VfY29uZmlnX2R1bXAoc3RydWN0IGNha2Vfc2NoZWRfY29uZmln
ICpxLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQ0KK3sNCiAJc3RydWN0IG5sYXR0ciAqb3B0czsNCiAJ
dTE2IHJhdGVfZmxhZ3M7DQogCXU4IGZsb3dfbW9kZTsNCkBAIC0yODkwLDYgKzI5MjgsMTQgQEAg
c3RhdGljIGludCBjYWtlX2R1bXAoc3RydWN0IFFkaXNjICpzY2gsIHN0cnVjdCBza19idWZmICpz
a2IpDQogCXJldHVybiAtMTsNCiB9DQogDQorc3RhdGljIGludCBjYWtlX2R1bXAoc3RydWN0IFFk
aXNjICpzY2gsIHN0cnVjdCBza19idWZmICpza2IpDQorew0KKwlzdHJ1Y3QgY2FrZV9zY2hlZF9k
YXRhICpxZCA9IHFkaXNjX3ByaXYoc2NoKTsNCisJc3RydWN0IGNha2Vfc2NoZWRfY29uZmlnICpx
ID0gcWQtPmNvbmZpZzsNCisNCisJcmV0dXJuIGNha2VfY29uZmlnX2R1bXAocSwgc2tiKTsNCit9
DQorDQogc3RhdGljIGludCBjYWtlX2R1bXBfc3RhdHMoc3RydWN0IFFkaXNjICpzY2gsIHN0cnVj
dCBnbmV0X2R1bXAgKmQpDQogew0KIAlzdHJ1Y3QgbmxhdHRyICpzdGF0cyA9IG5sYV9uZXN0X3N0
YXJ0X25vZmxhZyhkLT5za2IsIFRDQV9TVEFUU19BUFApOw0KQEAgLTMxNTIsNyArMzE5OCw4IEBA
IHN0YXRpYyBzdHJ1Y3QgUWRpc2Nfb3BzIGNha2VfcWRpc2Nfb3BzIF9fcmVhZF9tb3N0bHkgPSB7
DQogTU9EVUxFX0FMSUFTX05FVF9TQ0goImNha2UiKTsNCiANCiBzdHJ1Y3QgY2FrZV9tcV9zY2hl
ZCB7DQotCXN0cnVjdCBRZGlzYwkJKipxZGlzY3M7DQorCXN0cnVjdCBRZGlzYyAqKnFkaXNjczsN
CisJc3RydWN0IGNha2Vfc2NoZWRfY29uZmlnIGNha2VfY29uZmlnOw0KIH07DQogDQogc3RhdGlj
IHZvaWQgY2FrZV9tcV9kZXN0cm95KHN0cnVjdCBRZGlzYyAqc2NoKQ0KQEAgLTMxNzYsNiArMzIy
Myw4IEBAIHN0YXRpYyBpbnQgY2FrZV9tcV9pbml0KHN0cnVjdCBRZGlzYyAqc2NoLCBzdHJ1Y3Qg
bmxhdHRyICpvcHQsDQogCXN0cnVjdCBuZXRkZXZfcXVldWUgKmRldl9xdWV1ZTsNCiAJc3RydWN0
IFFkaXNjICpxZGlzYzsNCiAJdW5zaWduZWQgaW50IG50eDsNCisJYm9vbCBfdW51c2VkOw0KKwlp
bnQgcmV0Ow0KIA0KIAlpZiAoc2NoLT5wYXJlbnQgIT0gVENfSF9ST09UKQ0KIAkJcmV0dXJuIC1F
T1BOT1RTVVBQOw0KQEAgLTMxODMsNiArMzIzMiwxMSBAQCBzdGF0aWMgaW50IGNha2VfbXFfaW5p
dChzdHJ1Y3QgUWRpc2MgKnNjaCwgc3RydWN0IG5sYXR0ciAqb3B0LA0KIAlpZiAoIW5ldGlmX2lz
X211bHRpcXVldWUoZGV2KSkNCiAJCXJldHVybiAtRU9QTk9UU1VQUDsNCiANCisJY2FrZV9jb25m
aWdfaW5pdCgmcHJpdi0+Y2FrZV9jb25maWcsIHRydWUpOw0KKwlyZXQgPSBjYWtlX2NvbmZpZ19j
aGFuZ2UoJnByaXYtPmNha2VfY29uZmlnLCBvcHQsIGV4dGFjaywgJl91bnVzZWQpOw0KKwlpZiAo
cmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCiAJLyogcHJlLWFsbG9jYXRlIHFkaXNjcywgYXR0YWNo
bWVudCBjYW4ndCBmYWlsICovDQogCXByaXYtPnFkaXNjcyA9IGtjYWxsb2MoZGV2LT5udW1fdHhf
cXVldWVzLCBzaXplb2YocHJpdi0+cWRpc2NzWzBdKSwNCiAJCQkgICAgICAgR0ZQX0tFUk5FTCk7
DQpAQCAtMzIwMSw2ICszMjU1LDcgQEAgc3RhdGljIGludCBjYWtlX21xX2luaXQoc3RydWN0IFFk
aXNjICpzY2gsIHN0cnVjdCBubGF0dHIgKm9wdCwNCiAJCX0NCiAJCXByaXYtPnFkaXNjc1tudHhd
ID0gcWRpc2M7DQogCQlxZGlzYy0+ZmxhZ3MgfD0gVENRX0ZfT05FVFhRVUVVRSB8IFRDUV9GX05P
UEFSRU5UOw0KKwkJY2FrZV9jb25maWdfcmVwbGFjZShxZGlzYywgJnByaXYtPmNha2VfY29uZmln
KTsNCiAJfQ0KIA0KIAlzY2gtPmZsYWdzIHw9IFRDUV9GX01RUk9PVDsNCkBAIC0zMjI5LDggKzMy
ODQsNDIgQEAgc3RhdGljIHZvaWQgY2FrZV9tcV9hdHRhY2goc3RydWN0IFFkaXNjICpzY2gpDQog
CXByaXYtPnFkaXNjcyA9IE5VTEw7DQogfQ0KIA0KK3N0YXRpYyBpbnQgY2FrZV9tcV9jaGFuZ2Uo
c3RydWN0IFFkaXNjICpzY2gsIHN0cnVjdCBubGF0dHIgKm9wdCwNCisJCQkgIHN0cnVjdCBuZXRs
aW5rX2V4dF9hY2sgKmV4dGFjaykNCit7DQorCXN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSBxZGlz
Y19kZXYoc2NoKTsNCisJc3RydWN0IGNha2VfbXFfc2NoZWQgKnByaXYgPSBxZGlzY19wcml2KHNj
aCk7DQorCWJvb2wgb3ZlcmhlYWRfY2hhbmdlZCA9IGZhbHNlOw0KKwl1bnNpZ25lZCBpbnQgbnR4
Ow0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBjYWtlX2NvbmZpZ19jaGFuZ2UoJnByaXYtPmNha2Vf
Y29uZmlnLCBvcHQsIGV4dGFjaywgJm92ZXJoZWFkX2NoYW5nZWQpOw0KKwlpZiAocmV0KQ0KKwkJ
cmV0dXJuIHJldDsNCisNCisJc2NoX3RyZWVfbG9jayhzY2gpOw0KKwlmb3IgKG50eCA9IDA7IG50
eCA8IGRldi0+bnVtX3R4X3F1ZXVlczsgbnR4KyspIHsNCisJCXN0cnVjdCBRZGlzYyAqY2hsZCA9
IHJ0bmxfZGVyZWZlcmVuY2UobmV0ZGV2X2dldF90eF9xdWV1ZShkZXYsIG50eCktPnFkaXNjX3Ns
ZWVwaW5nKTsNCisJCXN0cnVjdCBjYWtlX3NjaGVkX2RhdGEgKnFkID0gcWRpc2NfcHJpdihjaGxk
KTsNCisNCisJCWlmIChvdmVyaGVhZF9jaGFuZ2VkKSB7DQorCQkJcWQtPm1heF9uZXRsZW4gPSAw
Ow0KKwkJCXFkLT5tYXhfYWRqbGVuID0gMDsNCisJCQlxZC0+bWluX25ldGxlbiA9IH4wOw0KKwkJ
CXFkLT5taW5fYWRqbGVuID0gfjA7DQorCQl9DQorDQorCQlpZiAocWQtPnRpbnMpDQorCQkJY2Fr
ZV9yZWNvbmZpZ3VyZShjaGxkKTsNCisJfQ0KKwlzY2hfdHJlZV91bmxvY2soc2NoKTsNCisNCisJ
cmV0dXJuIDA7DQorfQ0KKw0KIHN0YXRpYyBpbnQgY2FrZV9tcV9kdW1wKHN0cnVjdCBRZGlzYyAq
c2NoLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQ0KIHsNCisJc3RydWN0IGNha2VfbXFfc2NoZWQgKnFk
ID0gcWRpc2NfcHJpdihzY2gpOw0KIAlzdHJ1Y3QgbmV0X2RldmljZSAqZGV2ID0gcWRpc2NfZGV2
KHNjaCk7DQogCXN0cnVjdCBRZGlzYyAqcWRpc2M7DQogCXVuc2lnbmVkIGludCBudHg7DQpAQCAt
MzI1Nyw3ICszMzQ2LDcgQEAgc3RhdGljIGludCBjYWtlX21xX2R1bXAoc3RydWN0IFFkaXNjICpz
Y2gsIHN0cnVjdCBza19idWZmICpza2IpDQogCQlzcGluX3VubG9ja19iaChxZGlzY19sb2NrKHFk
aXNjKSk7DQogCX0NCiANCi0JcmV0dXJuIDA7DQorCXJldHVybiBjYWtlX2NvbmZpZ19kdW1wKCZx
ZC0+Y2FrZV9jb25maWcsIHNrYik7DQogfQ0KIA0KIHN0YXRpYyBzdHJ1Y3QgbmV0ZGV2X3F1ZXVl
ICpjYWtlX21xX3F1ZXVlX2dldChzdHJ1Y3QgUWRpc2MgKnNjaCwgdW5zaWduZWQgbG9uZyBjbCkN
CkBAIC0zMzU0LDcgKzM0NDMsNyBAQCBzdGF0aWMgc3RydWN0IFFkaXNjX29wcyBjYWtlX21xX3Fk
aXNjX29wcyBfX3JlYWRfbW9zdGx5ID0gew0KIAkuaW5pdAkJPQljYWtlX21xX2luaXQsDQogCS5k
ZXN0cm95CT0JY2FrZV9tcV9kZXN0cm95LA0KIAkuYXR0YWNoCQk9IGNha2VfbXFfYXR0YWNoLA0K
LQkvLwkuY2hhbmdlCQk9CWNha2VfbXFfY2hhbmdlLA0KKwkuY2hhbmdlCQk9CWNha2VfbXFfY2hh
bmdlLA0KIAkuY2hhbmdlX3JlYWxfbnVtX3R4ID0gbXFfY2hhbmdlX3JlYWxfbnVtX3R4LA0KIAku
ZHVtcAkJPQljYWtlX21xX2R1bXAsDQogCS5vd25lcgkJPQlUSElTX01PRFVMRSwNCg0KLS0gDQoy
LjUyLjANCg0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18K
Q2FrZSBtYWlsaW5nIGxpc3QgLS0gY2FrZUBsaXN0cy5idWZmZXJibG9hdC5uZXQKVG8gdW5zdWJz
Y3JpYmUgc2VuZCBhbiBlbWFpbCB0byBjYWtlLWxlYXZlQGxpc3RzLmJ1ZmZlcmJsb2F0Lm5ldAo=
